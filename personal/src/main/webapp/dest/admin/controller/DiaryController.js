define(["require","Utils","toolbar","page","DateTimePickerDirective"],function(e,t){var i=!1,n=function(e){function t(e){return"<span class='glyphicon glyphicon-"+e+"'></span>"}$(".toolbar div:first").toolBar({toolbar:[{element:t("plus"),content:"添加",callback:function(){window.location.href="#/diarydetail/0"}},{element:t("remove"),content:"删除",callback:function(){console.log(e.checkedArr)}}]})};app.controller("DiaryListController",["$scope","DiaryService","$routeParams","$location",function(e,o,r,a){o.getlist(r.pageIndex).then(function(t){if(t&&t.flag){if(t=t.data,e.diarylist=t.recordList,i)return;i=!0;var n={totalPages:t.pageCount,visiblePages:7,onPageClick:function(e,t){window.location.href="#/diarylist/"+t}};angular.element("#pageBar").twbsPagination(n)}else e.diarylist=[]}),e.selectItem=function(t,i){console.log("selectItem"),i?e.checkedArr?e.checkedArr.push(t):e.checkedArr=[t]:e.checkedArr.splice(_.indexOf(e.checkedArr,t),1)},e.selectAll=function(t){e.checked=t.target.checked},e.delete=function(e){e&&e.length&&o.delete(e).then(function(e){e?e.flag?window.location.href="#/diarylist/1#":t.showAlert(e.msg):t.showAlert("网络错误！")})},n(e)}]),app.controller("DiaryDetailController",["$scope","DiaryService","$routeParams","$timeout",function(t,i,n,o){e(["ueditor","Utils","ueditor-config"],function(e,o){var r=new e.ui.Editor({initialFrameWidth:"100%",initialFrameHeight:.6*window.screen.availHeight,imageUrl:baseUrl+"/upload.do?type=diary"});i.getDetailById(n.id).then(function(e){e&&e.flag?t.diary=e.data:t.diary={},setTimeout(function(){r.render("content"),r.ready(function(){r.addListener("contentChange",function(){t.diary.content=r.getContent()})})},0)}),t.submit=function(e){return e?void(t.submitted=!0):(t.diary.plainText=r.getPlainTxt(),void i.save(t.diary).then(function(e){e?e.flag?window.location.href="#/diarylist/1":o.showAlert(e.msg):o.showAlert("服务器无响应!")}))}})}])});