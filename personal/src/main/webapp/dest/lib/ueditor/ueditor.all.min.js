!function(){function Aa(e,t,n){var i;return t=t.toLowerCase(),(i=e.__allListeners||n&&(e.__allListeners={}))&&(i[t]||n&&(i[t]=[]))}function Ba(e,t,n,i,o,a){i=i&&e[t];var r;for(!i&&(i=e[n]);!i&&(r=(r||e).parentNode);){if("BODY"==r.tagName||a&&!a(r))return null;i=r[n]}return i&&o&&!o(i)?Ba(i,t,n,!1,o):i}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var q=window.baidu||{};window.baidu=q,window.UE=q.editor={},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE.version="1.2.6.0";var R=UE.dom={},Bc=UE,U=navigator.userAgent.toLowerCase(),Ca=window.opera,B={ie:!!window.ActiveXObject,opera:!!Ca&&Ca.version,webkit:-1<U.indexOf(" applewebkit/"),mac:-1<U.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode};B.gecko="Gecko"==navigator.product&&!B.webkit&&!B.opera;var N=0;if(B.ie&&(N=parseFloat(U.match(/msie (\d+)/)[1]),B.ie9Compat=9==document.documentMode,B.ie8=!!document.documentMode,B.ie8Compat=8==document.documentMode,B.ie7Compat=7==N&&!document.documentMode||7==document.documentMode,B.ie6Compat=7>N||B.quirks),B.gecko){var Z=U.match(/rv:([\d\.]+)/);Z&&(Z=Z[1].split("."),N=1e4*Z[0]+100*(Z[1]||0)+1*(Z[2]||0))}/chrome\/(\d+\.\d)/i.test(U)&&(B.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(U)&&!/chrome/i.test(U)&&(B.safari=+(RegExp.$1||RegExp.$2)),B.opera&&(N=parseFloat(Ca.version())),B.webkit&&(N=parseFloat(U.match(/ applewebkit\/(\d+)/)[1])),B.version=N,B.isCompatible=!B.mobile&&(B.ie&&6<=N||B.gecko&&10801<=N||B.opera&&9.5<=N||B.air&&1<=N||B.webkit&&522<=N||!1);var n=Bc.browser=B,I=n.ie,Cc=n.opera,Dc=UE,db=document.createElement("div").style,eb={float:void 0!=db.cssFloat?"cssFloat":void 0!=db.styleFloat?"styleFloat":"float"},gb=function(e,t){try{for(var n,i=0;n=fb[i++];)if(n.doc===e&&n.url==(t.src||t.href))return n}catch(e){return null}},fb=[],$=function(e){for(e.isReady=!0;e=hb.pop();e());},hb=[],p=Dc.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var i=0,o=e.length;i<o;i++)if(!1===t.call(n,e[i],i,e))return!1}else for(i in e)if(e.hasOwnProperty(i)&&!1===t.call(n,e[i],i,e))return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var i in t)n&&e.hasOwnProperty(i)||(e[i]=t[i]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var i,o=t[n];for(i in o)e.hasOwnProperty(i)||(e[i]=o[i])}return e},inherits:function(e,t){var n=e.prototype,i=p.makeInstance(t.prototype);return p.extend(i,n,!0),e.prototype=i,i.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var i;return function(){n&&clearTimeout(i),i=setTimeout(e,t)}},indexOf:function(e,t,n){var i=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,o){if(o>=n&&e===t)return i=o,!1}),i},removeItem:function(e,t){for(var n=0,i=e.length;n<i;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=p.isArray(e)?e:e.split(",");for(var t,n=0,i={};t=e[n++];)i[t.toUpperCase()]=i[t]=1;return i},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[e]}):""},cssStyleToDomStyle:function(e){return eb[e]||(eb[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))},loadFile:function(e,t,n){var i=gb(e,t);if(i)i.ready?n&&n():i.funs.push(n);else if(fb.push({doc:e,url:t.src||t.href,funs:[n]}),e.body){if(!t.id||!e.getElementById(t.id)){var o=e.createElement(t.tag);delete t.tag;for(a in t)o.setAttribute(a,t[a]);o.onload=o.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(i=gb(e,t),0<i.funs.length){i.ready=1;for(var n;n=i.funs.pop();)n()}o.onload=o.onreadystatechange=null}},o.onerror=function(){throw Error("The load "+(t.href||t.src)+" fails,check the url settings of file ueditor.config.js ")},e.getElementsByTagName("head")[0].appendChild(o)}}else{n=[];for(var a in t)"tag"!=a&&n.push(a+'="'+t[a]+'"');e.write("<"+t.tag+" "+n.join(" ")+" ></"+t.tag+">")}},isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(3<n.length)return"";t="#";for(var i,o=0;i=n[o++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=1==i.length?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(e){function t(e,t){if(!e)return"";var n=e.top,i=e.bottom,o=e.left,a=e.right,r="";if(n&&o&&i&&a)r+=";"+t+":"+(n==i&&i==o&&o==a?n:n==i&&o==a?n+" "+o:o==a?n+" "+o+" "+i:n+" "+a+" "+i+" "+o)+";";else for(var s in e)r+=";"+t+"-"+s+":"+e[s]+";";return r}var n,i;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,o,a){if(1==a.split(" ").length)switch(t){case"padding":return!n&&(n={}),n[o]=a,"";case"margin":return!i&&(i={}),i[o]=a,"";case"border":return"initial"==a?"":e}return e}),e+=t(n,"padding")+t(i,"margin"),e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n;t=t||{};for(var i in e)e.hasOwnProperty(i)&&(n=e[i],"object"==typeof n?(t[i]=p.isArray(n)?[]:{},p.clone(e[i],t[i])):t[i]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;switch(e.replace(/([\d.]+)(\w+)/,function(n,i,o){e=i,t=o}),t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},domReady:function(e,t){t=t||window;var i=t.document;e&&hb.push(e),"complete"===i.readyState?$(i):(i.isReady&&$(i),n.ie?(function(){if(!i.isReady){try{i.documentElement.doScroll("left")}catch(e){return void setTimeout(arguments.callee,0)}$(i)}}(),t.attachEvent("onload",function(){$(i)})):(i.addEventListener("DOMContentLoaded",function(){i.removeEventListener("DOMContentLoaded",arguments.callee,!1),$(i)},!1),t.addEventListener("load",function(){$(i)},!1)))},cssRule:n.ie?function(e,t,n){var i;n=n||document,i=n.indexList?n.indexList:n.indexList={};var o;if(i[e])o=n.styleSheets[i[e]];else{if(void 0===t)return"";o=n.createStyleSheet("",n=n.styleSheets.length),i[e]=n}return void 0===t?o.cssText:void(o.cssText=t||"")}:function(e,t,n){n=n||document;var i,o=n.getElementsByTagName("head")[0];if(!(i=n.getElementById(e))){if(void 0===t)return"";i=n.createElement("style"),i.id=e,o.appendChild(i)}return void 0===t?i.innerHTML:void(""!==t?i.innerHTML=t:o.removeChild(i))},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var n=0,i=e.length;n<i;n++)for(var o=n,a=e.length;o<a;o++)if(0<t(e[n],e[o])){var r=e[n];e[n]=e[o],e[o]=r}return e}};p.each("String Function Array Number RegExp Object".split(" "),function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var Da=UE.EventBase=function(){};Da.prototype={addListener:function(e,t){e=p.trim(e).split(" ");for(var n,i=0;n=e[i++];)Aa(this,n,!0).push(t)},removeListener:function(e,t){e=p.trim(e).split(" ");for(var n,i=0;n=e[i++];)p.removeItem(Aa(this,n)||[],t)},fireEvent:function(){for(var e,t=arguments[0],t=p.trim(t).split(" "),n=0;e=t[n++];){var i,o,a,r=Aa(this,e);if(r)for(a=r.length;a--;)if(r[a]){if(o=r[a].apply(this,arguments),!0===o)return o;void 0!==o&&(i=o)}(o=this["on"+e.toLowerCase()])&&(i=o.apply(this,arguments))}return i}};var Ec=R,ib,x=function(e){for(var t in e)e[t.toUpperCase()]=e[t];return e},D=p.extend2,Ea=x({isindex:1,fieldset:1}),jb=x({input:1,button:1,select:1,textarea:1,label:1}),kb=D(x({a:1}),jb),Fa=D({iframe:1},kb),oa=x({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),lb=x({ins:1,del:1,script:1,style:1}),mb=D(x({b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),lb),nb=D(x({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),mb),pa=D(x({p:1}),nb),ob=D(x({iframe:1}),nb,jb),pb=x({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),u=D(x({a:0}),ob),Ga=x({tr:1}),ea=x({"#":1}),qb=D(x({param:1}),pb),K=D(x({form:1}),Ea,Fa,oa,pa),qa=x({li:1,ol:1,ul:1}),Fc=x({style:1,script:1}),rb=x({base:1,link:1,meta:1,title:1}),Gc=D(rb,Fc),sb=x({head:1,body:1}),Hc=x({html:1}),tb=x({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),Ic=x({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});ib=x({$nonBodyContent:D(Hc,sb,rb),$block:tb,$inline:u,$inlineWithA:D(x({a:1}),u),$body:D(x({script:1,style:1}),tb),$cdata:x({script:1,style:1}),$empty:Ic,$nonChild:x({iframe:1,textarea:1}),$listItem:x({dd:1,dt:1,li:1}),$list:x({ul:1,ol:1,dl:1}),$isNotEmpty:x({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:x({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:x({p:1,div:1}),$tableContent:x({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:x({pre:1,script:1,style:1,textarea:1}),html:sb,head:Gc,style:ea,script:ea,body:K,base:{},link:{},meta:{},title:ea,col:{},tr:x({td:1,th:1}),img:{},embed:{},colgroup:x({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:K,td:K,br:{},th:K,center:K,kbd:u,button:D(pa,oa),basefont:{},h5:u,h4:u,samp:u,h6:u,ol:qa,h1:u,h3:u,option:ea,h2:u,form:D(Ea,Fa,oa,pa),select:x({optgroup:1,option:1}),font:u,ins:u,menu:qa,abbr:u,label:u,table:x({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:u,tfoot:Ga,cite:u,li:K,input:{},iframe:K,strong:u,textarea:ea,noframes:K,big:u,small:u,span:x({"#":1,br:1}),hr:u,dt:u,sub:u,optgroup:x({option:1}),param:{},bdo:u,var:u,div:K,object:qb,sup:u,dd:K,strike:u,area:{},dir:qa,map:D(x({area:1,form:1,p:1}),Ea,lb,oa),applet:qb,dl:x({dt:1,dd:1}),del:u,isindex:{},fieldset:D(x({legend:1}),pb),thead:Ga,ul:qa,acronym:u,b:u,a:D(x({a:1}),ob),blockquote:D(x({td:1,tr:1,tbody:1,li:1}),K),caption:u,i:u,u:u,tbody:Ga,s:u,address:D(Fa,pa),tt:u,legend:u,q:u,pre:D(mb,kb),p:D(x({a:1}),u),em:u,dfn:u});var t=Ec.dtd=ib,ub=I&&9>n.version?{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},Jc=p.listToMap("-webkit-box -moz-box block list-item table table-row-group table-header-group table-footer-group table-row table-column-group table-column table-cell table-caption".split(" ")),f=R.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:I&&"6"==n.version?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;var n,i=[e],o=[t];for(n=e;n=n.parentNode;){if(n===t)return 10;i.push(n)}for(n=t;n=n.parentNode;){if(n===e)return 20;o.push(n)}if(i.reverse(),o.reverse(),i[0]!==o[0])return 1;for(n=-1;n++,i[n]===o[n];);for(e=i[n],t=o[n];e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var n=e,i=0;n=n.previousSibling;)t&&3==n.nodeType?n.nodeType!=n.nextSibling.nodeType&&i++:i++;return i},inDoc:function(e,t){return 10==f.getPosition(e,t)},findParent:function(e,t,n){if(e&&!f.isBody(e))for(e=n?e:e.parentNode;e;){if(!t||t(e)||f.isBody(e))return t&&!t(e)&&f.isBody(e)?null:e;e=e.parentNode}return null},findParentByTagName:function(e,t,n,i){return t=p.listToMap(p.isArray(t)?t:[t]),f.findParent(e,function(e){return t[e.tagName]&&!(i&&i(e))},n)},findParents:function(e,t,n,i){for(t=t&&(n&&n(e)||!n)?[e]:[];e=f.findParent(e,n);)t.push(e);return i?t:t.reverse()},insertAfter:function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},remove:function(e,t){var n,i=e.parentNode;if(i){if(t&&e.hasChildNodes())for(;n=e.firstChild;)i.insertBefore(n,e);i.removeChild(e)}return e},getNextDomNode:function(e,t,n,i){return Ba(e,"firstChild","nextSibling",t,n,i)},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){return e=e.ownerDocument||e,e.defaultView||e.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;for(var n=[e],i=[t],o=e,a=-1;o=o.parentNode;){if(o===t)return o;n.push(o)}for(o=t;o=o.parentNode;){if(o===e)return o;i.push(o)}for(n.reverse(),i.reverse();a++,n[a]===i[a];);return 0==a?null:n[a-1]},clearEmptySibling:function(e,t,n){function i(e,t){for(var n;e&&!f.isBookmarkNode(e)&&(f.isEmptyInlineElement(e)||!RegExp("[^\t\n\r"+f.fillChar+"]").test(e.nodeValue));)n=e[t],f.remove(e),e=n}!t&&i(e.nextSibling,"nextSibling"),!n&&i(e.previousSibling,"previousSibling")},split:function(e,t){var i=e.ownerDocument;if(n.ie&&t==e.nodeValue.length){var o=i.createTextNode("");return f.insertAfter(e,o)}return o=e.splitText(t),n.ie8&&(i=i.createTextNode(""),f.insertAfter(o,i),f.remove(i)),o},isWhitespace:function(e){return!RegExp("[^ \t\n\r"+f.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,n=0;e.offsetParent;)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},on:function(e,t,n){var i=p.isArray(t)?t:[t],o=i.length;if(o)for(;o--;)if(t=i[o],e.addEventListener)e.addEventListener(t,n,!1);else{n._d||(n._d={els:[]});var a=t+n.toString(),r=p.indexOf(n._d.els,e);n._d[a]&&-1!=r||(-1==r&&n._d.els.push(e),n._d[a]||(n._d[a]=function(e){return n.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,n._d[a]))}e=null},un:function(e,t,n){var i=p.isArray(t)?t:[t],o=i.length;if(o)for(;o--;)if(t=i[o],e.removeEventListener)e.removeEventListener(t,n,!1);else{var a=t+n.toString();try{e.detachEvent("on"+t,n._d?n._d[a]:n)}catch(e){}n._d&&n._d[a]&&(t=p.indexOf(n._d.els,e),-1!=t&&n._d.els.splice(t,1),0==n._d.els.length&&delete n._d[a])}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return!1;var n=e.attributes,i=t.attributes;if(!I&&n.length!=i.length)return!1;for(var o,a,r=0,s=0,l=0;o=n[l++];){if("style"==o.nodeName){if(o.specified&&r++,f.isSameStyle(e,t))continue;return!1}if(I){if(!o.specified)continue;r++,a=i.getNamedItem(o.nodeName)}else a=t.attributes[o.nodeName];if(!a.specified||o.nodeValue!=a.nodeValue)return!1}if(I){for(l=0;a=i[l++];)a.specified&&s++;if(r!=s)return!1}return!0},isSameStyle:function(e,t){var i=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),o=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(n.opera){if(i=e.style,o=t.style,i.length!=o.length)return!1;for(var a in i)if(!/^(\d+|csstext)$/i.test(a)&&i[a]!=o[a])return!1;return!0}if(!i||!o)return i==o;if(i=i.split(";"),o=o.split(";"),i.length!=o.length)return!1;a=0;for(var r;r=i[a++];)if(-1==p.indexOf(o,r))return!1;return!0},isBlockElm:function(e){return 1==e.nodeType&&(t.$block[e.tagName]||Jc[f.getComputedStyle(e,"display")])&&!t.$nonChild[e.tagName]},isBody:function(e){return e&&1==e.nodeType&&"body"==e.tagName.toLowerCase()},breakParent:function(e,t){var n,i,o,a=e,r=e;do{for(a=a.parentNode,i?(n=a.cloneNode(!1),n.appendChild(i),i=n,n=a.cloneNode(!1),n.appendChild(o),o=n):(i=a.cloneNode(!1),o=i.cloneNode(!1));n=r.previousSibling;)i.insertBefore(n,i.firstChild);for(;n=r.nextSibling;)o.appendChild(n);r=a}while(t!==a);return n=t.parentNode,n.insertBefore(i,t),n.insertBefore(o,t),n.insertBefore(e,o),f.remove(t),e},isEmptyInlineElement:function(e){if(1!=e.nodeType||!t.$removeEmpty[e.tagName])return 0;for(e=e.firstChild;e;){if(f.isBookmarkNode(e)||1==e.nodeType&&!f.isEmptyInlineElement(e)||3==e.nodeType&&!f.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){for(var n;(n=e[t])&&3==n.nodeType&&f.isWhitespace(n);)e.removeChild(n)}t("firstChild"),t("lastChild")},mergeChild:function(e,t,n){t=f.getElementsByTagName(e,e.tagName.toLowerCase());for(var i,o=0;i=t[o++];)if(i.parentNode&&!f.isBookmarkNode(i))if("span"==i.tagName.toLowerCase()){if(e===i.parentNode&&(f.trimWhiteTextNode(e),1==e.childNodes.length)){e.style.cssText=i.style.cssText+";"+e.style.cssText,f.remove(i,!0);continue}if(i.style.cssText=e.style.cssText+";"+i.style.cssText,n){var a=n.style;if(a)for(var r,a=a.split(";"),s=0;r=a[s++];)i.style[p.cssStyleToDomStyle(r.split(":")[0])]=r.split(":")[1]}f.isSameStyle(i,e)&&f.remove(i,!0)}else f.isSameElement(e,i)&&f.remove(i,!0)},getElementsByTagName:function(e,t,n){if(n&&p.isString(n)){var i=n;n=function(e){return f.hasClass(e,i)}}t=p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var o,a=[],r=0;o=t[r++];){o=e.getElementsByTagName(o);for(var s,l=0;s=o[l++];)(!n||n(s))&&a.push(s)}return a},mergeToParent:function(e){for(var n=e.parentNode;n&&t.$removeEmpty[n.tagName];){if(n.tagName==e.tagName||"A"==n.tagName){if(f.trimWhiteTextNode(n),"SPAN"==n.tagName&&!f.isSameStyle(n,e)||"A"==n.tagName&&"SPAN"==e.tagName){if(1<n.childNodes.length||n!==e.parentNode){e.style.cssText=n.style.cssText+";"+e.style.cssText,n=n.parentNode;continue}n.style.cssText+=";"+e.style.cssText,"A"==n.tagName&&(n.style.textDecoration="underline")}if("A"!=n.tagName){n===e.parentNode&&f.remove(e,!0);break}}n=n.parentNode}},mergeSibling:function(e,t,n){function i(e,t,n){var i;if((i=n[e])&&!f.isBookmarkNode(i)&&1==i.nodeType&&f.isSameElement(n,i)){for(;i.firstChild;)"firstChild"==t?n.insertBefore(i.lastChild,n.firstChild):n.appendChild(i.firstChild);f.remove(i)}}!t&&i("previousSibling","firstChild",e),!n&&i("nextSibling","lastChild",e)},unSelectable:I||n.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t,n=0;t=e.all[n++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=p.isArray(t)?t:p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i,o=0;i=t[o++];){switch(i=ub[i]||i){case"className":e[i]="";break;case"style":e.style.cssText="",!n.ie&&e.removeAttributeNode(e.getAttributeNode("style"))}e.removeAttribute(i)}},createElement:function(e,t,n){return f.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];switch(n){case"class":e.className=i;break;case"style":e.style.cssText=e.style.cssText+";"+i;break;case"innerHTML":e[n]=i;break;case"value":e.value=i;break;default:e.setAttribute(ub[n]||n,i)}}return e},getComputedStyle:function(e,i){if(-1<"width height top left".indexOf(i))return e["offset"+i.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";if(3==e.nodeType&&(e=e.parentNode),n.ie&&9>n.version&&"font-size"==i&&!e.style.fontSize&&!t.$empty[e.tagName]&&!t.$nonChild[e.tagName]){var o=e.ownerDocument.createElement("span");o.style.cssText="padding:0;border:0;font-family:simsun;",o.innerHTML=".",e.appendChild(o);var a=o.offsetHeight;return e.removeChild(o),o=null,a+"px"}try{o=f.getStyle(e,i)||(window.getComputedStyle?f.getWindow(e).getComputedStyle(e,"").getPropertyValue(i):(e.currentStyle||e.style)[p.cssStyleToDomStyle(i)])}catch(e){return""}return p.transUnitToPx(p.fixColor(i,o))},removeClasses:function(e,t){t=p.isArray(t)?t:p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)o=o.replace(RegExp("\\b"+n+"\\b"),"");(o=p.trim(o).replace(/[ ]{2,}/g," "))?e.className=o:f.removeAttributes(e,["class"])},addClass:function(e,t){if(e){t=p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)RegExp("\\b"+n+"\\b").test(o)||(e.className+=" "+n)}},hasClass:function(e,t){if(p.isRegExp(t))return t.test(e.className);t=p.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,i=0,o=e.className;n=t[i++];)if(!RegExp("\\b"+n+"\\b","i").test(o))return!1;return i-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){n.ie?e.style.cssText=e.style.cssText.replace(RegExp(t+"[^:]*:[^;]+;?","ig"),""):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(p.cssStyleToDomStyle(t)),e.style.cssText||f.removeAttributes(e,["style"])},getStyle:function(e,t){var n=e.style[p.cssStyleToDomStyle(t)];return p.fixColor(t,n)},setStyle:function(e,t,n){e.style[p.cssStyleToDomStyle(t)]=n,p.trim(e.style.cssText)||this.removeAttributes(e,"style")},setStyles:function(e,t){for(var n in t)t.hasOwnProperty(n)&&f.setStyle(e,n,t[n])},removeDirtyAttr:function(e){for(var t,n=0,i=e.getElementsByTagName("*");t=i[n++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,i=e.firstChild;for(t=t||function(){return 1};i;)t(i)&&n++,i=i.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||0==f.getChildCount(e,function(e){return!f.isBr(e)&&!f.isBookmarkNode(e)&&!f.isWhitespace(e)})},clearSelectedArr:function(e){for(var t;t=e.pop();)f.removeAttributes(t,["class"])},scrollToView:function(e,t,n){var i=t.document,i=("CSS1Compat"==i.compatMode?i.documentElement.clientHeight:i.body.clientHeight)||0;n=-1*i+n+(e.offsetHeight||0),e=f.getXY(e),n+=e.y,"pageXOffset"in t?e=t.pageYOffset||0:(e=t.document,e=e.documentElement.scrollTop||e.body.scrollTop||0),(n>e||n<e-i)&&t.scrollTo(0,n+(0>n?-20:20))},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){return 3==e.nodeType&&!e.nodeValue.replace(RegExp((t?"^":"")+f.fillChar),"").length},isStartInblock:function(e){e=e.cloneRange();var t,n=0,i=e.startContainer;if(1==i.nodeType&&i.childNodes[e.startOffset])for(var i=i.childNodes[e.startOffset],o=i.previousSibling;o&&f.isFillChar(o);)i=o,o=o.previousSibling;for(this.isFillChar(i,!0)&&1==e.startOffset&&(e.setStartBefore(i),i=e.startContainer);i&&f.isFillChar(i);)t=i,i=i.previousSibling;for(t&&(e.setStartBefore(t),i=e.startContainer),1==i.nodeType&&f.isEmptyNode(i)&&1==e.startOffset&&e.setStart(i,0).collapse(!0);!e.startOffset;){if(i=e.startContainer,f.isBlockElm(i)||f.isBody(i)){n=1;break}var a,o=e.startContainer.previousSibling;if(o){for(;o&&f.isFillChar(o);)a=o,o=o.previousSibling;a?e.setStartBefore(a):e.setStartBefore(e.startContainer)}else e.setStartBefore(e.startContainer)}return n&&!f.isBody(e.startContainer)?1:0},isEmptyBlock:function(e,i){if(i=i||RegExp("[ \t\r\n"+f.fillChar+"]","g"),0<e[n.ie?"innerText":"textContent"].replace(i,"").length)return 0;for(var o in t.$isNotEmpty)if(e.getElementsByTagName(o).length)return 0;return 1},setViewportOffset:function(e,t){var n=0|parseInt(e.style.left),i=0|parseInt(e.style.top),o=e.getBoundingClientRect(),a=t.left-o.left,o=t.top-o.top;a&&(e.style.left=n+a+"px"),o&&(e.style.top=i+o+"px")},fillNode:function(e,t){var i=n.ie?e.createTextNode(f.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(i)},moveChild:function(e,t,n){for(;e.firstChild;)n&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return n.ie?/^<\w+\s*?>/.test(e.outerHTML):0==e.attributes.length},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return 1==e.nodeType&&RegExp(e.tagName,"i").test(t)},filterNodeList:function(e,t,n){var i=[];if(!p.isFunction(t)){var o=t;t=function(e){return-1!=p.indexOf(p.isArray(o)?o:o.split(" "),e.tagName.toLowerCase())}}return p.each(e,function(e){t(e)&&i.push(e)}),0==i.length?null:1!=i.length&&n?i:i[0]},isInNodeEndBoundary:function(e,t){var n=e.startContainer;if(3==n.nodeType&&e.startOffset!=n.nodeValue.length||1==n.nodeType&&e.startOffset!=n.childNodes.length)return 0;for(;n!==t;){if(n.nextSibling)return 0;n=n.parentNode}return 1},isBoundaryNode:function(e,t){for(var n;!f.isBody(e);)if(n=e,e=e.parentNode,n!==e[t])return!1;return!0}},fa=RegExp(f.fillChar,"g"),vb=function(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&1==e.endOffset-e.startOffset},wb=function(e,n,i,o){return 1==n.nodeType&&(t.$empty[n.tagName]||t.$nonChild[n.tagName])&&(i=f.getNodeIndex(n)+(e?0:1),n=n.parentNode),e?(o.startContainer=n,o.startOffset=i,o.endContainer||o.collapse(!0)):(o.endContainer=n,o.endOffset=i,o.startContainer||o.collapse(!1)),o.collapsed=o.startContainer&&o.endContainer&&o.startContainer===o.endContainer&&o.startOffset==o.endOffset,o},Ha=function(e,t){var n,i,o=e.startContainer,a=e.endContainer,r=e.startOffset,s=e.endOffset,l=e.document,d=l.createDocumentFragment();if(1==o.nodeType&&(o=o.childNodes[r]||(n=o.appendChild(l.createTextNode("")))),1==a.nodeType&&(a=a.childNodes[s]||(i=a.appendChild(l.createTextNode("")))),o===a&&3==o.nodeType)return d.appendChild(l.createTextNode(o.substringData(r,s-r))),t&&(o.deleteData(r,s-r),e.collapse(!0)),d;for(var c,u,m=d,h=f.findParents(o,!0),p=f.findParents(a,!0),g=0;h[g]==p[g];)g++;for(var b,v=g;b=h[v];v++){for(c=b.nextSibling,b==o?n||(3==e.startContainer.nodeType?(m.appendChild(l.createTextNode(o.nodeValue.slice(r))),t&&o.deleteData(r,o.nodeValue.length-r)):m.appendChild(t?o:o.cloneNode(!0))):(u=b.cloneNode(!1),m.appendChild(u));c&&c!==a&&c!==p[v];)b=c.nextSibling,m.appendChild(t?c:c.cloneNode(!0)),c=b;m=u}for(m=d,h[g]||(m.appendChild(h[g-1].cloneNode(!1)),m=m.firstChild),v=g;r=p[v];v++){if(c=r.previousSibling,r==a?!i&&3==e.endContainer.nodeType&&(m.appendChild(l.createTextNode(a.substringData(0,s))),t&&a.deleteData(0,s)):(u=r.cloneNode(!1),m.appendChild(u)),v!=g||!h[g])for(;c&&c!==o;)r=c.previousSibling,m.insertBefore(t?c:c.cloneNode(!0),m.firstChild),c=r;m=u}return t&&e.setStartBefore(p[g]?h[g]?p[g]:h[g-1]:p[g-1]).collapse(!0),n&&f.remove(n),i&&f.remove(i),d},xb=function(e,t){try{if(J&&f.inDoc(J,e))if(J.nodeValue.replace(fa,"").length)J.nodeValue=J.nodeValue.replace(fa,"");else{var i=J.parentNode;for(f.remove(J);i&&f.isEmptyInlineElement(i)&&(n.safari?!(f.getPosition(i,t)&f.POSITION_CONTAINS):!i.contains(t));)J=i.parentNode,f.remove(i),i=J}}catch(e){}},ra=function(e,t){var n;for(e=e[t];e&&f.isFillChar(e);)n=e[t],f.remove(e),e=n},yb=0,Ia=f.fillChar,J,zb=R.Range=function(e){this.startContainer=this.startOffset=this.endContainer=this.endOffset=null,this.document=e,this.collapsed=!0};zb.prototype={cloneContents:function(){return this.collapsed?null:Ha(this,0)},deleteContents:function(){var e;return this.collapsed||Ha(this,1),n.webkit&&(e=this.startContainer,3==e.nodeType&&!e.nodeValue.length&&(this.setStartBefore(e).collapse(!0),f.remove(e))),this},extractContents:function(){return this.collapsed?null:Ha(this,2)},setStart:function(e,t){return wb(!0,e,t,this)},setEnd:function(e,t){return wb(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,f.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,f.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,f.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,f.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){return new zb(this.document).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)},collapse:function(e){return e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset),this.collapsed=!0,this},shrinkBoundary:function(e){function n(e){return 1==e.nodeType&&!f.isBookmarkNode(e)&&!t.$empty[e.tagName]&&!t.$nonChild[e.tagName]}for(var i,o=this.collapsed;1==this.startContainer.nodeType&&(i=this.startContainer.childNodes[this.startOffset])&&n(i);)this.setStart(i,0);if(o)return this.collapse(!0);if(!e)for(;1==this.endContainer.nodeType&&0<this.endOffset&&(i=this.endContainer.childNodes[this.endOffset-1])&&n(i);)this.setEnd(i,i.childNodes.length);return this},getCommonAncestor:function(e,t){var n=this.startContainer,i=this.endContainer;return n===i?e&&vb(this)&&(n=n.childNodes[this.startOffset],1==n.nodeType)?n:t&&3==n.nodeType?n.parentNode:n:f.getCommonAncestor(n,i)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,i=this.collapsed,o=this.endContainer;if(3==t.nodeType){if(0==n)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var a=f.split(t,n);t===o?this.setEnd(a,this.endOffset-n):t.parentNode===o&&(this.endOffset+=1),this.setStartBefore(a)}if(i)return this.collapse(!0)}return e||(n=this.endOffset,o=this.endContainer,3==o.nodeType&&(0==n?this.setEndBefore(o):(n<o.nodeValue.length&&f.split(o,n),this.setEndAfter(o)))),this},txtToElmBoundary:function(){function e(e,t){var n=e[t+"Container"],i=e[t+"Offset"];3==n.nodeType&&(i?i>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return this.collapsed||(e(this,"start"),e(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var i=this.startContainer,o=i.childNodes[this.startOffset];return o?i.insertBefore(e,o):i.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset+=n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("‍")),i.id="_baidu_bookmark_start_"+(t?"":yb++),this.collapsed||(n=i.cloneNode(!0),n.id="_baidu_bookmark_end_"+(t?"":yb++)),this.insertNode(i),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(i),{start:e?i.id:i,end:n?e?n.id:n:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start;return e=e.end&&e.id?this.document.getElementById(e.end):e.end,this.setStartBefore(t),f.remove(t),e?(this.setEndBefore(e),f.remove(e)):this.collapse(!0),this},enlarge:function(e,t){var n,i,o=f.isBody,a=this.document.createTextNode("");if(e){for(i=this.startContainer,1==i.nodeType?i.childNodes[this.startOffset]?n=i=i.childNodes[this.startOffset]:(i.appendChild(a),n=i=a):n=i;;){if(f.isBlockElm(i)){for(i=n;(n=i.previousSibling)&&!f.isBlockElm(n);)i=n;this.setStartBefore(i);break}n=i,i=i.parentNode}for(i=this.endContainer,1==i.nodeType?((n=i.childNodes[this.endOffset])?i.insertBefore(a,n):i.appendChild(a),n=i=a):n=i;;){if(f.isBlockElm(i)){for(i=n;(n=i.nextSibling)&&!f.isBlockElm(n);)i=n;this.setEndAfter(i);break}n=i,i=i.parentNode}a.parentNode===this.endContainer&&this.endOffset--,f.remove(a)}if(!this.collapsed){for(;!(0!=this.startOffset||t&&t(this.startContainer)||o(this.startContainer));)this.setStartBefore(this.startContainer);
for(;!(this.endOffset!=(1==this.endContainer.nodeType?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)||t&&t(this.endContainer)||o(this.endContainer));)this.setEndAfter(this.endContainer)}return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!f.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!f.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,n,i){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return 1==e.nodeType&&f.isBlockElm(e)}).adjustmentBoundary();for(var o,a,r=this.createBookmark(),s=r.end,l=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!f.isWhitespace(e)},d=f.getNextDomNode(r.start,!1,l),c=this.cloneRange();d&&f.getPosition(d,s)&f.POSITION_PRECEDING;)if(3==d.nodeType||t[e][d.tagName]){for(c.setStartBefore(d),o=d;o&&(3==o.nodeType||t[e][o.tagName])&&o!==s;)a=o,o=f.getNextDomNode(o,1==o.nodeType,null,function(n){return t[e][n.tagName]});var u,d=c.setEndAfter(a).extractContents();if(i&&0<i.length){var m;m=u=i[0].cloneNode(!1);for(var h,p=1;h=i[p++];)u.appendChild(h.cloneNode(!1)),u=u.firstChild}else u=c.document.createElement(e);n&&f.setAttributes(u,n),u.appendChild(d),c.insertNode(i?m:u);var g;if("span"==e&&n.style&&/text\-decoration/.test(n.style)&&(g=f.findParentByTagName(u,"a",!0))?(f.setAttributes(g,n),f.remove(u,!0),u=g):(f.mergeSibling(u),f.clearEmptySibling(u)),f.mergeChild(u,n),d=f.getNextDomNode(u,!1,l),f.mergeToParent(u),o===s)break}else d=f.getNextDomNode(d,!0,l);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=p.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();for(var t=this.startContainer,n=this.endContainer;;){if(1==t.nodeType){if(-1<p.indexOf(e,t.tagName.toLowerCase()))break;if("body"==t.tagName.toLowerCase()){t=null;break}}t=t.parentNode}for(;;){if(1==n.nodeType){if(-1<p.indexOf(e,n.tagName.toLowerCase()))break;if("body"==n.tagName.toLowerCase()){n=null;break}}n=n.parentNode}var i,o,a=this.createBookmark();for(t&&(o=this.cloneRange().setEndBefore(a.start).setStartBefore(t),i=o.extractContents(),o.insertNode(i),f.clearEmptySibling(t,!0),t.parentNode.insertBefore(a.start,t)),n&&(o=this.cloneRange().setStartAfter(a.end).setEndAfter(n),i=o.extractContents(),o.insertNode(i),f.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(a.end,n.nextSibling)),t=f.getNextDomNode(a.start,!1,function(e){return 1==e.nodeType});t&&t!==a.end;)n=f.getNextDomNode(t,!0,function(e){return 1==e.nodeType}),-1<p.indexOf(e,t.tagName.toLowerCase())&&f.remove(t,!0),t=n;return this.moveToBookmark(a)},getClosedNode:function(){var e;if(!this.collapsed){var n=this.cloneRange().adjustmentBoundary().shrinkBoundary();vb(n)&&(n=n.startContainer.childNodes[n.startOffset])&&1==n.nodeType&&(t.$empty[n.tagName]||t.$nonChild[n.tagName])&&(e=n)}return e},select:n.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var i=this.getClosedNode();if(i&&!t){try{n=this.document.body.createControlRange(),n.addElement(i),n.select()}catch(e){}return this}var i=this.createBookmark(),o=i.start;if(n=this.document.body.createTextRange(),n.moveToElementText(o),n.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var a=this.document.createTextNode(Ia),r=this.document.createElement("span");r.appendChild(this.document.createTextNode(Ia)),o.parentNode.insertBefore(r,o),o.parentNode.insertBefore(a,o),xb(this.document,a),J=a,ra(r,"previousSibling"),ra(o,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}}else a=this.document.body.createTextRange(),o=i.end,a.moveToElementText(o),n.setEndPoint("EndToEnd",a);this.moveToBookmark(i),r&&f.remove(r);try{n.select()}catch(e){}return this}:function(e){var t=f.getWindow(this.document),i=t.getSelection();if(n.gecko?this.document.body.focus():t.focus(),i){if(i.removeAllRanges(),!this.collapsed||e||(e=t=this.startContainer,1==t.nodeType&&(e=t.childNodes[this.startOffset]),3==t.nodeType&&this.startOffset||(e?e.previousSibling&&3==e.previousSibling.nodeType:t.lastChild&&3==t.lastChild.nodeType))||(e=this.document.createTextNode(Ia),this.insertNode(e),xb(this.document,e),ra(e,"previousSibling"),ra(e,"nextSibling"),J=e,this.setStart(e,n.webkit?1:0).collapse(!0)),t=this.document.createRange(),this.collapsed&&n.opera&&1==this.startContainer.nodeType)if(e=this.startContainer.childNodes[this.startOffset]){for(;e&&f.isBlockElm(e)&&(1==e.nodeType&&e.childNodes[0]);)e=e.childNodes[0];e&&this.setStartBefore(e).collapse(!0)}else(e=this.startContainer.lastChild)&&f.isBr(e)&&this.setStartBefore(e).collapse(!0);var o=this;e=function(e,t,n){3==e.nodeType&&e.nodeValue.length<t&&(o[n+"Offset"]=e.nodeValue.length)},e(o.startContainer,o.startOffset,"start"),e(o.endContainer,o.endOffset,"end"),t.setStart(this.startContainer,this.startOffset),t.setEnd(this.endContainer,this.endOffset),i.addRange(t)}return this},scrollToView:function(e,t){e=e?window:f.getWindow(this.document);var n=this.document.createElement("span");return n.innerHTML="&nbsp;",this.cloneRange().insertNode(n),f.scrollToView(n,e,t),f.remove(n),this},inFillChar:function(){var e=this.startContainer;return!(!this.collapsed||3!=e.nodeType||e.nodeValue.replace(RegExp("^"+f.fillChar),"").length+1!=e.nodeValue.length)},createAddress:function(e,t){function n(e){for(var n,i=e?o.startContainer:o.endContainer,a=f.findParents(i,!0,function(e){return!f.isBody(e)}),r=[],s=0;n=a[s++];)r.push(f.getNodeIndex(n,t));if(a=0,t)if(3==i.nodeType){for(i=i.previousSibling;i&&3==i.nodeType;)a+=i.nodeValue.replace(fa,"").length,i=i.previousSibling;a+=e?o.startOffset:o.endOffset}else if(i=i.childNodes[e?o.startOffset:o.endOffset])a=f.getNodeIndex(i,t);else for(i=e?o.startContainer:o.endContainer,e=i.firstChild;e;)if(f.isFillChar(e))e=e.nextSibling;else if(a++,3==e.nodeType)for(;e&&3==e.nodeType;)e=e.nextSibling;else e=e.nextSibling;else a=e?f.isFillChar(i)?0:o.startOffset:o.endOffset;return 0>a&&(a=0),r.push(a),r}var i={},o=this;return i.startAddress=n(!0),e||(i.endAddress=o.collapsed?[].concat(i.startAddress):n()),i},moveToAddress:function(e,t){function n(e,t){for(var n,o,a,r=i.document.body,s=0,l=e.length;s<l;s++)if(a=e[s],n=r,r=r.childNodes[a],!r){o=a;break}t?r?i.setStartBefore(r):i.setStart(n,o):r?i.setEndBefore(r):i.setEnd(n,o)}var i=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),i},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),i=n.end,o=f.getNextDomNode(n.start,!1,t);o&&o!==i&&f.getPosition(o,i)&f.POSITION_PRECEDING;){var a=f.getNextDomNode(o,!1,t);e(o),o=a}return this.moveToBookmark(n)}};var Ab=function(e,n){var i=f.getNodeIndex;e=e.duplicate(),e.collapse(n);var o=e.parentElement();if(!o.hasChildNodes())return{container:o,offset:0};for(var a,r=o.children,s=e.duplicate(),l=0,d=r.length-1,c=-1;l<=d;){c=Math.floor((l+d)/2),a=r[c],s.moveToElementText(a);var u=s.compareEndPoints("StartToStart",e);if(0<u)d=c-1;else{if(!(0>u))return{container:o,offset:i(a)};l=c+1}}if(-1==c){if(s.moveToElementText(o),s.setEndPoint("StartToStart",e),s=s.text.replace(/(\r\n|\r)/g,"\n").length,r=o.childNodes,!s)return a=r[r.length-1],{container:a,offset:a.nodeValue.length};for(i=r.length;0<s;)s-=r[--i].nodeValue.length;return{container:r[i],offset:-s}}if(s.collapse(0<u),s.setEndPoint(0<u?"StartToStart":"EndToStart",e),s=s.text.replace(/(\r\n|\r)/g,"\n").length,!s)return t.$empty[a.tagName]||t.$nonChild[a.tagName]?{container:o,offset:i(a)+(0<u?0:1)}:{container:a,offset:0<u?0:a.childNodes.length};for(;0<s;)try{r=a,a=a[0<u?"previousSibling":"nextSibling"],s-=a.nodeValue.length}catch(e){return{container:o,offset:i(r)}}return{container:a,offset:0<u?-s:a.nodeValue.length+s}},Ja=function(e){var t;try{t=e.getNative().createRange()}catch(e){return null}var n=t.item?t.item(0):t.parentElement();return(n.ownerDocument||n)===e.document?t:null};(R.Selection=function(e){var t=this;t.document=e,I&&(e=f.getWindow(e).frameElement,f.on(e,"beforedeactivate",function(){t._bakIERange=t.getIERange()}),f.on(e,"activate",function(){try{!Ja(t)&&t._bakIERange&&t._bakIERange.select()}catch(e){}t._bakIERange=null})),e=e=null}).prototype={getNative:function(){var e=this.document;try{return e?I?e.selection:f.getWindow(e).getSelection():null}catch(e){return null}},getIERange:function(){var e=Ja(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?f.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return!!(n.ie&&Ja(this)||!n.ie&&this.getNative().rangeCount)}catch(e){return!1}},getRange:function(){function e(e){for(var n=t.document.body.firstChild,i=e.collapsed;n&&n.firstChild;)e.setStart(n,0),n=n.firstChild;e.startContainer||e.setStart(t.document.body,0),i&&e.collapse(!0)}var t=this;if(null!=t._cachedRange)return this._cachedRange;var n=new q.editor.dom.Range(t.document);if(I){var i=t.getIERange();if(i)try{if(i.item)n.selectNode(i.item(0));else{var o=Ab(i,!0);n.setStart(o.container,o.offset),0!=i.compareEndPoints("StartToEnd",i)&&(o=Ab(i,!1),n.setEnd(o.container,o.offset))}}catch(t){e(n)}else e(n)}else if((o=t.getNative())&&o.rangeCount)i=o.getRangeAt(0),o=o.getRangeAt(o.rangeCount-1),n.setStart(i.startContainer,i.startOffset).setEnd(o.endContainer,o.endOffset),n.collapsed&&f.isBody(n.startContainer)&&!n.startOffset&&e(n);else{if(this._bakRange&&f.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;e(n)}return this._bakRange=n},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e,t,n=I?this.getIERange():this.getRange();if(I){if(!n)return this.document.body.firstChild;if(n.item)return n.item(0);for(e=n.duplicate(),0<e.text.length&&e.moveStart("character",1),e.collapse(1),e=e.parentElement(),t=n=n.parentElement();n=n.parentNode;)if(n==e){e=t;break}}else if(n.shrinkBoundary(),e=n.startContainer,1==e.nodeType&&e.hasChildNodes()&&(e=e.childNodes[Math.min(e.childNodes.length-1,n.startOffset)]),3==e.nodeType)return e.parentNode;return e},getText:function(){var e;return this.isFocus()&&(e=this.getNative())?(e=n.ie?e.createRange():e.getRangeAt(0),n.ie?e.text:e.toString()):""},clearRange:function(){this.getNative()[n.ie?"empty":"removeAllRanges"]()}};var sa=function(e,t){var n;if(t.textarea)if(p.isString(t.textarea)){for(var i,o=0,a=f.getElementsByTagName(e,"textarea");i=a[o++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=f.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""},Kc=0,Bb,Cb=UE.Editor=function(e){var t=this;t.uid=Kc++,Da.call(t),t.commands={},t.options=p.extend(p.clone(e||{}),UEDITOR_CONFIG,!0),t.shortcutkeys={},t.inputRules=[],t.outputRules=[],t.setOpt({isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:t.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:t.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0}),p.loadFile(document,{src:t.options.langPath+t.options.lang+"/"+t.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){for(var e in UE.plugins)UE.plugins[e].call(t);t.langIsReady=!0,t.fireEvent("langReady")}),UE.instants["ueditorInstant"+t.uid]=t},Db=function(){var e=this;e.document.getElementById("initContent")&&(e.body.innerHTML="<p>"+(I?"":"<br/>")+"</p>",e.removeListener("firstBeforeExecCommand focus",Db),setTimeout(function(){e.focus(),e._selectionChange()},0))};Cb.prototype={ready:function(e){e&&(this.isReady?e.apply(this):this.addListener("ready",e))},setOpt:function(e,t){var n={};p.isString(e)?n[e]=t:n=e,p.extend(this.options,n,!0)},destroy:function(){this.fireEvent("destroy");var e=this.container.parentNode,t=this.textarea;t?t.style.display="":(t=document.createElement("textarea"),e.parentNode.insertBefore(t,e)),t.style.width=this.iframe.offsetWidth+"px",t.style.height=this.iframe.offsetHeight+"px",t.value=this.getContent(),t.id=this.key,e.innerHTML="",f.remove(e);var n,e=this.key;for(n in this)this.hasOwnProperty(n)&&delete this[n];UE.delEditor(e)},render:function(e){var t=this.options;if(p.isString(e)&&(e=document.getElementById(e)),e){var i=I&&9>n.version,i=(I&&9>n.version?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(i?"":" class='view'")+"><head>"+(t.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+p.unhtml(t.iframeCssUrl)+"'/>":"")+"<style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}"+(t.initialStyle||"")+"</style></head><body"+(i?" class='view'":"")+"></body>";t.customDomain&&document.domain!=location.hostname?(i+="<script>window.parent.UE.instants['ueditorInstant"+this.uid+"']._setup(document);</script></html>",e.appendChild(f.createElement(document,"iframe",{id:"ueditor_"+this.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";document.write("'+i+'");document.close();}())'}))):(t.minFrameWidth=t.initialFrameWidth?t.initialFrameWidth:t.initialFrameWidth=e.offsetWidth,t.initialFrameHeight?t.minFrameHeight=t.initialFrameHeight:t.initialFrameHeight=t.minFrameHeight=e.offsetHeight,e.style.width=t.initialFrameWidth+"px",e.style.height=t.initialFrameHeight+"px",e.style.zIndex=t.zIndex,e.innerHTML='<iframe id="ueditor_'+this.uid+'"width="100%" height="100%" scroll="no" frameborder="0" ></iframe>',t=e.firstChild.contentWindow.document,t.open(),t.write(i+"</html>"),t.close(),this._setup(t)),e.style.overflow="hidden"}},_setup:function(e){var t=this,i=t.options;I?(e.body.disabled=!0,e.body.contentEditable=!0,e.body.disabled=!1):(e.body.contentEditable=!0,e.body.spellcheck=!1),t.document=e,t.window=e.defaultView||e.parentWindow,t.iframe=t.window.frameElement,t.body=e.body,t.selection=new R.Selection(e);var o;n.gecko&&(o=this.selection.getNative())&&o.removeAllRanges(),this._initEvents();for(var a=this.iframe.parentNode;!f.isBody(a);a=a.parentNode)if("FORM"==a.tagName){t.form=a,t.options.autoSyncData?f.on(t.window,"blur",function(){sa(a,t)}):f.on(a,"submit",function(){sa(this,t)});break}if(i.initialContent)if(i.autoClearinitialContent){var r=t.execCommand;t.execCommand=function(){return t.fireEvent("firstBeforeExecCommand"),r.apply(t,arguments)},this._setDefaultContent(i.initialContent)}else this.setContent(i.initialContent,!1,!0);f.isEmptyNode(t.body)&&(t.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>"),i.focus&&setTimeout(function(){t.focus(t.options.focusInEnd),!t.options.autoClearinitialContent&&t._selectionChange()},0),t.container||(t.container=this.iframe.parentNode),i.fullscreen&&t.ui&&t.ui.setFullScreen(!0);try{t.document.execCommand("2D-position",!1,!1)}catch(e){}try{t.document.execCommand("enableInlineTableEditing",!1,!1)}catch(e){}try{t.document.execCommand("enableObjectResizing",!1,!1)}catch(e){}t._bindshortcutKeys(),t.isReady=1,t.fireEvent("ready"),i.onready&&i.onready.call(t),n.ie||f.on(t.window,["blur","focus"],function(e){if("blur"==e.type){t._bakRange=t.selection.getRange();try{t.selection.getNative().removeAllRanges()}catch(e){}}else try{t._bakRange&&t._bakRange.select()}catch(e){}}),n.gecko&&10902>=n.version&&(t.body.contentEditable=!1,setTimeout(function(){t.body.contentEditable=!0},100),setInterval(function(){t.body.style.height=t.iframe.offsetHeight-20+"px"},100)),!i.isShow&&t.setHide(),i.readonly&&t.setDisabled()},sync:function(e){(e=e?document.getElementById(e):f.findParent(this.iframe.parentNode,function(e){return"FORM"==e.tagName},!0))&&sa(e,this)},setHeight:function(e){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px"),this.document.body.style.height=e-20+"px"},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,p.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,i){var o,a=i.keyCode||i.which;for(o in t)for(var r,s=t[o].split(","),l=0;r=s[l++];){r=r.split(":");var d=r[0];r=r[1],(/^(ctrl)(\+shift)?\+(\d+)$/.test(d.toLowerCase())||/^(\d+)$/.test(d))&&("ctrl"==RegExp.$1&&(i.ctrlKey||i.metaKey)&&(""!=RegExp.$2?i[RegExp.$2.slice(1)+"Key"]:1)&&a==RegExp.$3||a==RegExp.$1)&&(-1!=e.queryCommandState(o,r)&&e.execCommand(o,r),f.preventDefault(i))}})},getContent:function(e,t,n,i,o){return e&&p.isFunction(e)&&(t=e,e=""),(t?t():this.hasContents())?(this.fireEvent("beforegetcontent"),t=UE.htmlparser(this.body.innerHTML,i),this.filterOutputRule(t),this.fireEvent("aftergetcontent",e),t.toHtml(o)):""},getAllHtml:function(){var e=[];if(this.fireEvent("getAllHtml",e),n.ie&&8<n.version){var t="";p.each(this.document.styleSheets,function(e){t+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),p.each(this.document.getElementsByTagName("script"),function(e){t+=e.outerHTML})}return"<html><head>"+(this.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+this.options.charset+'"/>':"")+(t||this.document.getElementsByTagName("head")[0].innerHTML)+e.join("\n")+"</head><body "+(I&&9>n.version?'class="view"':"")+">"+this.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=RegExp(f.fillChar,"g"),n=this.body.innerHTML.replace(/[\n\r]/g,""),n=n.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>\/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,n,i){return t.$block[i]?"\n":n?n:""});return n.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){return this.body[n.ie?"innerText":"textContent"].replace(RegExp(f.fillChar,"g"),"").replace(/\u00a0/g," ")},setContent:function(e,i,o){if(this.fireEvent("beforesetcontent",e),e=UE.htmlparser(e),this.filterInputRule(e),e=e.toHtml(),this.body.innerHTML=(i?this.body.innerHTML:"")+e,"p"==this.options.enterTag)if(i=this.body.firstChild,!i||1==i.nodeType&&(t.$cdata[i.tagName]||"DIV"==i.tagName&&i.getAttribute("cdata_tag")||f.isCustomeNode(i))&&i===this.body.lastChild)this.body.innerHTML="<p>"+(n.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var a=this.document.createElement("p");i;){for(;i&&(3==i.nodeType||1==i.nodeType&&t.p[i.tagName]&&!t.$cdata[i.tagName]);)e=i.nextSibling,a.appendChild(i),i=e;if(a.firstChild){if(!i){this.body.appendChild(a);break}i.parentNode.insertBefore(a,i),a=this.document.createElement("p")}i=i.nextSibling}this.fireEvent("aftersetcontent"),this.fireEvent("contentchange"),!o&&this._selectionChange(),this._bakRange=this._bakIERange=null;var r;n.gecko&&(r=this.selection.getNative())&&r.removeAllRanges(),this.options.autoSyncData&&this.form&&sa(this.form,this)},focus:function(e){try{var t=this.selection.getRange();e?t.setStartAtLast(this.body.lastChild).setCursor(!1,!0):t.select(!0),this.fireEvent("focus")}catch(e){}},_initEvents:function(){var e=this,t=e.document,i=e.window;e._proxyDomEvent=p.bind(e._proxyDomEvent,e),f.on(t,"click contextmenu mousedown keydown keyup keypress mouseup mouseover mouseout selectstart".split(" "),e._proxyDomEvent),f.on(i,["focus","blur"],e._proxyDomEvent),f.on(t,["mouseup","keydown"],function(t){"keydown"==t.type&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)||2!=t.button&&e._selectionChange(250,t)});var o,a=0,t=n.ie?e.body:e.document;f.on(t,"dragstart",function(){a=1}),f.on(t,n.webkit?"dragover":"drop",n.webkit?function(){clearTimeout(o),o=setTimeout(function(){if(!a){var t=e.selection.getRange();if(t&&(t=t.getCommonAncestor())&&e.serialize){var n=e.serialize,i=n.filter(n.transformInput(n.parseHTML(n.word(t.innerHTML))));t.innerHTML=n.toHTML(i)}}a=0},200)}:function(e){a||(e.preventDefault?e.preventDefault():e.returnValue=!1),a=0})},_proxyDomEvent:function(e){return this.fireEvent(e.type.replace(/^on/,""),e)},_selectionChange:function(e,t){var i,o,a=this,r=!1;n.ie&&9>n.version&&t&&"mouseup"==t.type&&!this.selection.getRange().collapsed&&(r=!0,i=t.clientX,o=t.clientY),clearTimeout(Bb),Bb=setTimeout(function(){if(a.selection.getNative()){var e;if(r&&"None"==a.selection.getNative().type){e=a.document.body.createTextRange();try{e.moveToPoint(i,o)}catch(t){e=null}}var n;e&&(n=a.selection.getIERange,a.selection.getIERange=function(){return e}),a.selection.cache(),n&&(a.selection.getIERange=n),a.selection._cachedRange&&a.selection._cachedStartElement&&(a.fireEvent("beforeselectionchange"),a.fireEvent("selectionchange",!!t),a.fireEvent("afterselectionchange"),a.selection.clear())}},e||50)},_callCmdFn:function(e,t){var n,i=t[0].toLowerCase();return n=(i=this.commands[i]||UE.commands[i])&&i[e],i&&n||"queryCommandState"!=e?n?n.apply(this,t):void 0:0},execCommand:function(e){e=e.toLowerCase();var t,n=this.commands[e]||UE.commands[e];return n&&n.execCommand?(n.notNeedUndo||this.__hasEnterExecCommand?(t=this._callCmdFn("execCommand",arguments),!this._ignoreContentChange&&this.fireEvent("contentchange")):(this.__hasEnterExecCommand=!0,-1!=this.queryCommandState.apply(this,arguments)&&(this.fireEvent("beforeexeccommand",e),t=this._callCmdFn("execCommand",arguments),!this._ignoreContentChange&&this.fireEvent("contentchange"),this.fireEvent("afterexeccommand",e)),this.__hasEnterExecCommand=!1),!this._ignoreContentChange&&this._selectionChange(),t):null},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t,n=0;t=e[n++];)if(0<this.document.getElementsByTagName(t).length)return!0;if(!f.isEmptyBlock(this.body))return!0;for(e=["div"],n=0;t=e[n++];){t=f.getElementsByTagName(this.document,t);for(var i,o=0;i=t[o++];)if(f.isCustomeNode(i))return!0}return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e;if("false"==this.body.contentEditable){this.body.contentEditable=!0,e=this.selection.getRange();try{e.moveToBookmark(this.lastBk),delete this.lastBk}catch(t){e.setStartAtFirst(this.body).collapse(!0)}e.select(!0),this.bkqueryCommandState&&(this.queryCommandState=this.bkqueryCommandState,delete this.bkqueryCommandState),this.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?p.isArray(e)?e:[e]:[],"true"==t.body.contentEditable&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.queryCommandState=function(n){return-1!=p.indexOf(e,n)?t.bkqueryCommandState.apply(t,arguments):-1},t.fireEvent("selectionchange"))},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(e){this.body.innerHTML='<p id="initContent">'+e+"</p>",this.addListener("firstBeforeExecCommand focus",Db)},setShow:function(){var e=this.selection.getRange();if("none"==this.container.style.display){try{e.moveToBookmark(this.lastBk),delete this.lastBk}catch(t){e.setStartAtFirst(this.body).collapse(!0)}setTimeout(function(){e.select(!0)},100),this.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){this.lastBk||(this.lastBk=this.selection.getRange().createBookmark(!0)),this.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,i=0;(n=e[i++])&&(t=t[n],!!t););return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]);for(var i,n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length,o=0;i=t[o++];)n+=this.document.getElementsByTagName(i).length}return n},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t,n=0;t=this.inputRules[n++];)t.call(this,e)},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t,n=0;t=this.outputRules[n++];)t.call(this,e)}},p.inherits(Cb,Da);var Lc=UE,Eb=function(e){var t,n=[];for(t in e)"method"==t||"timeout"==t||"async"==t||"function"==(typeof e[t]).toLowerCase()||"object"==(typeof e[t]).toLowerCase()||n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")},Ka="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP"),Ka="ActiveXObject('Msxml2.XMLHTTP')"}catch(e){try{new ActiveXObject("Microsoft.XMLHTTP"),Ka="ActiveXObject('Microsoft.XMLHTTP')"}catch(e){}}var Mc=new Function("return new "+Ka);Lc.ajax={request:function(e,t){var n=Mc(),i=!1,o={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};if("object"==typeof e&&(t=e,e=t.url),n&&e){var a=t?p.extend(o,t):o,o=Eb(a);p.isEmptyObject(a.data)||(o+=(o?"&":"")+Eb(a.data));var r=setTimeout(function(){4!=n.readyState&&(i=!0,n.abort(),clearTimeout(r))},a.timeout),s=a.method.toUpperCase(),l=e+(-1==e.indexOf("?")?"?":"&")+("POST"==s?"":o+"&noCache="+ +new Date);n.open(s,l,a.async),n.onreadystatechange=function(){4==n.readyState&&(i||200!=n.status?a.onerror(n):a.onsuccess(n))},"POST"==s?(n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(o)):n.send(null)}}};var aa=function(e){return e=e.replace(/[\d.]+\w+/g,function(e){return p.transUnitToPx(e)})};UE.filterWord=function(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/gi.test(e)?e.replace(/[\t\r\n]+/g,"").replace(/\x3c!--[\s\S]*?--\x3e/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(n.opera)return"";try{var t=e.match(/width:([ \d.]*p[tx])/i)[1],i=e.match(/height:([ \d.]*p[tx])/i)[1],o=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+aa(t)+'" height="'+aa(i)+'" src="'+o+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,n,i){return"class"==t&&"MsoListParagraph"==i?e:""}).replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,t,n,i){e=[],i=i.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g),n=0;for(var o;o=i[n];n++){var a,r=o.split(":");if(2==r.length&&(o=r[0].toLowerCase(),a=r[1].toLowerCase(),!(/^(background)\w*/.test(o)&&0==a.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(o)&&/^0\w+$/.test(a)))){switch(o){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(t)||(e[n]=o.replace(/^mso-|-alt$/g,"")+":"+aa(a));continue;case"horiz-align":e[n]="text-align:"+a;continue;case"vert-align":e[n]="vertical-align:"+a;continue;case"font-color":case"mso-foreground":e[n]="color:"+a;continue;case"mso-background":case"mso-highlight":e[n]="background:"+a;continue;case"mso-default-height":e[n]="min-height:"+aa(a);continue;case"mso-default-width":e[n]="min-width:"+aa(a);continue;case"mso-padding-between-alt":e[n]="border-collapse:separate;border-spacing:"+aa(a);continue;case"text-line-through":"single"!=a&&"double"!=a||(e[n]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==a&&(e[n]="display:none");continue;case"margin":if(!/[1-9]/.test(a))continue}/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(o)||/text\-indent|padding|margin/.test(o)&&/\-[\d.]+/.test(a)||(e[n]=o+":"+r[1])}}return t+(e.length?' style="'+e.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return p.transUnitToPx(e)}):e};var ta=function(e,t,n){return e.push(Nc),t+(n?1:-1)},ua=function(e,t){for(var n=0;n<t;n++)e.push(Oc)},La=function(e,n,i,o){switch(e.type){case"root":for(var a,r=0;a=e.children[r++];)i&&"element"==a.type&&!t.$inlineWithA[a.tagName]&&1<r&&(ta(n,o,!0),ua(n,o)),La(a,n,i,o);break;case"text":n.push("pre"==e.parentNode.tagName?e.data:e.data.replace(/[ ]{2}/g," &nbsp;"));break;case"element":if(a="",e.attrs){a=[];var s=e.attrs;for(r in s)a.push(r+(void 0!==s[r]?'="'+p.unhtml(s[r])+'"':""));a=a.join(" ")}if(n.push("<"+e.tagName+(a?" "+a:"")+(t.$empty[e.tagName]?"/":"")+">"),i&&!t.$inlineWithA[e.tagName]&&"pre"!=e.tagName&&e.children&&e.children.length&&(o=ta(n,o,!0),ua(n,o)),e.children&&e.children.length)for(r=0;a=e.children[r++];)i&&"element"==a.type&&!t.$inlineWithA[a.tagName]&&1<r&&(ta(n,o),ua(n,o)),La(a,n,i,o);t.$empty[e.tagName]||(i&&!t.$inlineWithA[e.tagName]&&"pre"!=e.tagName&&e.children&&e.children.length&&(o=ta(n,o),ua(n,o)),n.push("</"+e.tagName+">"));break;case"comment":n.push("<!--"+e.data+"-->")}return n},Fb=function(e,t){var n;if("element"==e.type&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(var i=0;n=e.children[i++];)if(n=Fb(n,t))return n},Gb=function(e,t,n){if("element"==e.type&&e.tagName==t&&n.push(e),e.children&&e.children.length)for(var i,o=0;i=e.children[o++];)Gb(i,t,n)},Hb=function(e,t){if(e.children&&e.children.length)for(var n,i=0;n=e.children[i];)Hb(n,t),n.parentNode&&(n.children&&n.children.length&&t(n),n.parentNode&&i++);else t(e)},ga=UE.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},Oc="    ",Nc="\n";ga.createElement=function(e){return/[<>]/.test(e)?UE.htmlparser(e).children[0]:new ga({type:"element",children:[],tagName:e})},ga.createText=function(e){return new UE.uNode({type:"text",data:p.unhtml(e||"")})},ga.prototype={toHtml:function(e){var t=[];return La(this,t,e,0),t.join("")},innerHTML:function(e){if("element"!=this.type||t.$empty[this.tagName])return this;if(p.isString(e)){if(this.children)for(var n,i=0;n=this.children[i++];)n.parentNode=null;for(this.children=[],e=UE.htmlparser(e),i=0;n=e.children[i++];)this.children.push(n),n.parentNode=this;return this}return e=new UE.uNode({type:"root",children:this.children}),e.toHtml()},innerText:function(e){if("element"!=this.type||t.$empty[this.tagName])return this;if(e){if(this.children)for(var n,i=0;n=this.children[i++];)n.parentNode=null;return this.children=[],this.appendChild(ga.createText(e)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return 0==n?null:t.children[n-1]},nextSibling:function(){for(var e,t=this.parentNode,n=0;e=t.children[n++];)if(e===this)return t.children[n]},replaceChild:function(e,t){
if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if("root"==this.type||"element"==this.type&&!t.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===e){this.children.splice(i,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n,i=0;n=this.children[i];i++)if(n===t)return this.children.splice(i+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n,i=0;n=this.children[i];i++)if(n===e){if(this.children.splice(i,1),n.parentNode=null,t&&n.children&&n.children.length)for(var o,a=0;o=n.children[a];a++)this.children.splice(i+a,0,o),o.parentNode=this;return n}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(e)if(this.attrs||(this.attrs={}),p.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e];else delete this.attrs},getIndex:function(){for(var e,t=this.parentNode,n=0;e=t.children[n];n++)if(e===this)return n;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n=0;t=this.children[n++];)if(t=Fb(t,e))return t},getNodesByTagName:function(e){e=p.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],n=this;return p.each(e,function(e){if(n.children&&n.children.length)for(var i,o=0;i=n.children[o++];)Gb(i,e,t)}),t},getStyle:function(e){var t=this.getAttr("style");return t&&(e=t.match(RegExp(e+":([^;]+)","i")))&&e[0]?e[1]:""},setStyle:function(e,t){function n(e,t){i=i.replace(RegExp(e+":([^;]+;?)","gi"),""),t&&(i=e+":"+p.unhtml(t)+";"+i)}var i=this.getAttr("style");if(i||(i=""),p.isObject(e))for(var o in e)n(o,e[o]);else n(e,t);this.setAttr("style",i)},traversal:function(e){return this.children&&this.children.length&&Hb(this,e),this}},UE.htmlparser=function(e,n){function i(e,t){if(u[e.tagName]){var n=d.createElement(u[e.tagName]);e.appendChild(n),n.appendChild(d.createText(t))}else e.appendChild(d.createText(t))}function o(e,n,i){var a;if(a=c[n]){for(var s,l=e;"root"!=l.type;){if(p.isArray(a)?-1!=p.indexOf(a,l.tagName):a==l.tagName){e=l,s=!0;break}l=l.parentNode}s||(e=o(e,p.isArray(a)?a[0]:a))}if(a=new d({parentNode:e,type:"element",tagName:n.toLowerCase(),children:t.$empty[n]?null:[]}),i){for(l={};s=r.exec(i);)l[s[1].toLowerCase()]=p.unhtml(s[2]||s[3]||s[4]);a.attrs=l}return e.children.push(a),t.$empty[n]?e:a}var a=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\x3e)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,r=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,s={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(RegExp(f.fillChar,"g"),""),n||(e=e.replace(RegExp("[\\r\\t\\n"+(n?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(n?"":" ")+"]*","g"),function(e,t){return t&&s[t.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(RegExp("^[\\r\\n"+(n?"":" ")+"]+"),"").replace(RegExp("[\\r\\n"+(n?"":" ")+"]+$"),"")}));for(var l,d=UE.uNode,c={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},u={ol:"li",ul:"li"},m=0,h=0,g=new d({type:"root",children:[]}),b=g;l=a.exec(e);){m=l.index;try{if(m>h&&i(b,e.slice(h,m)),l[3])b=o(b,l[3].toLowerCase(),l[4]);else if(l[1]){if("root"!=b.type){for(m=b;"element"==b.type&&b.tagName!=l[1].toLowerCase();)if(b=b.parentNode,"root"==b.type)throw b=m,"break";b=b.parentNode}}else l[2]&&b.children.push(new d({type:"comment",data:l[2],parentNode:b}))}catch(e){}h=a.lastIndex}return h<e.length&&i(b,e.slice(h)),g};var ha=function(e,n){switch(e.type){case"element":var i;if(i=n[e.tagName])if("-"===i)e.parentNode.removeChild(e);else if(p.isFunction(i)){var o=e.parentNode,a=e.getIndex();if(i(e),e.parentNode){if(e.children)for(i=0;a=e.children[i];)ha(a,n),a.parentNode&&i++}else for(i=a;a=o.children[i];)ha(a,n),a.parentNode&&i++}else{if((i=i.$)&&e.attrs){var r,a={};for(o in i){if(r=e.getAttr(o),"style"==o&&p.isArray(i[o])){var s=[];p.each(i[o],function(t){var n;(n=e.getStyle(t))&&s.push(t+":"+n)}),r=s.join(";")}r&&(a[o]=r)}e.attrs=a}if(e.children)for(i=0;a=e.children[i];)ha(a,n),a.parentNode&&i++}else if(t.$cdata[e.tagName])e.parentNode.removeChild(e);else for(o=e.parentNode,a=e.getIndex(),e.parentNode.removeChild(e,!0),i=a;a=o.children[i];)ha(a,n),a.parentNode&&i++;break;case"comment":e.parentNode.removeChild(e)}};UE.filterNode=function(e,t){if(p.isEmptyObject(t))return e;var n;(n=t["-"])&&p.each(n.split(" "),function(e){t[e]="-"}),n=0;for(var i;i=e.children[n];)ha(i,t),i.parentNode&&n++;return e},UE.plugins.defaultfilter=function(){var e=this;e.addInputRule(function(i){var o;i.traversal(function(i){if("element"==i.type){if(!t.$cdata[i.tagName]&&e.options.autoClearEmptyNode&&t.$inline[i.tagName]&&!t.$empty[i.tagName]&&(!i.attrs||p.isEmptyObject(i.attrs)))return void(i.firstChild()?"span"==i.tagName&&(!i.attrs||p.isEmptyObject(i.attrs))&&i.parentNode.removeChild(i,!0):i.parentNode.removeChild(i));switch(i.tagName){case"style":case"script":i.setAttr({cdata_tag:i.tagName,cdata_data:encodeURIComponent(i.innerText()||"")}),i.tagName="div",i.removeChild(i.firstChild());break;case"a":(o=i.getAttr("href"))&&i.setAttr("_href",o);break;case"img":if((o=i.getAttr("src"))&&/^data:/.test(o)){i.parentNode.removeChild(i);break}i.setAttr("_src",i.getAttr("src"));break;case"span":n.webkit&&(o=i.getStyle("white-space"))&&/nowrap|normal/.test(o)&&(i.setStyle("white-space",""),e.options.autoClearEmptyNode&&p.isEmptyObject(i.attrs)&&i.parentNode.removeChild(i,!0));break;case"p":(o=i.getAttr("align"))&&(i.setAttr("align"),i.setStyle("text-align",o));var a=i.getAttr("style");a&&(a=a.replace(/(margin|padding)[^;]+/g,""),i.setAttr("style",a)),i.firstChild()||i.innerHTML(UE.browser.ie?"&nbsp;":"<br>");break;case"div":if(i.getAttr("cdata_tag"))break;if((o=i.getAttr("class"))&&/^line number\d+/.test(o))break;for(var r=UE.uNode.createElement("p");a=i.firstChild();)"text"!=a.type&&UE.dom.dtd.$block[a.tagName]?r.firstChild()?(i.parentNode.insertBefore(r,i),r=UE.uNode.createElement("p")):i.parentNode.insertBefore(a,i):r.appendChild(a);r.firstChild()&&i.parentNode.insertBefore(r,i),i.parentNode.removeChild(i);break;case"dl":i.tagName="ul";break;case"dt":case"dd":i.tagName="li";break;case"li":a=i.getAttr("class"),(!a||!/list\-/.test(a))&&i.setAttr(),a=i.getNodesByTagName("ol ul"),UE.utils.each(a,function(e){i.parentNode.insertAfter(e,i)});break;case"td":case"th":case"caption":i.children&&i.children.length||i.appendChild(n.ie?UE.uNode.createText(" "):UE.uNode.createElement("br"))}}"comment"==i.type&&i.parentNode.removeChild(i)})}),e.addOutputRule(function(n){var i;n.traversal(function(n){if("element"==n.type)if(!e.options.autoClearEmptyNode||!t.$inline[n.tagName]||t.$empty[n.tagName]||n.attrs&&!p.isEmptyObject(n.attrs))switch(n.tagName){case"div":(i=n.getAttr("cdata_tag"))&&(n.tagName=i,n.appendChild(UE.uNode.createText(n.getAttr("cdata_data"))),n.setAttr({cdata_tag:"",cdata_data:""}));break;case"a":(i=n.getAttr("_href"))&&n.setAttr({href:i,_href:""});break;case"img":(i=n.getAttr("_src"))&&n.setAttr({src:n.getAttr("_src"),_src:""})}else n.firstChild()?"span"==n.tagName&&(!n.attrs||p.isEmptyObject(n.attrs))&&n.parentNode.removeChild(n,!0):n.parentNode.removeChild(n)})})},UE.commands.inserthtml={execCommand:function(e,i,o){var a,r=this;if(i&&!0!==r.fireEvent("beforeinserthtml",i)){if(a=r.selection.getRange(),e=a.document.createElement("div"),e.style.display="inline",o||(i=UE.htmlparser(i),r.options.filterRules&&UE.filterNode(i,r.options.filterRules),r.filterInputRule(i),i=i.toHtml()),e.innerHTML=p.trim(i),!a.collapsed&&(i=a.startContainer,f.isFillChar(i)&&a.setStartBefore(i),i=a.endContainer,f.isFillChar(i)&&a.setEndAfter(i),a.txtToElmBoundary(),a.endContainer&&1==a.endContainer.nodeType&&(i=a.endContainer.childNodes[a.endOffset])&&f.isBr(i)&&a.setEndAfter(i),0==a.startOffset&&(i=a.startContainer,f.isBoundaryNode(i,"firstChild")&&(i=a.endContainer,a.endOffset==(3==i.nodeType?i.nodeValue.length:i.childNodes.length)&&f.isBoundaryNode(i,"lastChild")))&&(r.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>",a.setStart(r.body.firstChild,0).collapse(!0)),!a.collapsed&&a.deleteContents(),1==a.startContainer.nodeType)){i=a.startContainer.childNodes[a.startOffset];var s;if(i&&f.isBlockElm(i)&&(s=i.previousSibling)&&f.isBlockElm(s)){for(a.setEnd(s,s.childNodes.length).collapse();i.firstChild;)s.appendChild(i.firstChild);f.remove(i)}}var l,d;o=0;var c;a.inFillChar()&&(i=a.startContainer,f.isFillChar(i)?(a.setStartBefore(i).collapse(!0),f.remove(i)):f.isFillChar(i,!0)&&(i.nodeValue=i.nodeValue.replace(fa,""),a.startOffset--,a.collapsed&&a.collapse(!0)));var u=f.findParentByTagName(a.startContainer,"li",!0);if(u){for(var m;i=e.firstChild;){for(;i&&(3==i.nodeType||!f.isBlockElm(i)||"HR"==i.tagName);)m=i.nextSibling,a.insertNode(i).collapse(),l=i,i=m;if(i)if(/^(ol|ul)$/i.test(i.tagName)){for(;i.firstChild;)l=i.firstChild,f.insertAfter(u,i.firstChild),u=u.nextSibling;f.remove(i)}else m=i.nextSibling,s=r.document.createElement("li"),f.insertAfter(u,s),s.appendChild(i),l=i,i=m,u=s}u=f.findParentByTagName(a.startContainer,"li",!0),f.isEmptyBlock(u)&&f.remove(u),l&&a.setStartAfter(l).collapse(!0).select(!0)}else{for(;i=e.firstChild;){if(o){for(l=r.document.createElement("p");i&&(3==i.nodeType||!t.$block[i.tagName]);)c=i.nextSibling,l.appendChild(i),i=c;l.firstChild&&(i=l)}if(a.insertNode(i),c=i.nextSibling,!o&&i.nodeType==f.NODE_ELEMENT&&f.isBlockElm(i)&&(l=f.findParent(i,function(e){return f.isBlockElm(e)}))&&"body"!=l.tagName.toLowerCase()&&(!t[l.tagName][i.nodeName]||i.parentNode!==l)){if(t[l.tagName][i.nodeName])for(d=i.parentNode;d!==l;)s=d,d=d.parentNode;else s=l;f.breakParent(i,s||d),s=i.previousSibling,f.trimWhiteTextNode(s),s.childNodes.length||f.remove(s),!n.ie&&(m=i.nextSibling)&&f.isBlockElm(m)&&m.lastChild&&!f.isBr(m.lastChild)&&m.appendChild(r.document.createElement("br")),o=1}if(m=i.nextSibling,!e.firstChild&&m&&f.isBlockElm(m)){a.setStart(m,0).collapse(!0);break}a.setEndAfter(i).collapse()}if(i=a.startContainer,c&&f.isBr(c)&&f.remove(c),f.isBlockElm(i)&&f.isEmptyNode(i))if(c=i.nextSibling)f.remove(i),1==c.nodeType&&t.$block[c.tagName]&&a.setStart(c,0).collapse(!0).shrinkBoundary();else try{i.innerHTML=n.ie?f.fillChar:"<br/>"}catch(e){a.setStartBefore(i),f.remove(i)}try{a.select(!0)}catch(e){}}setTimeout(function(){a=r.selection.getRange(),a.scrollToView(r.autoHeightEnabled,r.autoHeightEnabled?f.getXY(r.iframe).y:0),r.fireEvent("afterinserthtml")},200)}}},UE.plugins.autotypeset=function(){function e(e,t){return e&&3!=e.nodeType?f.isBr(e)?1:e&&e.parentNode&&d[e.tagName.toLowerCase()]?o&&o.contains(e)||e.getAttribute("pagebreak")?0:t?!f.isEmptyBlock(e):f.isEmptyBlock(e,RegExp("[\\s"+f.fillChar+"]","g")):void 0:0}function n(e){e.style.cssText||(f.removeAttributes(e,["style"]),"span"==e.tagName.toLowerCase()&&f.hasNoAttributes(e)&&f.remove(e,!0))}function i(i,a){var d;if(a){if(!r.pasteFilter)return;d=this.document.createElement("div"),d.innerHTML=a.html}else d=this.document.body;for(var c,u=f.getElementsByTagName(d,"*"),m=0;c=u[m++];)if(!0!==this.fireEvent("excludeNodeinautotype",c)){if(r.clearFontSize&&c.style.fontSize&&(f.removeStyle(c,"font-size"),n(c)),r.clearFontFamily&&c.style.fontFamily&&(f.removeStyle(c,"font-family"),n(c)),e(c)){if(r.mergeEmptyline)for(var h,p=c.nextSibling,g=f.isBr(c);e(p)&&(h=p,p=h.nextSibling,!g||p&&(!p||f.isBr(p)));)f.remove(h);if(r.removeEmptyline&&f.inDoc(c,d)&&!l[c.parentNode.tagName.toLowerCase()]){if(f.isBr(c)&&(p=c.nextSibling)&&!f.isBr(p))continue;f.remove(c);continue}}if(e(c,!0)&&"SPAN"!=c.tagName&&(r.indent&&(c.style.textIndent=r.indentValue),r.textAlign&&(c.style.textAlign=r.textAlign)),r.removeClass&&c.className&&!s[c.className.toLowerCase()]){if(o&&o.contains(c))continue;f.removeAttributes(c,["class"])}if(r.imageBlockLine&&"img"==c.tagName.toLowerCase()&&!c.getAttribute("emotion"))if(a)switch(g=c,r.imageBlockLine){case"left":case"right":case"none":for(var b,p=g.parentNode;t.$inline[p.tagName]||"A"==p.tagName;)p=p.parentNode;if(h=p,"P"==h.tagName&&"center"==f.getStyle(h,"text-align")&&!f.isBody(h)&&1==f.getChildCount(h,function(e){return!f.isBr(e)&&!f.isWhitespace(e)}))if(b=h.previousSibling,p=h.nextSibling,b&&p&&1==b.nodeType&&1==p.nodeType&&b.tagName==p.tagName&&f.isBlockElm(b)){for(b.appendChild(h.firstChild);p.firstChild;)b.appendChild(p.firstChild);f.remove(h),f.remove(p)}else f.setStyle(h,"text-align","");f.setStyle(g,"float",r.imageBlockLine);break;case"center":if("center"!=this.queryCommandValue("imagefloat")){for(p=g.parentNode,f.setStyle(g,"float","none"),h=g;p&&1==f.getChildCount(p,function(e){return!f.isBr(e)&&!f.isWhitespace(e)})&&(t.$inline[p.tagName]||"A"==p.tagName);)h=p,p=p.parentNode;p=this.document.createElement("p"),f.setAttributes(p,{style:"text-align:center"}),h.parentNode.insertBefore(p,h),p.appendChild(h),f.setStyle(h,"float","")}}else this.selection.getRange().selectNode(c).select(),this.execCommand("imagefloat",r.imageBlockLine);r.removeEmptyNode&&r.removeTagNames[c.tagName.toLowerCase()]&&f.hasNoAttributes(c)&&f.isEmptyBlock(c)&&f.remove(c)}a&&(a.html=d.innerHTML)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:p.extend({div:1},t.$removeEmpty),indent:!1,indentValue:"2em"}});var o,a=this,r=a.options.autotypeset,s={selectTdClass:1,pagebreak:1,anchorclass:1},l={li:1},d={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1};r&&(r.pasteFilter&&a.addListener("beforepaste",i),a.commands.autotypeset={execCommand:function(){a.removeListener("beforepaste",i),r.pasteFilter&&a.addListener("beforepaste",i),i.call(a)}})},UE.plugins.autosubmit=function(){this.commands.autosubmit={execCommand:function(){var e=f.findParentByTagName(this.iframe,"form",!1);e&&!1!==this.fireEvent("beforesubmit")&&(this.sync(),e.submit())}},this.addshortcutkey({autosubmit:"ctrl+13"})},UE.plugins.background=function(){var e=this;e.addListener("getAllHtml",function(t,i){var o,a=this.body,r=f.getComputedStyle(a,"background-image"),s="",s=0<r.indexOf(e.options.imagePath)?r.substring(r.indexOf(e.options.imagePath),r.length-1).replace(/"|\(|\)/gi,""):"none"!=r?r.replace(/url\("?|"?\)/gi,""):"",r='<style type="text/css">body{',a={"background-color":f.getComputedStyle(a,"background-color")||"#ffffff","background-image":s?"url("+s+")":"","background-repeat":f.getComputedStyle(a,"background-repeat")||"","background-position":n.ie?f.getComputedStyle(a,"background-position-x")+" "+f.getComputedStyle(a,"background-position-y"):f.getComputedStyle(a,"background-position"),height:f.getComputedStyle(a,"height")};for(o in a)a.hasOwnProperty(o)&&(r+=o+":"+a[o]+";");i.push(r+"}</style> ")})},UE.commands.imagefloat={execCommand:function(e,n){var i=this.selection.getRange();if(!i.collapsed){var o=i.getClosedNode();if(o&&"IMG"==o.tagName)switch(n){case"left":case"right":case"none":for(var a,r,s=o.parentNode;t.$inline[s.tagName]||"A"==s.tagName;)s=s.parentNode;if(a=s,"P"==a.tagName&&"center"==f.getStyle(a,"text-align")){if(!f.isBody(a)&&1==f.getChildCount(a,function(e){return!f.isBr(e)&&!f.isWhitespace(e)}))if(s=a.previousSibling,r=a.nextSibling,s&&r&&1==s.nodeType&&1==r.nodeType&&s.tagName==r.tagName&&f.isBlockElm(s)){for(s.appendChild(a.firstChild);r.firstChild;)s.appendChild(r.firstChild);f.remove(a),f.remove(r)}else f.setStyle(a,"text-align","");i.selectNode(o).select()}f.setStyle(o,"float","none"==n?"":n),"none"==n&&f.removeAttributes(o,"align");break;case"center":if("center"!=this.queryCommandValue("imagefloat")){for(s=o.parentNode,f.setStyle(o,"float",""),f.removeAttributes(o,"align"),a=o;s&&1==f.getChildCount(s,function(e){return!f.isBr(e)&&!f.isWhitespace(e)})&&(t.$inline[s.tagName]||"A"==s.tagName);)a=s,s=s.parentNode;i.setStartBefore(a).setCursor(!1),s=this.document.createElement("div"),s.appendChild(a),f.setStyle(a,"float",""),this.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+s.innerHTML+"</p>"),a=this.document.getElementById("_img_parent_tmp"),a.removeAttribute("id"),a=a.firstChild,i.selectNode(a).select(),(r=a.parentNode.nextSibling)&&f.isEmptyNode(r)&&f.remove(r)}}}},queryCommandValue:function(){var e,t=this.selection.getRange();return t.collapsed?"none":(t=t.getClosedNode())&&1==t.nodeType&&"IMG"==t.tagName?(e=t.getAttribute("align")||f.getComputedStyle(t,"float"),"none"==e&&(e="center"==f.getComputedStyle(t.parentNode,"text-align")?"center":e),{left:1,right:1,center:1}[e]?e:"none"):"none"},queryCommandState:function(){var e=this.selection.getRange();return e.collapsed?-1:(e=e.getClosedNode())&&1==e.nodeType&&"IMG"==e.tagName?0:-1}},UE.commands.insertimage={execCommand:function(e,t){if(t=p.isArray(t)?t:[t],t.length){var n=this.selection.getRange(),i=n.getClosedNode();if(i&&/img/i.test(i.tagName)&&"edui-faked-video"!=i.className&&!i.getAttribute("word_img")){var o=t.shift(),a=o.floatStyle;delete o.floatStyle,f.setAttributes(i,o),this.execCommand("imagefloat",a),0<t.length&&(n.setStartAfter(i).setCursor(!1,!0),this.execCommand("insertimage",t))}else{if(n=[],i="",o=t[0],1==t.length)i='<img src="'+o.src+'" '+(o._src?' _src="'+o._src+'" ':"")+(o.width?'width="'+o.width+'" ':"")+(o.height?' height="'+o.height+'" ':"")+("left"==o.floatStyle||"right"==o.floatStyle?' style="float:'+o.floatStyle+';"':"")+(o.title&&""!=o.title?' title="'+o.title+'"':"")+(o.border&&"0"!=o.border?' border="'+o.border+'"':"")+(o.alt&&""!=o.alt?' alt="'+o.alt+'"':"")+(o.hspace&&"0"!=o.hspace?' hspace = "'+o.hspace+'"':"")+(o.vspace&&"0"!=o.vspace?' vspace = "'+o.vspace+'"':"")+"/>","center"==o.floatStyle&&(i='<p style="text-align: center">'+i+"</p>"),n.push(i);else for(a=0;o=t[a++];)i="<p "+("center"==o.floatStyle?'style="text-align: center" ':"")+'><img src="'+o.src+'" '+(o.width?'width="'+o.width+'" ':"")+(o._src?' _src="'+o._src+'" ':"")+(o.height?' height="'+o.height+'" ':"")+' style="'+(o.floatStyle&&"center"!=o.floatStyle?"float:"+o.floatStyle+";":"")+(o.border||"")+'" '+(o.title?' title="'+o.title+'"':"")+" /></p>",n.push(i);this.execCommand("insertHtml",n.join(""))}}}},UE.plugins.justify=function(){var e=f.isBlockElm,t={left:1,right:1,center:1,justify:1};UE.commands.justify={execCommand:function(t,n){var i,o=this.selection.getRange();o.collapsed&&(i=this.document.createTextNode("p"),o.insertNode(i));var a=o.createBookmark(),r=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!f.isBookmarkNode(e):!f.isWhitespace(e)};o.enlarge(!0);for(var s,l=o.createBookmark(),d=f.getNextDomNode(l.start,!1,r),c=o.cloneRange();d&&!(f.getPosition(d,l.end)&f.POSITION_FOLLOWING);)if(3!=d.nodeType&&e(d))d=f.getNextDomNode(d,!0,r);else{for(c.setStartBefore(d);d&&d!==l.end&&!e(d);)s=d,d=f.getNextDomNode(d,!1,null,function(t){return!e(t)});if(c.setEndAfter(s),d=c.getCommonAncestor(),!f.isBody(d)&&e(d))f.setStyles(d,p.isString(n)?{"text-align":n}:n);else{d=o.document.createElement("p"),f.setStyles(d,p.isString(n)?{"text-align":n}:n);var u=c.extractContents();d.appendChild(u),c.insertNode(d)}d=f.getNextDomNode(d,!1,r)}return o.moveToBookmark(l).moveToBookmark(a),i&&(o.setStartBefore(i).collapse(!0),f.remove(i)),o.select(),!0},queryCommandValue:function(){var e=this.selection.getStart(),e=f.getComputedStyle(e,"text-align");return t[e]?e:"left"},queryCommandState:function(){var e=this.selection.getStart();return e&&f.findParentByTagName(e,["td","th","caption"],!0)?-1:0}}},UE.plugins.font=function(){function e(e){var n=e.collapsed,i=e.createBookmark();if(n)for(n=i.start.parentNode;t.$inline[n.tagName];)n=n.parentNode;else n=f.getCommonAncestor(i.start,i.end);p.each(f.getElementsByTagName(n,"span"),function(e){if(e.parentNode&&!f.isBookmarkNode(e))if(/^\s*border\s*:\s*none;\s*/i.test(e.style.cssText))f.remove(e,!0);else{/border/i.test(e.style.cssText)&&"SPAN"==e.parentNode.tagName&&/border/i.test(e.parentNode.style.cssText)&&(e.style.cssText=e.style.cssText.replace(/border[^:]*:[^;]+;?/gi,""));for(var t=e.nextSibling;t&&1==t.nodeType&&"SPAN"==t.tagName&&(f.isBookmarkNode(t)?e.appendChild(t):t.style.cssText==e.style.cssText&&(f.moveChild(t,e),f.remove(t)),e.nextSibling!==t);)t=e.nextSibling}}),e.moveToBookmark(i)}var i={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},o={underline:1,strikethrough:1,fontborder:1};this.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),this.addInputRule(function(e){p.each(e.getNodesByTagName("u s del font"),function(e){if("font"==e.tagName){var t,n=[];for(t in e.attrs)switch(t){case"size":n.push("font-size:"+e.attrs[t]+"px");break;case"color":n.push("color:"+e.attrs[t]);break;case"face":n.push("font-family:"+e.attrs[t]);break;case"style":n.push(e.attrs[t])}e.attrs={style:n.join(";")}}else n="u"==e.tagName?"underline":"line-through",e.attrs={style:(e.getAttr("style")||"")+"text-decoration:"+n+";"};e.tagName="span"})});for(var a in i)(function(i,a){UE.commands[i]={execCommand:function(t,r){r=r||(this.queryCommandState(t)?"none":"underline"==t?"underline":"fontborder"==t?"1px solid #000":"line-through");var s,l=this,d=this.selection.getRange();if("default"==r)d.collapsed&&(s=l.document.createTextNode("font"),d.insertNode(s).select()),l.execCommand("removeFormat","span,a",a),s&&(d.setStartBefore(s).setCursor(),f.remove(s));else if(d.collapsed){var c=f.findParentByTagName(d.startContainer,"span",!0);if(s=l.document.createTextNode("font"),!c||c.children.length||c[n.ie?"innerText":"textContent"].replace(fa,"").length){if(d.insertNode(s),d.selectNode(s).select(),c=d.document.createElement("span"),o[i]){if(f.findParentByTagName(s,"a",!0))return d.setStartBefore(s).setCursor(),void f.remove(s);l.execCommand("removeFormat","span,a",a)}if(c.style.cssText=a+":"+r,s.parentNode.insertBefore(c,s),!n.ie||n.ie&&9==n.version)for(var u=c.parentNode;!f.isBlockElm(u);)"SPAN"==u.tagName&&(c.style.cssText=u.style.cssText+";"+c.style.cssText),u=u.parentNode;Cc?setTimeout(function(){d.setStart(c,0).collapse(!0),e(d,l),d.select()}):(d.setStart(c,0).collapse(!0),e(d,l),d.select())}else d.insertNode(s),o[i]&&(d.selectNode(s).select(),l.execCommand("removeFormat","span,a",a,null),c=f.findParentByTagName(s,"span",!0),d.setStartBefore(s)),c&&(c.style.cssText+=";"+a+":"+r),d.collapse(!0).select();f.remove(s)}else o[i]&&l.queryCommandValue(i)&&l.execCommand("removeFormat","span,a",a),d=l.selection.getRange(),d.applyInlineStyle("span",{style:a+":"+r}),e(d,l),d.select();return!0},queryCommandValue:function(e){var n=this.selection.getStart();if("underline"==e||"strikethrough"==e){for(var i=n;i&&!f.isBlockElm(i)&&!f.isBody(i);){if(1==i.nodeType&&(e=f.getComputedStyle(i,a),"none"!=e))return e;i=i.parentNode}return"none"}if("fontborder"==e){for(e=n;e&&t.$inline[e.tagName];){if((i=f.getComputedStyle(e,"border"))&&/1px/.test(i)&&/solid/.test(i))return i;e=e.parentNode}return""}return f.getComputedStyle(n,a)},queryCommandState:function(e){if(!o[e])return 0;var t=this.queryCommandValue(e);return"fontborder"==e?/1px/.test(t)&&/solid/.test(t):t==("underline"==e?"underline":"line-through")}}})(a,i[a])},UE.plugins.link=function(){function e(e){var t=e.startContainer,n=e.endContainer;(t=f.findParentByTagName(t,"a",!0))&&e.setStartBefore(t),(n=f.findParentByTagName(n,"a",!0))&&e.setEndAfter(n)}UE.commands.unlink={execCommand:function(){var t,n=this.selection.getRange();n.collapsed&&!f.findParentByTagName(n.startContainer,"a",!0)||(t=n.createBookmark(),e(n),n.removeInlineStyle("a").moveToBookmark(t).select())},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={execCommand:function(t,i){var o;i._href&&(i._href=p.unhtml(i._href,/[<">]/g)),i.href&&(i.href=p.unhtml(i.href,/[<">]/g)),i.textValue&&(i.textValue=p.unhtml(i.textValue,/[<">]/g));var a=o=this.selection.getRange(),r=a.cloneRange(),s=this.queryCommandValue("link");e(a=a.adjustmentBoundary());var l=a.startContainer;if(1==l.nodeType&&s&&(l=l.childNodes[a.startOffset])&&1==l.nodeType&&"A"==l.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(l[n.ie?"innerText":"textContent"])&&(l[n.ie?"innerText":"textContent"]=p.html(i.textValue||i.href)),r.collapsed&&!s||(a.removeInlineStyle("a"),r=a.cloneRange()),r.collapsed){var s=a.document.createElement("a"),d="";i.textValue?(d=p.html(i.textValue),delete i.textValue):d=p.html(i.href),f.setAttributes(s,i),(l=f.findParentByTagName(r.startContainer,"a",!0))&&f.isInNodeEndBoundary(r,l)&&a.setStartAfter(l).collapse(!0),s[n.ie?"innerText":"textContent"]=d,a.insertNode(s).selectNode(s)}else a.applyInlineStyle("a",i);o.collapse().select(!0)},queryCommandValue:function(){var e,t=this.selection.getRange();if(!t.collapsed){t.shrinkBoundary();var n=3!=t.startContainer.nodeType&&t.startContainer.childNodes[t.startOffset]?t.startContainer.childNodes[t.startOffset]:t.startContainer,i=3==t.endContainer.nodeType||0==t.endOffset?t.endContainer:t.endContainer.childNodes[t.endOffset-1],t=t.getCommonAncestor();if(e=f.findParentByTagName(t,"a",!0),!e&&1==t.nodeType)for(var o,a,r,t=t.getElementsByTagName("a"),s=0;r=t[s++];)if(o=f.getPosition(r,n),a=f.getPosition(r,i),(o&f.POSITION_FOLLOWING||o&f.POSITION_CONTAINS)&&(a&f.POSITION_PRECEDING||a&f.POSITION_CONTAINS)){e=r;break}return e}if(e=t.startContainer,(e=1==e.nodeType?e:e.parentNode)&&(e=f.findParentByTagName(e,"a",!0))&&!f.isInNodeEndBoundary(t,e))return e},queryCommandState:function(){var e=this.selection.getRange().getClosedNode();return e&&"edui-faked-video"==e.className?-1:0}}},UE.plugins.insertframe=function(){var e=this;e.addListener("selectionchange",function(){e._iframe&&delete e._iframe})},UE.commands.scrawl={queryCommandState:function(){return n.ie&&8>=n.version?-1:0}},UE.plugins.removeformat=function(){this.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),this.commands.removeformat={execCommand:function(e,i,o,a,r){function s(e){if(3==e.nodeType||"span"!=e.tagName.toLowerCase())return 0;if(n.ie){var t=e.attributes;if(t.length){e=0;for(var i=t.length;e<i;e++)if(t[e].specified)return 0;return 1}}return!e.attributes.length}i=RegExp("^(?:"+(i||this.options.removeFormatTags).replace(/,/g,"|")+")$","i");var l=o?[]:(a||this.options.removeFormatAttributes).split(",");a=new R.Range(this.document);var d,c=function(e){return 1==e.nodeType};e=a=this.selection.getRange();var u=e.createBookmark();for(e.collapsed&&e.enlarge(!0),r||((r=f.findParentByTagName(e.startContainer,"a",!0))&&e.setStartBefore(r),(r=f.findParentByTagName(e.endContainer,"a",!0))&&e.setEndAfter(r)),r=e.createBookmark(),m=r.start;(d=m.parentNode)&&!f.isBlockElm(d);)f.breakParent(m,d),f.clearEmptySibling(m);if(r.end){for(m=r.end;(d=m.parentNode)&&!f.isBlockElm(d);)f.breakParent(m,d),f.clearEmptySibling(m);for(d=f.getNextDomNode(r.start,!1,c);d&&d!=r.end;)m=f.getNextDomNode(d,!0,c),!t.$empty[d.tagName.toLowerCase()]&&!f.isBookmarkNode(d)&&(i.test(d.tagName)?o?(f.removeStyle(d,o),s(d)&&"text-decoration"!=o&&f.remove(d,!0)):f.remove(d,!0):!t.$tableContent[d.tagName]&&!t.$list[d.tagName]&&(f.removeAttributes(d,l),s(d)&&f.remove(d,!0))),d=m}o=r.start.parentNode,f.isBlockElm(o)&&!t.$tableContent[o.tagName]&&!t.$list[o.tagName]&&f.removeAttributes(o,l),o=r.end.parentNode,r.end&&f.isBlockElm(o)&&!t.$tableContent[o.tagName]&&!t.$list[o.tagName]&&f.removeAttributes(o,l),e.moveToBookmark(r).moveToBookmark(u);var m=e.startContainer;for(i=e.collapsed;1==m.nodeType&&f.isEmptyNode(m)&&t.$removeEmpty[m.tagName];)o=m.parentNode,e.setStartBefore(m),e.startContainer===e.endContainer&&e.endOffset--,f.remove(m),m=o;if(!i)for(m=e.endContainer;1==m.nodeType&&f.isEmptyNode(m)&&t.$removeEmpty[m.tagName];)o=m.parentNode,e.setEndBefore(m),f.remove(m),m=o;a.select()}}},UE.plugins.blockquote=function(){this.commands.blockquote={execCommand:function(e,n){var i=this.selection.getRange(),o=f.filterNodeList(this.selection.getStartElementPath(),"blockquote"),a=t.blockquote,r=i.createBookmark();if(o){var a=i.startContainer,a=f.isBlockElm(a)?a:f.findParent(a,function(e){return f.isBlockElm(e)}),s=i.endContainer,s=f.isBlockElm(s)?s:f.findParent(s,function(e){return f.isBlockElm(e)}),a=f.findParentByTagName(a,"li",!0)||a,s=f.findParentByTagName(s,"li",!0)||s;"LI"==a.tagName||"TD"==a.tagName||a===o||f.isBody(a)?f.remove(o,!0):f.breakParent(a,o),a!==s&&(o=f.findParentByTagName(s,"blockquote"))&&("LI"==s.tagName||"TD"==s.tagName||f.isBody(s)?o.parentNode&&f.remove(o,!0):f.breakParent(s,o));for(var l,d=f.getElementsByTagName(this.document,"blockquote"),o=0;l=d[o++];)l.childNodes.length?f.getPosition(l,a)&f.POSITION_FOLLOWING&&f.getPosition(l,s)&f.POSITION_PRECEDING&&f.remove(l,!0):f.remove(l)}else{for(o=i.cloneRange(),d=s=1==o.startContainer.nodeType?o.startContainer:o.startContainer.parentNode,l=1;;){if(f.isBody(s)){d!==s?i.collapsed?(o.selectNode(d),l=0):o.setStartBefore(d):o.setStart(s,0);break}if(!a[s.tagName]){i.collapsed?o.selectNode(d):o.setStartBefore(d);break}d=s,s=s.parentNode}if(l)for(d=s=s=1==o.endContainer.nodeType?o.endContainer:o.endContainer.parentNode;;){if(f.isBody(s)){d!==s?o.setEndAfter(d):o.setEnd(s,s.childNodes.length);break}if(!a[s.tagName]){o.setEndAfter(d);break}d=s,s=s.parentNode}for(s=i.document.createElement("blockquote"),f.setAttributes(s,n),s.appendChild(o.extractContents()),o.insertNode(s),a=f.getElementsByTagName(s,"blockquote"),o=0;s=a[o++];)s.parentNode&&f.remove(s,!0)}i.moveToBookmark(r).select()},queryCommandState:function(){return f.filterNodeList(this.selection.getStartElementPath(),"blockquote")?1:0}}},UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(e){var t=this.selection.getRange();if(t.collapsed)return t;for(var n=t.createBookmark(),i=n.end,o=function(e){return!f.isBr(e)&&!f.isWhitespace(e)},a=f.getNextDomNode(n.start,!1,o);a&&f.getPosition(a,i)&f.POSITION_PRECEDING&&(3==a.nodeType&&(a.nodeValue=a.nodeValue["touppercase"==e?"toUpperCase":"toLowerCase"]()),a=f.getNextDomNode(a,!0,o),!(a===i)););t.moveToBookmark(n).select()}},UE.commands.indent={execCommand:function(){var e=this.queryCommandState("indent")?"0em":this.options.indentValue||"2em";this.execCommand("Paragraph","p",{style:"text-indent:"+e})},queryCommandState:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}},UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands.preview={execCommand:function(){var e=window.open("","_blank","").document;e.open(),e.write('<html><head><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"></script><script>setTimeout(function(){uParse('div',{    'highlightJsUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js',    'highlightCssUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css'})},300)</script></head><body><div>"+this.getContent(null,null,!0)+"</div></body></html>"),
e.close()},notNeedUndo:1},UE.plugins.selectall=function(){this.commands.selectall={execCommand:function(){var e=this.body,t=this.selection.getRange();t.selectNodeContents(e),f.isEmptyBlock(e)&&(n.opera&&e.firstChild&&1==e.firstChild.nodeType&&t.setStartAtFirst(e.firstChild),t.collapse(!0)),t.select(!0)},notNeedUndo:1},this.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins.paragraph=function(){var e=f.isBlockElm,t=["TD","LI","PRE"];this.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),this.commands.paragraph={execCommand:function(i,o,a,r){if(i=this.selection.getRange(),i.collapsed){var s=this.document.createTextNode("p");if(i.insertNode(s),n.ie){var l=s.previousSibling;l&&f.isWhitespace(l)&&f.remove(l),(l=s.nextSibling)&&f.isWhitespace(l)&&f.remove(l)}}var d,l=i.createBookmark(),c=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!f.isBookmarkNode(e):!f.isWhitespace(e)};i.enlarge(!0);var u=i.createBookmark();d=f.getNextDomNode(u.start,!1,c);for(var m,h=i.cloneRange();d&&!(f.getPosition(d,u.end)&f.POSITION_FOLLOWING);)if(3!=d.nodeType&&e(d))d=f.getNextDomNode(d,!0,c);else{for(h.setStartBefore(d);d&&d!==u.end&&!e(d);)m=d,d=f.getNextDomNode(d,!1,null,function(t){return!e(t)});h.setEndAfter(m),d=i.document.createElement(o),a&&(f.setAttributes(d,a),r&&"customstyle"==r&&a.style&&(d.style.cssText=a.style)),d.appendChild(h.extractContents()),f.isEmptyNode(d)&&f.fillChar(i.document,d),h.insertNode(d);var g=d.parentNode;e(g)&&!f.isBody(d.parentNode)&&-1==p.indexOf(t,g.tagName)&&(r&&"customstyle"==r||(g.getAttribute("dir")&&d.setAttribute("dir",g.getAttribute("dir")),g.style.cssText&&(d.style.cssText=g.style.cssText+";"+d.style.cssText),g.style.textAlign&&!d.style.textAlign&&(d.style.textAlign=g.style.textAlign),g.style.textIndent&&!d.style.textIndent&&(d.style.textIndent=g.style.textIndent),g.style.padding&&!d.style.padding&&(d.style.padding=g.style.padding)),a&&/h\d/i.test(g.tagName)&&!/h\d/i.test(d.tagName)?(f.setAttributes(g,a),r&&"customstyle"==r&&a.style&&(g.style.cssText=a.style),f.remove(d,!0),d=g):f.remove(d.parentNode,!0)),d=-1!=p.indexOf(t,g.tagName)?g:d,d=f.getNextDomNode(d,!1,c)}return i=i.moveToBookmark(u).moveToBookmark(l),s&&(i.setStartBefore(s).collapse(!0),pN=s.parentNode,f.remove(s),f.isBlockElm(pN)&&f.isEmptyNode(pN)&&f.fillNode(this.document,pN)),n.gecko&&i.collapsed&&1==i.startContainer.nodeType&&(a=i.startContainer.childNodes[i.startOffset])&&1==a.nodeType&&a.tagName.toLowerCase()==o&&i.setStart(a,0).collapse(!0),i.select(),!0},queryCommandValue:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""}}};var va=f.isBlockElm,Jb=function(e){return f.filterNodeList(e.selection.getStartElementPath(),function(e){return e.getAttribute("dir")})};UE.commands.directionality={execCommand:function(e,t){var n=this.selection.getRange();if(n.collapsed){var i=this.document.createTextNode("d");n.insertNode(i)}var o,a=function(e){return 1==e.nodeType?!f.isBookmarkNode(e):!f.isWhitespace(e)};if((o=Jb(this))&&n.collapsed)o.setAttribute("dir",t);else{o=n.createBookmark(),n.enlarge(!0);for(var r,s=n.createBookmark(),l=f.getNextDomNode(s.start,!1,a),d=n.cloneRange();l&&!(f.getPosition(l,s.end)&f.POSITION_FOLLOWING);)if(3!=l.nodeType&&va(l))l=f.getNextDomNode(l,!0,a);else{for(d.setStartBefore(l);l&&l!==s.end&&!va(l);)r=l,l=f.getNextDomNode(l,!1,null,function(e){return!va(e)});if(d.setEndAfter(r),l=d.getCommonAncestor(),!f.isBody(l)&&va(l))l.setAttribute("dir",t);else{l=n.document.createElement("p"),l.setAttribute("dir",t);var c=d.extractContents();l.appendChild(c),d.insertNode(l)}l=f.getNextDomNode(l,!1,a)}n.moveToBookmark(s).moveToBookmark(o)}return i&&(n.setStartBefore(i).collapse(!0),f.remove(i)),n.select(),!0},queryCommandValue:function(){var e=Jb(this);return e?e.getAttribute("dir"):"ltr"}},UE.plugins.horizontal=function(){this.commands.horizontal={execCommand:function(e){if(-1!==this.queryCommandState(e)){this.execCommand("insertHtml","<hr>"),e=this.selection.getRange();var t=e.startContainer;if(1==t.nodeType&&!t.childNodes[e.startOffset]){var n;(n=t.childNodes[e.startOffset-1])&&1==n.nodeType&&"HR"==n.tagName&&("p"==this.options.enterTag?(n=this.document.createElement("p"),e.insertNode(n),e.setStart(n,0).setCursor()):(n=this.document.createElement("br"),e.insertNode(n),e.setStartBefore(n).setCursor()))}return!0}},queryCommandState:function(){return f.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}},this.addListener("delkeyup",function(){var e=this.selection.getRange();f.isBody(e.startContainer)&&(e=e.startContainer.childNodes[e.startOffset-1])&&"HR"==e.nodeName&&f.remove(e)})},UE.commands.time=UE.commands.date={execCommand:function(e){var t=new Date;this.execCommand("insertHtml","time"==e?t.getHours()+":"+(10>t.getMinutes()?"0"+t.getMinutes():t.getMinutes())+":"+(10>t.getSeconds()?"0"+t.getSeconds():t.getSeconds()):t.getFullYear()+"-"+(10>t.getMonth()+1?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(10>t.getDate()?"0"+t.getDate():t.getDate()))}},UE.plugins.rowspacing=function(){this.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]}),this.commands.rowspacing={execCommand:function(e,t,n){return this.execCommand("paragraph","p",{style:"margin-"+n+":"+t+"px"}),!0},queryCommandValue:function(e,t){var n=f.filterNodeList(this.selection.getStartElementPath(),function(e){return f.isBlockElm(e)});return n?(n=f.getComputedStyle(n,"margin-"+t).replace(/[^\d]/g,""),n?n:0):0}}},UE.plugins.lineheight=function(){this.setOpt({lineheight:"1 1.5 1.75 2 3 4 5".split(" ")}),this.commands.lineheight={execCommand:function(e,t){return this.execCommand("paragraph","p",{style:"line-height:"+("1"==t?"normal":t+"em")}),!0},queryCommandValue:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),function(e){return f.isBlockElm(e)});if(e)return e=f.getComputedStyle(e,"line-height"),"normal"==e?1:e.replace(/[^\d.]*/gi,"")}}},UE.plugins.insertcode=function(){var e=this;e.ready(function(){p.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;line-height:1.5}",e.document)}),e.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"}),e.commands.insertcode={execCommand:function(e,i){var o=this.selection.getRange(),a=f.findParentByTagName(o.startContainer,"pre",!0);if(a)a.className="brush:"+i+";toolbar:false;";else{var r="";o.collapsed?r=n.ie?8<n.version?"":"&nbsp;":"<br/>":(a=o.extractContents(),o=this.document.createElement("div"),o.appendChild(a),p.each(UE.filterNode(UE.htmlparser(o.innerHTML.replace(/[\r\t]/g,"")),this.options.filterTxtRules).children,function(e){n.ie&&8<n.version?("element"==e.type?"br"==e.tagName?r+="\n":t.$empty[e.tagName]||(p.each(e.children,function(n){"element"==n.type?"br"==n.tagName?r+="\n":t.$empty[e.tagName]||(r+=n.innerText()):r+=n.data}),/\n$/.test(r)||(r+="\n")):r+=e.data+"\n",!e.nextSibling()&&/\n$/.test(r)&&(r=r.replace(/\n$/,""))):n.ie?("element"==e.type?"br"==e.tagName?r+="<br>":t.$empty[e.tagName]||(p.each(e.children,function(n){"element"==n.type?"br"==n.tagName?r+="<br>":t.$empty[e.tagName]||(r+=n.innerText()):r+=n.data}),/br>$/.test(r)||(r+="<br>")):r+=e.data+"<br>",!e.nextSibling()&&/<br>$/.test(r)&&(r=r.replace(/<br>$/,""))):(r+="element"==e.type?t.$empty[e.tagName]?"":e.innerText():e.data,!/br\/?\s*>$/.test(r)&&e.nextSibling()&&(r+="<br>"))})),this.execCommand("inserthtml",'<pre id="coder"class="brush:'+i+';toolbar:false">'+r+"</pre>",!0),a=this.document.getElementById("coder"),f.removeAttributes(a,"id"),(o=a.previousSibling)&&f.isEmptyBlock(o)&&f.remove(o),o=this.selection.getRange(),f.isEmptyBlock(a)?o.setStart(a,0).setCursor(!1,!0):o.selectNodeContents(a).select()}},queryCommandValue:function(){var e=this.selection.getStartElementPath(),t="";return p.each(e,function(e){if("PRE"==e.nodeName)return t=(e=e.className.match(/brush:([^;]+)/))&&e[1]?e[1]:"",!1}),t}},e.addInputRule(function(e){p.each(e.getNodesByTagName("pre"),function(e){var t=e.getNodesByTagName("br");t.length?n.ie&&8<n.version&&p.each(t,function(e){var t=UE.uNode.createText("\n");e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e)}):n.ie&&8<n.version||(t=e.innerText().split(/\n/),e.innerHTML(""),p.each(t,function(t){t.length&&e.appendChild(UE.uNode.createText(t)),e.appendChild(UE.uNode.createElement("br"))}))})}),e.addOutputRule(function(e){p.each(e.getNodesByTagName("pre"),function(e){var t="";p.each(e.children,function(e){t="text"==e.type?t+e.data.replace(/[ ]/g,"&nbsp;"):t+"\n"}),e.innerText(t.replace(/(&nbsp;|\n)+$/,""))})}),e.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,highlightcode:1,insertcode:1,inserthtml:1,selectall:1},e.queryCommandState=function(e){return!this.notNeedCodeQuery[e.toLowerCase()]&&this.selection&&this.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)},e.addListener("beforeenterkeydown",function(){var t=e.selection.getRange(),i=f.findParentByTagName(t.startContainer,"pre",!0);if(i){if(e.fireEvent("saveScene"),t.collapsed||t.deleteContents(),n.ie)if(8<n.version){var i=e.document.createTextNode("\n"),o=t.startContainer;if(0==t.startOffset){if(o.previousSibling){t.insertNode(i);var a=e.document.createTextNode(" ");t.setStartAfter(i).insertNode(a).setStart(a,0).collapse(!0).select(!0)}}else t.insertNode(i).setStartAfter(i),a=e.document.createTextNode(" "),(o=t.startContainer.childNodes[t.startOffset])&&!/^\n/.test(o.nodeValue)&&t.setStartBefore(i),t.insertNode(a).setStart(a,0).collapse(!0).select(!0)}else{for(i=e.document.createElement("br"),t.insertNode(i),t.insertNode(e.document.createTextNode(f.fillChar)),t.setStartAfter(i),i=i.previousSibling;i;)if(o=i,i=i.previousSibling,!i||"BR"==i.nodeName){i=o;break}if(i){for(o="";i&&"BR"!=i.nodeName&&RegExp("^[ "+f.fillChar+"]*$").test(i.nodeValue);)o+=i.nodeValue,i=i.nextSibling;"BR"!=i.nodeName&&(i=i.nodeValue.match(RegExp("^([ "+f.fillChar+"]+)")))&&i[1]&&(o+=i[1]),o=e.document.createTextNode(o),t.insertNode(o).setStartAfter(o)}t.collapse(!0).select()}else{for(i=e.document.createElement("br"),t.insertNode(i).setStartAfter(i).collapse(!0),i.nextSibling?t.setStartAfter(i):t.insertNode(i.cloneNode(!1)),i=i.previousSibling;i;)if(o=i,i=i.previousSibling,!i||"BR"==i.nodeName){i=o;break}if(i){for(o="";i&&"BR"!=i.nodeName&&RegExp("^[\\s"+f.fillChar+"]*$").test(i.nodeValue);)o+=i.nodeValue,i=i.nextSibling;"BR"!=i.nodeName&&(i=i.nodeValue.match(RegExp("^([\\s"+f.fillChar+"]+)")))&&i[1]&&(o+=i[1]),o&&(o=e.document.createTextNode(o),t.insertNode(o).setStartAfter(o))}t.collapse(!0).select(!0)}return e.fireEvent("saveScene"),!0}}),e.addListener("tabkeydown",function(t,n){var i=e.selection.getRange(),o=f.findParentByTagName(i.startContainer,"pre",!0);if(o){if(e.fireEvent("saveScene"),!n.shiftKey)if(i.collapsed)o=e.document.createTextNode("    "),i.insertNode(o).setStartAfter(o).collapse(!0).select(!0);else{for(var a=i.createBookmark(),r=a.start.previousSibling;r;){if(o.firstChild===r&&!f.isBr(r)){o.insertBefore(e.document.createTextNode("    "),r);break}if(f.isBr(r)){o.insertBefore(e.document.createTextNode("    "),r.nextSibling);break}r=r.previousSibling}var s=a.end,r=a.start.nextSibling;for(o.firstChild===a.start&&o.insertBefore(e.document.createTextNode("    "),r.nextSibling);r&&r!==s;){if(f.isBr(r)&&r.nextSibling){if(r.nextSibling===s)break;o.insertBefore(e.document.createTextNode("    "),r.nextSibling)}r=r.nextSibling}i.moveToBookmark(a).select()}return e.fireEvent("saveScene"),!0}}),e.addListener("beforeinserthtml",function(e,i){var o=this,a=o.selection.getRange();if(f.findParentByTagName(a.startContainer,"pre",!0)){a.collapsed||a.deleteContents();var r="";if(n.ie&&8<n.version){p.each(UE.filterNode(UE.htmlparser(i),o.options.filterTxtRules).children,function(e){"element"==e.type?"br"==e.tagName?r+="\n":t.$empty[e.tagName]||(p.each(e.children,function(n){"element"==n.type?"br"==n.tagName?r+="\n":t.$empty[e.tagName]||(r+=n.innerText()):r+=n.data}),/\n$/.test(r)||(r+="\n")):r+=e.data+"\n",!e.nextSibling()&&/\n$/.test(r)&&(r=r.replace(/\n$/,""))});var s=o.document.createTextNode(p.html(r.replace(/&nbsp;/g," ")));a.insertNode(s).selectNode(s).select()}else{var l=o.document.createDocumentFragment();p.each(UE.filterNode(UE.htmlparser(i),o.options.filterTxtRules).children,function(e){"element"==e.type?"br"==e.tagName?l.appendChild(o.document.createElement("br")):t.$empty[e.tagName]||(p.each(e.children,function(n){"element"==n.type?"br"==n.tagName?l.appendChild(o.document.createElement("br")):t.$empty[e.tagName]||l.appendChild(o.document.createTextNode(p.html(n.innerText().replace(/&nbsp;/g," ")))):l.appendChild(o.document.createTextNode(p.html(n.data.replace(/&nbsp;/g," "))))}),"BR"!=l.lastChild.nodeName&&l.appendChild(o.document.createElement("br"))):l.appendChild(o.document.createTextNode(p.html(e.data.replace(/&nbsp;/g," ")))),!e.nextSibling()&&"BR"==l.lastChild.nodeName&&l.removeChild(l.lastChild)}),a.insertNode(l).select()}return!0}}),e.addListener("keydown",function(e,t){if(40==(t.keyCode||t.which)){var n,i=this.selection.getRange(),o=i.startContainer;if(i.collapsed&&(n=f.findParentByTagName(i.startContainer,"pre",!0))&&!n.nextSibling){for(var a=n.lastChild;a&&"BR"==a.nodeName;)a=a.previousSibling;(a===o||i.startContainer===n&&i.startOffset==n.childNodes.length)&&(this.execCommand("insertparagraph"),f.preventDefault(t))}}})},UE.commands.cleardoc={execCommand:function(){var e=this,t=e.options.enterTag,n=e.selection.getRange();"br"==t?(e.body.innerHTML="<br/>",n.setStart(e.body,0).setCursor()):(e.body.innerHTML="<p>"+(I?"":"<br/>")+"</p>",n.setStart(e.body.firstChild,0).setCursor(!1,!0)),setTimeout(function(){e.fireEvent("clearDoc")},0)}},UE.plugins.anchor=function(){var e=this;e.ready(function(){p.cssRule("anchor",".anchorclass{background: url('"+e.options.UEDITOR_HOME_URL+"themes/default/images/anchor.gif') no-repeat scroll left center transparent;border: 1px dotted #0000FF;cursor: auto;display: inline-block;height: 16px;width: 15px;}",e.document)}),e.addOutputRule(function(e){p.each(e.getNodesByTagName("img"),function(e){var t;(t=e.getAttr("anchorname"))&&(e.tagName="a",e.setAttr({anchorname:"",name:t,class:""}))})}),e.addInputRule(function(e){p.each(e.getNodesByTagName("a"),function(e){e.getAttr("name")&&!e.getAttr("href")&&(e.tagName="img",e.setAttr({anchorname:e.getAttr("name"),class:"anchorclass"}),e.setAttr("name"))})}),e.commands.anchor={execCommand:function(e,t){var n=this.selection.getRange(),i=n.getClosedNode();i&&i.getAttribute("anchorname")?t?i.setAttribute("anchorname",t):(n.setStartBefore(i).setCursor(),f.remove(i)):t&&(i=this.document.createElement("img"),n.collapse(!0),f.setAttributes(i,{anchorname:t,class:"anchorclass"}),n.insertNode(i).setStartAfter(i).setCursor(!1,!0))}}},UE.plugins.wordcount=function(){var e=this;e.addListener("contentchange",function(){e.fireEvent("wordcount")});var t;e.addListener("ready",function(){var e=this;f.on(e.body,"keyup",function(n){(n.keyCode||n.which)in{16:1,18:1,20:1,37:1,38:1,39:1,40:1}||(clearTimeout(t),t=setTimeout(function(){e.fireEvent("wordcount")},200))})})},UE.plugins.pagebreak=function(){function e(e){if(f.isEmptyBlock(e)){for(var t,i=e.firstChild;i&&1==i.nodeType&&f.isEmptyBlock(i);)t=i,i=i.firstChild;!t&&(t=e),f.fillNode(n.document,t)}}function t(e){return e&&1==e.nodeType&&"HR"==e.tagName&&"pagebreak"==e.className}var n=this,i=["td"];n.setOpt("pageBreakTag","_ueditor_page_break_tag_"),n.ready(function(){p.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",n.document)}),n.addInputRule(function(e){e.traversal(function(e){if("text"==e.type&&e.data==n.options.pageBreakTag){var t=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e)}})}),n.addOutputRule(function(e){p.each(e.getNodesByTagName("hr"),function(e){if("pagebreak"==e.getAttr("class")){var t=UE.uNode.createText(n.options.pageBreakTag);e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e)}})}),n.commands.pagebreak={execCommand:function(){var o=n.selection.getRange(),a=n.document.createElement("hr");f.setAttributes(a,{class:"pagebreak",noshade:"noshade",size:"5"}),f.unSelectable(a);var r=f.findParentByTagName(o.startContainer,i,!0),s=[];if(r)switch(r.tagName){case"TD":r=r.parentNode,r.previousSibling?(r.parentNode.insertBefore(a,r),s=f.findParents(a)):(o=f.findParentByTagName(r,"table"),o.parentNode.insertBefore(a,o),s=f.findParents(a,!0)),r=s[1],a!==r&&f.breakParent(a,r),n.fireEvent("afteradjusttable",n.document)}else{if(!o.collapsed)for(o.deleteContents(),r=o.startContainer;!f.isBody(r)&&f.isBlockElm(r)&&f.isEmptyNode(r);)o.setStartBefore(r).collapse(!0),f.remove(r),r=o.startContainer;for(o.insertNode(a),r=a.parentNode;!f.isBody(r);)f.breakParent(a,r),(r=a.nextSibling)&&f.isEmptyBlock(r)&&f.remove(r),r=a.parentNode;r=a.nextSibling,s=a.previousSibling,t(s)?f.remove(s):s&&e(s),r?(t(r)?f.remove(r):e(r),o.setEndAfter(a).collapse(!1)):(r=n.document.createElement("p"),a.parentNode.appendChild(r),f.fillNode(n.document,r),o.setStart(r,0).collapse(!0)),o.select(!0)}}}},UE.plugins.wordimage=function(){var e,t=this;t.addInputRule(function(e){p.each(e.getNodesByTagName("img"),function(e){var n=e.attrs,i=128>parseInt(n.width)||43>parseInt(n.height),o=t.options,a=o.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";n._src&&-1!==n._src.indexOf("file:///")&&e.setAttr({width:n.width,height:n.height,alt:n.alt,word_img:n._src,src:a,_src:a,style:"background:url("+(i?o.themePath+o.theme+"/images/word.gif":o.langPath+o.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})})}),t.commands.wordimage={execCommand:function(){e=f.getElementsByTagName(t.document.body,"img");for(var n,i=[],o=0;n=e[o++];)(n=n.getAttribute("word_img"))&&i.push(n);e.length&&(this.word_img=i)},queryCommandState:function(){e=f.getElementsByTagName(t.document.body,"img");for(var n,i=0;n=e[i++];)if(n.getAttribute("word_img"))return 1;return-1}}},UE.plugins.dragdrop=function(){var e=this;e.ready(function(){f.on(this.body,"dragend",function(){var t=e.selection.getRange(),n=t.getClosedNode()||e.selection.getStart();if(n&&"IMG"==n.tagName){for(var i,o=n.previousSibling;(i=n.nextSibling)&&(1==i.nodeType&&"SPAN"==i.tagName&&!i.firstChild);)f.remove(i);(!o||1!=o.nodeType||f.isEmptyBlock(o))&&o||i&&(!i||f.isEmptyBlock(i))||(o&&"P"==o.tagName&&!f.isEmptyBlock(o)?(o.appendChild(n),f.moveChild(i,o),f.remove(i)):i&&"P"==i.tagName&&!f.isEmptyBlock(i)&&i.insertBefore(n,i.firstChild),o&&"P"==o.tagName&&f.isEmptyBlock(o)&&f.remove(o),i&&"P"==i.tagName&&f.isEmptyBlock(i)&&f.remove(i),t.selectNode(n).select(),e.fireEvent("saveScene"))}})}),e.addListener("keyup",function(t,n){if(13==(n.keyCode||n.which)){var i,o=e.selection.getRange();(i=f.findParentByTagName(o.startContainer,"p",!0))&&"center"==f.getComputedStyle(i,"text-align")&&f.removeStyle(i,"text-align")}})},UE.plugins.undo=function(){function e(e,t){if(e.length!=t.length)return 0;for(var n=0,i=e.length;n<i;n++)if(e[n]!=t[n])return 0;return 1}function t(){this.undoManger.save()}var i,o=this.options.maxUndoCount||20,a=this.options.maxInputCount||20,r=RegExp(f.fillChar+"|</hr>","gi"),s={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},l=this.options.autoClearEmptyNode;this.undoManger=new function(){this.list=[],this.index=0,this.hasRedo=this.hasUndo=!1,this.undo=function(){if(this.hasUndo)if(this.list[this.index-1]||1!=this.list.length){for(;this.list[this.index].content==this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}else this.reset()},this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var e=this.editor,t=this.list[this.index],i=UE.htmlparser(t.content.replace(r,""));e.options.autoClearEmptyNode=!1,e.filterInputRule(i),e.options.autoClearEmptyNode=l,e.document.body.innerHTML=i.toHtml(),e.fireEvent("afterscencerestore"),n.ie&&p.each(f.getElementsByTagName(e.document,"td th caption p"),function(t){f.isEmptyNode(t)&&f.fillNode(e.document,t)});try{var o=new R.Range(e.document).moveToAddress(t.address);o.select(s[o.startContainer.nodeName.toLowerCase()])}catch(e){}this.update(),this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange().createAddress(!1,!0);e.fireEvent("beforegetscene");var i=UE.htmlparser(e.body.innerHTML,!0);return e.options.autoClearEmptyNode=!1,e.filterOutputRule(i),e.options.autoClearEmptyNode=l,i=i.toHtml(),n.ie&&(i=i.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">")),e.fireEvent("aftergetscene"),{address:t,content:i}},this.save=function(t,n){clearTimeout(i);var a,r=this.getScene(n),s=this.list[this.index];(a=s)&&(a=s.content==r.content)&&(t?s=1:(s=s.address,a=r.address,s=s.collapsed!=a.collapsed?0:e(s.startAddress,a.startAddress)&&e(s.endAddress,a.endAddress)?1:0),a=s),a||(this.list=this.list.slice(0,this.index+1),this.list.push(r),this.list.length>o&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasRedo=this.hasUndo=!1,this.clearKey()},this.clearKey=function(){c=0}},this.undoManger.editor=this,this.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),this.addListener("beforeexeccommand",t),this.addListener("afterexeccommand",t),this.addListener("reset",function(e,t){t||this.undoManger.reset()}),this.commands.redo=this.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+("undo"==e.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var d={16:1,17:1,18:1,37:1,38:1,39:1,40:1},c=0,u=!1;this.addListener("ready",function(){f.on(this.body,"compositionstart",function(){u=!0}),f.on(this.body,"compositionend",function(){u=!1})}),this.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var m=!0;this.addListener("keydown",function(e,t){var n=this;if(!(d[t.keyCode||t.which]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||u))if(n.selection.getRange().collapsed){0==n.undoManger.list.length&&n.undoManger.save(!0),clearTimeout(i);var o=function(e){e.selection.getRange().collapsed&&e.fireEvent("contentchange"),e.undoManger.save(!1,!0),e.fireEvent("selectionchange")};i=setTimeout(function(){if(u)var e=setInterval(function(){u||(o(n),clearInterval(e))},300);else o(n)},200),c++,c>=a&&o(n)}else n.undoManger.save(!1,!0),m=!1}),this.addListener("keyup",function(e,t){d[t.keyCode||t.which]||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||u||m||(this.undoManger.save(!1,!0),m=!0)})},UE.plugins.paste=function(){function e(e){var t=this.document;if(!t.getElementById("baidu_pastebin")){var i=this.selection.getRange(),o=i.createBookmark(),a=t.createElement("div");a.id="baidu_pastebin",n.webkit&&a.appendChild(t.createTextNode(f.fillChar+f.fillChar)),t.body.appendChild(a),o.start.style.display="",a.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+f.getXY(o.start).y+"px",i.selectNodeContents(a).select(!0),setTimeout(function(){if(n.webkit)for(var r,s=0,l=t.querySelectorAll("#baidu_pastebin");r=l[s++];){if(!f.isEmptyNode(r)){a=r;break}f.remove(r)}try{a.parentNode.removeChild(a)}catch(e){}i.moveToBookmark(o).select(!0),e(a)},0)}}var t,i,o,a=this;a.addListener("pasteTransfer",function(e,n){if(o&&t&&i&&t!=i){var r=a.selection.getRange();if(r.moveToAddress(o,!0),!r.collapsed){for(;!f.isBody(r.startContainer);){var s=r.startContainer;if(1==s.nodeType){if(s=s.childNodes[r.startOffset],!s){r.setStartBefore(r.startContainer);continue}(s=s.previousSibling)&&3==s.nodeType&&RegExp("^[\n\r\t "+f.fillChar+"]*$").test(s.nodeValue)&&r.setStartBefore(s)}if(0!=r.startOffset)break;r.setStartBefore(r.startContainer)}for(;!f.isBody(r.endContainer);){if(s=r.endContainer,1==s.nodeType){if(s=s.childNodes[r.endOffset],!s){r.setEndAfter(r.endContainer);continue}(s=s.nextSibling)&&3==s.nodeType&&RegExp("^[\n\r\t"+f.fillChar+"]*$").test(s.nodeValue)&&r.setEndAfter(s)}if(r.endOffset!=r.endContainer.childNodes.length)break;r.setEndAfter(r.endContainer)}}r.deleteContents(),r.select(!0),a.__hasEnterExecCommand=!0,r=i,2===n?r=r.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,n,i){return n=n.toLowerCase(),{img:1}[n]?e:(i=i.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,n){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+n+" ":""}),{span:1,div:1}[n]?"":"<"+t+n+" "+p.trim(i)+">")}):n&&(r=t),a.execCommand("inserthtml",r,!0),a.__hasEnterExecCommand=!1,r=a.selection.getRange().createAddress(!0),o.endAddress=r.startAddress}}),a.addListener("ready",function(){f.on(a.body,"cut",function(){!a.selection.getRange().collapsed&&a.undoManger&&a.undoManger.save()}),f.on(a.body,n.ie||n.opera?"keydown":"paste",function(r){(!n.ie&&!n.opera||!(!r.ctrlKey&&!r.metaKey||"86"!=r.keyCode))&&e.call(a,function(e){var r;if(e.firstChild){var s=f.getElementsByTagName(e,"span");r=0;for(var l;l=s[r++];)("_baidu_cut_start"==l.id||"_baidu_cut_end"==l.id)&&f.remove(l);if(n.webkit){for(l=e.querySelectorAll("div br"),r=0;s=l[r++];)s=s.parentNode,"DIV"==s.tagName&&1==s.childNodes.length&&(s.innerHTML="<p><br/></p>",f.remove(s));for(s=e.querySelectorAll("#baidu_pastebin"),r=0;l=s[r++];){var d=a.document.createElement("p");for(l.parentNode.insertBefore(d,l);l.firstChild;)d.appendChild(l.firstChild);f.remove(l)}for(l=e.querySelectorAll("meta"),r=0;s=l[r++];)f.remove(s);for(l=e.querySelectorAll("br"),r=0;s=l[r++];)/^apple-/i.test(s.className)&&f.remove(s)}if(n.gecko)for(l=e.querySelectorAll("[_moz_dirty]"),r=0;s=l[r++];)s.removeAttribute("_moz_dirty");if(!n.ie)for(l=e.querySelectorAll("span.Apple-style-span"),r=0;s=l[r++];)f.remove(s,!0);r=e.innerHTML,r=UE.filterWord(r),e=UE.htmlparser(r,!0),a.options.filterRules&&UE.filterNode(e,a.options.filterRules),a.filterInputRule(e),n.webkit&&((r=e.lastChild())&&"element"==r.type&&"br"==r.tagName&&e.removeChild(r),p.each(a.body.querySelectorAll("div"),function(e){f.isEmptyBlock(e)&&f.remove(e)})),r={html:e.toHtml()},a.fireEvent("beforepaste",r,e),r.html&&(e=UE.htmlparser(r.html,!0),1===a.queryCommandState("pasteplain")?a.execCommand("insertHtml",UE.filterNode(e,a.options.filterTxtRules).toHtml(),!0):(UE.filterNode(e,a.options.filterTxtRules),t=e.toHtml(),i=r.html,o=a.selection.getRange().createAddress(!0),a.execCommand("insertHtml",i,!0)),a.fireEvent("afterpaste",r))}})})})},UE.plugins.list=function(){function e(e){var t,n=[];for(t in e)n.push(t);return n}function i(e){var t=e.className;return f.hasClass(e,/custom_/)?t.match(/custom_(\w+)/)[1]:f.getStyle(e,"list-style-type")}function o(e,t){p.each(f.getElementsByTagName(e,"ol ul"),function(n){if(f.inDoc(n,e)){var o=n.parentNode;if(o.tagName==n.tagName){var s=i(n)||("OL"==n.tagName?"decimal":"disc"),l=i(o)||("OL"==o.tagName?"decimal":"disc");s==l&&(s=p.indexOf(h[n.tagName],s),s=s+1==h[n.tagName].length?0:s+1,r(n,h[n.tagName][s]))}var d=0,s=2;f.hasClass(n,/custom_/)?/[ou]l/i.test(o.tagName)&&f.hasClass(o,/custom_/)||(s=1):/[ou]l/i.test(o.tagName)&&f.hasClass(o,/custom_/)&&(s=3),(o=f.getStyle(n,"list-style-type"))&&(n.style.cssText="list-style-type:"+o),n.className=p.trim(n.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+s,p.each(f.getElementsByTagName(n,"li"),function(e){if(e.style.cssText&&(e.style.cssText=""),e.firstChild){if(e.parentNode===n){if(d++,f.hasClass(n,/custom_/)){var t=1,o=i(n);if("OL"==n.tagName){if(o)switch(o){case"cn":case"cn1":case"cn2":10<d&&(0==d%10||10<d&&20>d)?t=2:20<d&&(t=3);break;case"num2":9<d&&(t=2)}e.className="list-"+u[o]+d+" list-"+o+"-paddingleft-"+t}else e.className="list-"+u[o]+" list-"+o+"-paddingleft"}else e.className=e.className.replace(/list-[\w\-]+/gi,"");t=e.getAttribute("class"),null!==t&&!t.replace(/\s/g,"")&&f.removeAttributes(e,"class")}}else f.remove(e)}),!t&&a(n,n.tagName.toLowerCase(),i(n)||f.getStyle(n,"list-style-type"),!0)}})}function a(e,t,n,a){var r=e.nextSibling;r&&1==r.nodeType&&r.tagName.toLowerCase()==t&&(i(r)||f.getStyle(r,"list-style-type")||("ol"==t?"decimal":"disc"))==n&&(f.moveChild(r,e),0==r.childNodes.length&&f.remove(r)),r&&f.isFillChar(r)&&f.remove(r),(r=e.previousSibling)&&1==r.nodeType&&r.tagName.toLowerCase()==t&&(i(r)||f.getStyle(r,"list-style-type")||("ol"==t?"decimal":"disc"))==n&&f.moveChild(e,r),r&&f.isFillChar(r)&&f.remove(r),!a&&f.isEmptyBlock(e)&&f.remove(e),i(e)&&o(e.ownerDocument,!0)}function r(e,t){u[t]&&(e.className="custom_"+t);try{f.setStyle(e,"list-style-type",t)}catch(e){}}function s(e){var t=e.previousSibling;t&&f.isEmptyBlock(t)&&f.remove(t),(t=e.nextSibling)&&f.isEmptyBlock(t)&&f.remove(t)}function l(e){for(;e&&!f.isBody(e);){if("TABLE"==e.nodeName)return null;if("LI"==e.nodeName)return e;e=e.parentNode}}var d=this,c={TD:1,PRE:1,BLOCKQUOTE:1},u={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};d.setOpt({insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1});var m,h={OL:e(d.options.insertorderedlist),UL:e(d.options.insertunorderedlist)},g=d.options.listiconpath;for(m in u)!d.options.insertorderedlist.hasOwnProperty(m)&&!d.options.insertunorderedlist.hasOwnProperty(m)&&delete u[m];d.ready(function(){var e,t=[];for(e in u){if("dash"==e||"dot"==e)t.push("li.list-"+u[e]+"{background-image:url("+g+u[e]+".gif)}"),t.push("ul.custom_"+e+"{list-style:none;}ul.custom_"+e+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(var i=0;99>i;i++)t.push("li.list-"+u[e]+i+"{background-image:url("+g+"list-"+u[e]+i+".gif)}");t.push("ol.custom_"+e+"{list-style:none;}ol.custom_"+e+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(e){case"cn":t.push("li.list-"+e+"-paddingleft-1{padding-left:25px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:40px}"),t.push("li.list-"+e+"-paddingleft-3{padding-left:55px}");break;case"cn1":t.push("li.list-"+e+"-paddingleft-1{padding-left:30px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:40px}"),t.push("li.list-"+e+"-paddingleft-3{padding-left:55px}");break;case"cn2":t.push("li.list-"+e+"-paddingleft-1{padding-left:40px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:55px}"),t.push("li.list-"+e+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":t.push("li.list-"+e+"-paddingleft-1{padding-left:25px}");break;case"num2":t.push("li.list-"+e+"-paddingleft-1{padding-left:35px}"),t.push("li.list-"+e+"-paddingleft-2{padding-left:40px}");break;case"dash":t.push("li.list-"+e+"-paddingleft{padding-left:35px}");break;case"dot":t.push("li.list-"+e+"-paddingleft{padding-left:20px}")}}t.push(".list-paddingleft-1{padding-left:0}"),t.push(".list-paddingleft-2{padding-left:"+d.options.listDefaultPaddingLeft+"px}"),t.push(".list-paddingleft-3{padding-left:"+2*d.options.listDefaultPaddingLeft+"px}"),p.cssRule("list","ol,ul{margin:0;pading:0;"+(n.ie?"":"width:95%")+"}li{clear:both;}"+t.join("\n"),d.document)}),d.ready(function(){f.on(d.body,"cut",function(){setTimeout(function(){var e,t=d.selection.getRange();if((e=f.findParentByTagName(t.startContainer,"li",!0))&&!e.nextSibling&&f.isEmptyBlock(e)){
e=e.parentNode;var n;(n=e.previousSibling)?(f.remove(e),t.setStartAtLast(n).collapse(!0)):(n=e.nextSibling)?(f.remove(e),t.setStartAtFirst(n).collapse(!0)):(n=d.document.createElement("p"),f.fillNode(d.document,n),e.parentNode.insertBefore(n,e),f.remove(e),t.setStart(n,0).collapse(!0)),t.select(!0)}})})}),d.addListener("beforepaste",function(e,t){var n=this.selection.getRange(),o=UE.htmlparser(t.html,!0);if(n=f.findParentByTagName(n.startContainer,"li",!0)){var a=n.parentNode;p.each(o.getNodesByTagName("OL"==a.tagName?"ul":"ol"),function(t){if(t.tagName=a.tagName,t.setAttr(),t.parentNode===o)e=i(a)||("OL"==a.tagName?"decimal":"disc");else{var n=t.parentNode.getAttr("class");(e=n&&/custom_/.test(n)?n.match(/custom_(\w+)/)[1]:t.parentNode.getStyle("list-style-type"))||(e="OL"==a.tagName?"decimal":"disc")}n=p.indexOf(h[a.tagName],e),t.parentNode!==o&&(n=n+1==h[a.tagName].length?0:n+1),n=h[a.tagName][n],u[n]?t.setAttr("class","custom_"+n):t.setStyle("list-style-type",n)})}t.html=o.toHtml()}),d.addInputRule(function(e){function n(e,t){var n=t.firstChild();if(n&&"element"==n.type&&"span"==n.tagName&&/Wingdings|Symbol/.test(n.getStyle("font-family"))){for(var a in o)if(o[a]==n.data)return a;return"disc"}for(a in i)if(i[a].test(e))return a}p.each(e.getNodesByTagName("li"),function(e){for(var n,i=UE.uNode.createElement("p"),o=0;n=e.children[o];)"text"==n.type||t.p[n.tagName]?i.appendChild(n):i.firstChild()?(e.insertBefore(i,n),i=UE.uNode.createElement("p"),o+=2):o++;(i.firstChild()&&!i.parentNode||!e.firstChild())&&e.appendChild(i)});var i={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},o={square:"n"};p.each(e.getNodesByTagName("p"),function(e){if("MsoListParagraph"==e.getAttr("class")){e.setAttr("class","");var t,o=e;if("li"!=e.parentNode.tagName&&(t=n(e.innerText(),e))){var a=UE.uNode.createElement(d.options.insertorderedlist.hasOwnProperty(t)?"ol":"ul");for(u[t]?a.setAttr("class","custom_"+t):a.setStyle("list-style-type",t);e&&"li"!=e.parentNode.tagName&&n(e.innerText(),e);){(o=e.nextSibling())||e.parentNode.insertBefore(a,e);var r=a,s=t;"ol"==r.tagName?e.innerHTML(e.innerHTML().replace(i[s],"")):e.removeChild(e.firstChild()),s=UE.uNode.createElement("li"),s.appendChild(e),r.appendChild(s),e=o}!a.parentNode&&e&&e.parentNode&&e.parentNode.insertBefore(a,e)}}})}),d.addListener("contentchange",function(){o(d.document)}),d.addListener("keydown",function(e,n){function i(){n.preventDefault?n.preventDefault():n.returnValue=!1,d.fireEvent("contentchange"),d.undoManger&&d.undoManger.save()}function o(e,t){for(;e&&!f.isBody(e)&&!t(e);){if(1==e.nodeType&&/[ou]l/i.test(e.tagName))return e;e=e.parentNode}return null}var a=n.keyCode||n.which;if(13==a&&!n.shiftKey){var r=d.selection.getRange(),l=f.findParent(r.startContainer,function(e){return f.isBlockElm(e)},!0),c=f.findParentByTagName(r.startContainer,"li",!0);if(l&&"PRE"!=l.tagName&&!c&&(c=l.innerHTML.replace(RegExp(f.fillChar,"g"),""),/^\s*1\s*\.[^\d]/.test(c)&&(l.innerHTML=c.replace(/^\s*1\s*\./,""),r.setStartAtLast(l).collapse(!0).select(),d.__hasEnterExecCommand=!0,d.execCommand("insertorderedlist"),d.__hasEnterExecCommand=!1)),r=d.selection.getRange(),l=o(r.startContainer,function(e){return"TABLE"==e.tagName}),c=r.collapsed?l:o(r.endContainer,function(e){return"TABLE"==e.tagName}),l&&c&&l===c){if(!r.collapsed){if(l=f.findParentByTagName(r.startContainer,"li",!0),c=f.findParentByTagName(r.endContainer,"li",!0),!l||!c||l!==c){var l=r.cloneRange(),u=l.collapse(!1).createBookmark();return r.deleteContents(),l.moveToBookmark(u),c=f.findParentByTagName(l.startContainer,"li",!0),s(c),l.select(),void i()}if(r.deleteContents(),(c=f.findParentByTagName(r.startContainer,"li",!0))&&f.isEmptyBlock(c))return h=c.previousSibling,next=c.nextSibling,l=d.document.createElement("p"),f.fillNode(d.document,l),m=c.parentNode,h&&next?(r.setStart(next,0).collapse(!0).select(!0),f.remove(c)):((h||next)&&h?c.parentNode.parentNode.insertBefore(l,m.nextSibling):m.parentNode.insertBefore(l,m),f.remove(c),m.firstChild||f.remove(m),r.setStart(l,0).setCursor()),void i()}if(c=f.findParentByTagName(r.startContainer,"li",!0)){if(f.isEmptyBlock(c)){var u=r.createBookmark(),m=c.parentNode;if(c!==m.lastChild?(f.breakParent(c,m),s(c)):(m.parentNode.insertBefore(c,m.nextSibling),f.isEmptyNode(m)&&f.remove(m)),!t.$list[c.parentNode.tagName])if(f.isBlockElm(c.firstChild))f.remove(c,!0);else{for(l=d.document.createElement("p"),c.parentNode.insertBefore(l,c);c.firstChild;)l.appendChild(c.firstChild);f.remove(c)}r.moveToBookmark(u).select()}else{if(l=c.firstChild,!l||!f.isBlockElm(l)){for(l=d.document.createElement("p"),!c.firstChild&&f.fillNode(d.document,l);c.firstChild;)l.appendChild(c.firstChild);c.appendChild(l)}u=d.document.createElement("span"),r.insertNode(u),f.breakParent(u,c),h=u.nextSibling,l=h.firstChild,l||(l=d.document.createElement("p"),f.fillNode(d.document,l),h.appendChild(l)),f.isEmptyNode(l)&&(l.innerHTML="",f.fillNode(d.document,l)),r.setStart(l,0).collapse(!0).shrinkBoundary().select(),f.remove(u);var h=h.previousSibling;h&&f.isEmptyBlock(h)&&(h.innerHTML="<p></p>",f.fillNode(d.document,h.firstChild))}i()}}}if(8==a&&(r=d.selection.getRange(),r.collapsed&&f.isStartInblock(r)&&(l=r.cloneRange().trimBoundary(),(c=f.findParentByTagName(r.startContainer,"li",!0))&&f.isStartInblock(l))))if((l=f.findParentByTagName(r.startContainer,"p",!0))&&l!==c.firstChild)m=f.findParentByTagName(l,["ol","ul"]),f.breakParent(l,m),s(l),d.fireEvent("contentchange"),r.setStart(l,0).setCursor(!1,!0),d.fireEvent("saveScene"),f.preventDefault(n);else if(c&&(h=c.previousSibling)){if(46!=a||!c.childNodes.length){if(t.$list[h.tagName]&&(h=h.lastChild),d.undoManger&&d.undoManger.save(),l=c.firstChild,f.isBlockElm(l))if(f.isEmptyNode(l))for(h.appendChild(l),r.setStart(l,0).setCursor(!1,!0);c.firstChild;)h.appendChild(c.firstChild);else u=d.document.createElement("span"),r.insertNode(u),f.isEmptyBlock(h)&&(h.innerHTML=""),f.moveChild(c,h),r.setStartBefore(u).collapse(!0).select(!0),f.remove(u);else if(f.isEmptyNode(c))l=d.document.createElement("p"),h.appendChild(l),r.setStart(l,0).setCursor();else for(r.setEnd(h,h.childNodes.length).collapse().select(!0);c.firstChild;)h.appendChild(c.firstChild);f.remove(c),d.fireEvent("contentchange"),d.fireEvent("saveScene"),f.preventDefault(n)}}else if(c&&!c.previousSibling){if(m=c.parentNode,u=r.createBookmark(),f.isTagNode(m.parentNode,"ol ul"))m.parentNode.insertBefore(c,m);else{for(;c.firstChild;)m.parentNode.insertBefore(c.firstChild,m);f.remove(c)}f.isEmptyNode(m)&&f.remove(m),r.moveToBookmark(u).setCursor(!1,!0),d.fireEvent("contentchange"),d.fireEvent("saveScene"),f.preventDefault(n)}}),d.addListener("keyup",function(e,t){if(8==(t.keyCode||t.which)){var n=d.selection.getRange();(n=f.findParentByTagName(n.startContainer,["ol","ul"],!0))&&a(n,n.tagName.toLowerCase(),i(n)||f.getComputedStyle(n,"list-style-type"),!0)}}),d.addListener("tabkeydown",function(){function e(e){if(-1!=d.options.maxListLevel){e=e.parentNode;for(var t=0;/[ou]l/i.test(e.tagName);)t++,e=e.parentNode;if(t>=d.options.maxListLevel)return!0}}var t=d.selection.getRange(),n=f.findParentByTagName(t.startContainer,"li",!0);if(n){var o;if(!t.collapsed){d.fireEvent("saveScene"),o=t.createBookmark();for(var s,l,c=0,u=f.findParents(n);l=u[c++];)if(f.isTagNode(l,"ol ul")){s=l;break}if(l=n,o.end)for(;l&&!(f.getPosition(l,o.end)&f.POSITION_FOLLOWING);)if(e(l))l=f.getNextDomNode(l,!1,null,function(e){return e!==s});else{for(c=l.parentNode,u=d.document.createElement(c.tagName),m=p.indexOf(h[u.tagName],i(c)||f.getComputedStyle(c,"list-style-type")),m=h[u.tagName][m+1==h[u.tagName].length?0:m+1],r(u,m),c.insertBefore(u,l);l&&!(f.getPosition(l,o.end)&f.POSITION_FOLLOWING);){if(n=l.nextSibling,u.appendChild(l),!n||f.isTagNode(n,"ol ul")){if(n)for(;(n=n.firstChild)&&"LI"!=n.tagName;);else n=f.getNextDomNode(l,!1,null,function(e){return e!==s});break}l=n}a(u,u.tagName.toLowerCase(),m),l=n}return d.fireEvent("contentchange"),t.moveToBookmark(o).select(),!0}if(e(n))return!0;var c=n.parentNode,u=d.document.createElement(c.tagName),m=p.indexOf(h[u.tagName],i(c)||f.getComputedStyle(c,"list-style-type")),m=m+1==h[u.tagName].length?0:m+1,m=h[u.tagName][m];if(r(u,m),f.isStartInblock(t))return d.fireEvent("saveScene"),o=t.createBookmark(),c.insertBefore(u,n),u.appendChild(n),a(u,u.tagName.toLowerCase(),m),d.fireEvent("contentchange"),t.moveToBookmark(o).select(!0),!0}}),d.commands.insertorderedlist=d.commands.insertunorderedlist={execCommand:function(e,n){n||(n="insertorderedlist"==e.toLowerCase()?"decimal":"disc");var o=this.selection.getRange(),s=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!f.isWhitespace(e)},d="insertorderedlist"==e.toLowerCase()?"ol":"ul",u=this.document.createDocumentFragment();o.adjustmentBoundary().shrinkBoundary();var m,h,g,b,v=o.createBookmark(!0),y=l(this.document.getElementById(v.start)),C=0,N=l(this.document.getElementById(v.end)),x=0;if(y||N){if(y&&(m=y.parentNode),v.end||(N=y),N&&(h=N.parentNode),m===h){for(;y!==N;){if(b=y,y=y.nextSibling,!f.isBlockElm(b.firstChild)){for(s=this.document.createElement("p");b.firstChild;)s.appendChild(b.firstChild);b.appendChild(s)}u.appendChild(b)}if(b=this.document.createElement("span"),m.insertBefore(b,N),!f.isBlockElm(N.firstChild)){for(s=this.document.createElement("p");N.firstChild;)s.appendChild(N.firstChild);N.appendChild(s)}if(u.appendChild(N),f.breakParent(b,m),f.isEmptyNode(b.previousSibling)&&f.remove(b.previousSibling),f.isEmptyNode(b.nextSibling)&&f.remove(b.nextSibling),s=i(m)||f.getComputedStyle(m,"list-style-type")||("insertorderedlist"==e.toLowerCase()?"decimal":"disc"),m.tagName.toLowerCase()==d&&s==n){for(var s=0,w=this.document.createDocumentFragment();N=u.childNodes[s++];)if(f.isTagNode(N,"ol ul"))p.each(f.getElementsByTagName(N,"li"),function(e){for(;e.firstChild;)w.appendChild(e.firstChild)});else for(;N.firstChild;)w.appendChild(N.firstChild);b.parentNode.insertBefore(w,b)}else g=this.document.createElement(d),r(g,n),g.appendChild(u),b.parentNode.insertBefore(g,b);return f.remove(b),g&&a(g,d,n),void o.moveToBookmark(v).select()}if(y){for(;y;){if(b=y.nextSibling,f.isTagNode(y,"ol ul"))u.appendChild(y);else{g=this.document.createDocumentFragment();for(var E=0;y.firstChild;)f.isBlockElm(y.firstChild)&&(E=1),g.appendChild(y.firstChild);E?u.appendChild(g):(E=this.document.createElement("p"),E.appendChild(g),u.appendChild(E)),f.remove(y)}y=b}m.parentNode.insertBefore(u,m.nextSibling),f.isEmptyNode(m)?(o.setStartBefore(m),f.remove(m)):o.setStartAfter(m),C=1}if(N&&f.inDoc(h,this.document)){for(y=h.firstChild;y&&y!==N;){if(b=y.nextSibling,f.isTagNode(y,"ol ul"))u.appendChild(y);else{for(g=this.document.createDocumentFragment(),E=0;y.firstChild;)f.isBlockElm(y.firstChild)&&(E=1),g.appendChild(y.firstChild);E?u.appendChild(g):(E=this.document.createElement("p"),E.appendChild(g),u.appendChild(E)),f.remove(y)}y=b}b=f.createElement(this.document,"div",{tmpDiv:1}),f.moveChild(N,b),u.appendChild(b),f.remove(N),h.parentNode.insertBefore(u,h),o.setEndBefore(h),f.isEmptyNode(h)&&f.remove(h),x=1}}for(C||o.setStartBefore(this.document.getElementById(v.start)),v.end&&!x&&o.setEndAfter(this.document.getElementById(v.end)),o.enlarge(!0,function(e){return c[e.tagName]}),u=this.document.createDocumentFragment(),N=o.createBookmark(),m=f.getNextDomNode(N.start,!1,s),y=o.cloneRange(),h=f.isBlockElm;m&&m!==N.end&&f.getPosition(m,N.end)&f.POSITION_PRECEDING;)if(3==m.nodeType||t.li[m.tagName])if(1==m.nodeType&&t.$list[m.tagName]){for(;m.firstChild;)u.appendChild(m.firstChild);C=f.getNextDomNode(m,!1,s),f.remove(m),m=C}else{for(C=m,y.setStartBefore(m);m&&m!==N.end&&(!h(m)||f.isBookmarkNode(m));)C=m,m=f.getNextDomNode(m,!1,null,function(e){return!c[e.tagName]});if(m&&h(m)&&(b=f.getNextDomNode(C,!1,s))&&f.isBookmarkNode(b)&&(m=f.getNextDomNode(b,!1,s),C=b),y.setEndAfter(C),m=f.getNextDomNode(C,!1,s),b=o.document.createElement("li"),b.appendChild(y.extractContents()),f.isEmptyNode(b)){for(C=o.document.createElement("p");b.firstChild;)C.appendChild(b.firstChild);b.appendChild(C)}u.appendChild(b)}else m=f.getNextDomNode(m,!0,s);for(o.moveToBookmark(N).collapse(!0),g=this.document.createElement(d),r(g,n),g.appendChild(u),o.insertNode(g),a(g,d,n),s=0,d=f.getElementsByTagName(g,"div");N=d[s++];)N.getAttribute("tmpDiv")&&f.remove(N,!0);o.moveToBookmark(v).select()},queryCommandState:function(e){e="insertorderedlist"==e.toLowerCase()?"ol":"ul";for(var t,n=this.selection.getStartElementPath(),i=0;(t=n[i++])&&"TABLE"!=t.nodeName;)if(e==t.nodeName.toLowerCase())return 1;return 0},queryCommandValue:function(e){e="insertorderedlist"==e.toLowerCase()?"ol":"ul";for(var t,n,o=this.selection.getStartElementPath(),a=0;n=o[a++];){if("TABLE"==n.nodeName){t=null;break}if(e==n.nodeName.toLowerCase()){t=n;break}}return t?i(t)||f.getComputedStyle(t,"list-style-type"):null}}};var Pc={textarea:function(e,t){var i=t.ownerDocument.createElement("textarea");return i.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",n.ie&&8>n.version&&(i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px",t.onresize=function(){i.style.width=t.offsetWidth+"px",i.style.height=t.offsetHeight+"px"}),t.appendChild(i),{setContent:function(e){i.value=e},getContent:function(){return i.value},select:function(){var e;n.ie?(e=i.createTextRange(),e.collapse(!0),e.select()):(i.setSelectionRange(0,0),i.focus())},dispose:function(){t.removeChild(i),t=i=t.onresize=null}}},codemirror:function(e,t){var n=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),i=n.getWrapperElement();return i.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',n.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",n.refresh(),{getCodeMirror:function(){return n},setContent:function(e){n.setValue(e)},getContent:function(){return n.getValue()},select:function(){n.focus()},dispose:function(){t.removeChild(i),n=i=null}}}};UE.plugins.source=function(){var e,t=this,i=this.options,o=!1;i.sourceEditor=n.ie?"textarea":i.sourceEditor||"codemirror",t.setOpt({sourceEditorFirst:!1});var a,r,s=t.getContent;t.commands.source={execCommand:function(){if(o=!o){r=t.selection.getRange().createAddress(!1,!0),t.undoManger&&t.undoManger.save(!0),n.gecko&&(t.body.contentEditable=!1),a=t.iframe.style.cssText,t.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",t.fireEvent("beforegetcontent");var l=UE.htmlparser(t.body.innerHTML,!0);t.filterOutputRule(l),l.traversal(function(e){if("element"==e.type)switch(e.tagName){case"td":case"th":case"caption":e.children&&1==e.children.length&&"br"==e.firstChild().tagName&&e.removeChild(e.firstChild());break;case"pre":e.innerText(e.innerText().replace(/&nbsp;/g," "))}}),t.fireEvent("aftergetcontent"),l=l.toHtml(!0),e=Pc["codemirror"==i.sourceEditor&&window.CodeMirror?"codemirror":"textarea"](t,t.iframe.parentNode),e.setContent(l),setTimeout(function(){e.select(),t.addListener("fullscreenchanged",function(){try{e.getCodeMirror().refresh()}catch(e){}})}),t.getContent=function(){return e.getContent()||"<p>"+(n.ie?"":"<br/>")+"</p>"}}else if(t.iframe.style.cssText=a,l=e.getContent()||"<p>"+(n.ie?"":"<br/>")+"</p>",t.setContent(l),e.dispose(),e=null,t.getContent=s,l=t.body.firstChild,l||(t.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>",l=t.body.firstChild),t.undoManger&&t.undoManger.save(!0),n.gecko){var d=document.createElement("input");d.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(d),t.body.contentEditable=!1,setTimeout(function(){f.setViewportOffset(d,{left:-32768,top:0}),d.focus(),setTimeout(function(){t.body.contentEditable=!0,t.selection.getRange().moveToAddress(r).select(!0),f.remove(d)})})}else try{t.selection.getRange().moveToAddress(r).select(!0)}catch(e){}this.fireEvent("sourcemodechanged",o)},queryCommandState:function(){return 0|o},notNeedUndo:1};var l=t.queryCommandState;t.queryCommandState=function(e){return e=e.toLowerCase(),o?e in{source:1,fullscreen:1}?1:-1:l.apply(this,arguments)},"codemirror"==i.sourceEditor&&t.addListener("ready",function(){p.loadFile(document,{src:i.codeMirrorJsUrl||i.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){i.sourceEditorFirst&&setTimeout(function(){t.execCommand("source")},0)}),p.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:i.codeMirrorCssUrl||i.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})},UE.plugins.enterkey=function(){var e,i=this,o=i.options.enterTag;i.addListener("keyup",function(t,o){if(13==(o.keyCode||o.which)){var a,r=i.selection.getRange(),s=r.startContainer;if(n.ie)i.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(e)){if(n.gecko)f.findParentByTagName(s,"h1 h2 h3 h4 h5 h6 blockquote caption table".split(" "),!0)||(i.document.execCommand("formatBlock",!1,"<p>"),a=1);else if(1==s.nodeType){var l,s=i.document.createTextNode("");if(r.insertNode(s),l=f.findParentByTagName(s,"div",!0)){for(a=i.document.createElement("p");l.firstChild;)a.appendChild(l.firstChild);l.parentNode.insertBefore(a,l),f.remove(l),r.setStartBefore(s).setCursor(),a=1}f.remove(s)}i.undoManger&&a&&i.undoManger.save()}n.opera&&r.select()}}}),i.addListener("keydown",function(a,r){if(13==(r.keyCode||r.which))if(i.fireEvent("beforeenterkeydown"))f.preventDefault(r);else{i.fireEvent("saveScene",!0,!0),e="";var s=i.selection.getRange();if(!s.collapsed){var l=s.startContainer,d=s.endContainer,l=f.findParentByTagName(l,"td",!0),d=f.findParentByTagName(d,"td",!0);if(l&&d&&l!==d||!l&&d||l&&!d)return void(r.preventDefault?r.preventDefault():r.returnValue=!1)}if("p"==o)n.ie||(l=f.findParentByTagName(s.startContainer,"ol ul p h1 h2 h3 h4 h5 h6 blockquote caption".split(" "),!0),l||n.opera?(e=l.tagName,"p"==l.tagName.toLowerCase()&&n.gecko&&f.removeDirtyAttr(l)):(i.document.execCommand("formatBlock",!1,"<p>"),n.gecko&&(s=i.selection.getRange(),(l=f.findParentByTagName(s.startContainer,"p",!0))&&f.removeDirtyAttr(l))));else if(r.preventDefault?r.preventDefault():r.returnValue=!1,s.collapsed)d=s.document.createElement("br"),s.insertNode(d),d.parentNode.lastChild===d?(d.parentNode.insertBefore(d.cloneNode(!0),d),s.setStartBefore(d)):s.setStartAfter(d),s.setCursor();else if(s.deleteContents(),l=s.startContainer,1==l.nodeType&&(l=l.childNodes[s.startOffset])){for(;1==l.nodeType;){if(t.$empty[l.tagName])return s.setStartBefore(l).setCursor(),i.undoManger&&i.undoManger.save(),!1;if(!l.firstChild)return d=s.document.createElement("br"),l.appendChild(d),s.setStart(l,0).setCursor(),i.undoManger&&i.undoManger.save(),!1;l=l.firstChild}l===s.startContainer.childNodes[s.startOffset]?(d=s.document.createElement("br"),s.insertNode(d).setCursor()):s.setStart(l,0).setCursor()}else d=s.document.createElement("br"),s.insertNode(d).setStartAfter(d).setCursor()}})},UE.plugins.keystrokes=function(){var e=this,t=!0;e.addListener("keydown",function(i,o){var a=o.keyCode||o.which,r=e.selection.getRange();if(!r.collapsed&&!o.ctrlKey&&!o.shiftKey&&!o.altKey&&!o.metaKey&&(65<=a&&90>=a||48<=a&&57>=a||96<=a&&111>=a||{13:1,8:1,46:1}[a])){var s=r.startContainer;if(f.isFillChar(s)&&r.setStartBefore(s),s=r.endContainer,f.isFillChar(s)&&r.setEndAfter(s),r.txtToElmBoundary(),r.endContainer&&1==r.endContainer.nodeType&&(s=r.endContainer.childNodes[r.endOffset])&&f.isBr(s)&&r.setEndAfter(s),0==r.startOffset&&(s=r.startContainer,f.isBoundaryNode(s,"firstChild")&&(s=r.endContainer,r.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&f.isBoundaryNode(s,"lastChild"))))return e.fireEvent("saveScene"),e.body.innerHTML="<p>"+(n.ie?"":"<br/>")+"</p>",r.setStart(e.body.firstChild,0).setCursor(!1,!0),void e._selectionChange()}if(8==a){r=e.selection.getRange(),t=r.collapsed;var l,d;if(r.collapsed&&r.inFillChar()&&(l=r.startContainer,f.isFillChar(l)?(r.setStartBefore(l).shrinkBoundary(!0).collapse(!0),f.remove(l)):(l.nodeValue=l.nodeValue.replace(RegExp("^"+f.fillChar),""),r.startOffset--,r.collapse(!0).select(!0))),l=r.getClosedNode())return e.fireEvent("saveScene"),r.setStartBefore(l),f.remove(l),r.setCursor(),e.fireEvent("saveScene"),void f.preventDefault(o);if(!n.ie&&(l=f.findParentByTagName(r.startContainer,"table",!0),d=f.findParentByTagName(r.endContainer,"table",!0),l&&!d||!l&&d||l!==d))return void o.preventDefault()}if(9==a){var c={ol:1,ul:1,table:1};if(e.fireEvent("tabkeydown",o))return void f.preventDefault(o);r=e.selection.getRange(),e.fireEvent("saveScene"),s=0,l="",d=e.options.tabSize||4;for(var u=e.options.tabNode||"&nbsp;";s<d;s++)l+=u;if(s=e.document.createElement("span"),s.innerHTML=l+f.fillChar,r.collapsed)r.insertNode(s.cloneNode(!0).firstChild).setCursor(!0);else if(l=f.findParent(r.startContainer,m),d=f.findParent(r.endContainer,m),l&&d&&l===d)r.deleteContents(),r.insertNode(s.cloneNode(!0).firstChild).setCursor(!0);else{l=r.createBookmark();var m=function(e){return f.isBlockElm(e)&&!c[e.tagName.toLowerCase()]};for(r.enlarge(!0),d=r.createBookmark(),u=f.getNextDomNode(d.start,!1,m);u&&!(f.getPosition(u,d.end)&f.POSITION_FOLLOWING);)u.insertBefore(s.cloneNode(!0).firstChild,u.firstChild),u=f.getNextDomNode(u,!1,m);r.moveToBookmark(d).moveToBookmark(l).select()}f.preventDefault(o)}if(n.gecko&&46==a&&(r=e.selection.getRange(),r.collapsed&&(l=r.startContainer,f.isEmptyBlock(l)))){for(a=l.parentNode;1==f.getChildCount(a)&&!f.isBody(a);)l=a,a=a.parentNode;l===a.lastChild&&o.preventDefault()}}),e.addListener("keyup",function(e,i){var o;if(8==(i.keyCode||i.which)&&!this.fireEvent("delkeyup")){if(o=this.selection.getRange(),o.collapsed){var a;if((a=f.findParentByTagName(o.startContainer,"h1 h2 h3 h4 h5 h6".split(" "),!0))&&f.isEmptyBlock(a)){var r=a.previousSibling;if(r&&"TABLE"!=r.nodeName)return f.remove(a),void o.setStartAtLast(r).setCursor(!1,!0);if((r=a.nextSibling)&&"TABLE"!=r.nodeName)return f.remove(a),void o.setStartAtFirst(r).setCursor(!1,!0)}f.isBody(o.startContainer)&&(a=f.createElement(this.document,"p",{innerHTML:n.ie?f.fillChar:"<br/>"}),o.insertNode(a).setStart(a,0).setCursor(!1,!0))}!t&&(3==o.startContainer.nodeType||1==o.startContainer.nodeType&&f.isEmptyBlock(o.startContainer))&&(n.ie?(a=o.document.createElement("span"),o.insertNode(a).setStartBefore(a).collapse(!0),o.select(),f.remove(a)):o.select())}})},UE.plugins.fiximgclick=function(){var e=this;n.webkit&&e.addListener("click",function(t,n){"IMG"==n.target.tagName&&new R.Range(e.document).selectNode(n.target).select()})},UE.plugins.autolink=function(){if(!n.ie){var e=this;e.addListener("reset",function(){}),e.addListener("keydown",function(t,n){var i=n.keyCode||n.which;if(32==i||13==i){for(var o,i=e.selection.getNative(),a=i.getRangeAt(0).cloneRange(),r=a.startContainer;1==r.nodeType&&0<a.startOffset&&(r=a.startContainer.childNodes[a.startOffset-1],r);)a.setStart(r,1==r.nodeType?r.childNodes.length:r.nodeValue.length),a.collapse(!0),r=a.startContainer;do{if(0==a.startOffset){for(r=a.startContainer.previousSibling;r&&1==r.nodeType;)r=r.lastChild;if(!r||f.isFillChar(r))break;o=r.nodeValue.length}else r=a.startContainer,o=a.startOffset;a.setStart(r,o-1),o=a.toString().charCodeAt(0)}while(160!=o&&32!=o);if(a.toString().replace(RegExp(f.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;a.toString().length&&!/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(a.toString());)try{a.setStart(a.startContainer,a.startOffset+1)}catch(e){for(r=a.startContainer;!(next=r.nextSibling);){if(f.isBody(r))return;r=r.parentNode}a.setStart(next,0)}if(!f.findParentByTagName(a.startContainer,"a",!0)){o=e.document.createElement("a");var s,r=e.document.createTextNode(" ");e.undoManger&&e.undoManger.save(),o.appendChild(a.extractContents()),o.href=o.innerHTML=o.innerHTML.replace(/<[^>]+>/g,""),s=o.getAttribute("href").replace(RegExp(f.fillChar,"g"),""),s=/^(?:https?:\/\/)/gi.test(s)?s:"http://"+s,o.setAttribute("_src",p.html(s)),o.href=p.html(s),a.insertNode(o),o.parentNode.insertBefore(r,o.nextSibling),a.setStart(r,0),a.collapse(!0),i.removeAllRanges(),i.addRange(a),e.undoManger&&e.undoManger.save()}}}})}},UE.plugins.autoheight=function(){function e(){var e=this;clearTimeout(s),l||(s=setTimeout(function(){e.queryCommandState&&1!=e.queryCommandState("source")&&(o||(o=e.document.createElement("span"),o.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",o.innerHTML="."),a=o.cloneNode(!0),e.body.appendChild(a),r=Math.max(f.getXY(a).y+a.offsetHeight,Math.max(c.minFrameHeight,c.initialFrameHeight)),r!=d&&(e.setHeight(r),d=r),f.remove(a))},50))}var t=this;if(t.autoHeightEnabled=!1!==t.options.autoHeightEnabled,t.autoHeightEnabled){var i,o,a,r,s,l,d=0,c=t.options;t.addListener("fullscreenchanged",function(e,t){l=t}),t.addListener("destroy",function(){t.removeListener("contentchange",e),t.removeListener("afterinserthtml",e),t.removeListener("keyup",e),t.removeListener("mouseup",e)}),t.enableAutoHeight=function(){if(t.autoHeightEnabled){var o=t.document;t.autoHeightEnabled=!0,i=o.body.style.overflowY,o.body.style.overflowY="hidden",t.addListener("contentchange",e),t.addListener("afterinserthtml",e),t.addListener("keyup",e),t.addListener("mouseup",e),setTimeout(function(){e.call(this)},n.gecko?100:0),t.fireEvent("autoheightchanged",t.autoHeightEnabled)}},t.disableAutoHeight=function(){t.body.style.overflowY=i||"",t.removeListener("contentchange",e),t.removeListener("keyup",e),t.removeListener("mouseup",e),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.addListener("ready",function(){t.enableAutoHeight();var i;f.on(n.ie?t.body:t.document,n.webkit?"dragover":"drop",function(){clearTimeout(i),i=setTimeout(function(){e.call(this)},100)})})}},UE.plugins.autofloat=function(){function e(){g=!0,h.parentNode&&h.parentNode.removeChild(h),s.style.cssText=r}function t(){var t=d(i.container),o=i.options.toolbarTopOffset||0;if(0>t.top&&t.bottom-s.offsetHeight>o){var t=f.getXY(s),o=f.getComputedStyle(s,"position"),r=f.getComputedStyle(s,"left");s.style.width=s.offsetWidth+"px",s.style.zIndex=1*i.options.zIndex+1,s.parentNode.insertBefore(h,s),u||m&&n.ie?("absolute"!=s.style.position&&(s.style.position="absolute"),s.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-l+a+"px"):(n.ie7Compat&&g&&(g=!1,s.style.left=f.getXY(s).x-document.documentElement.getBoundingClientRect().left+2+"px"),"fixed"!=s.style.position&&(s.style.position="fixed",s.style.top=a+"px",("absolute"==o||"relative"==o)&&parseFloat(r)&&(s.style.left=t.x+"px")))}else e()}var i=this,o=i.getLang();i.setOpt({topOffset:0});var a=i.options.topOffset;if(!1!==i.options.autoFloatEnabled){var r,s,l,d,c=UE.ui.uiUtils,u=n.ie&&6>=n.version,m=n.quirks,h=document.createElement("div"),g=!0,b=p.defer(function(){t()},n.ie?200:100,!0);i.addListener("destroy",function(){f.un(window,["scroll","resize"],t),i.removeListener("keydown",b)}),i.addListener("ready",function(){var n;i.ui?n=1:(alert(o.autofloatMsg),n=0),n&&(d=c.getClientRect,s=i.ui.getDom("toolbarbox"),l=d(s).top,r=s.style.cssText,h.style.height=s.offsetHeight+"px",u&&(n=document.body.style,n.backgroundImage='url("about:blank")',n.backgroundAttachment="fixed"),f.on(window,["scroll","resize"],t),i.addListener("keydown",b),i.addListener("beforefullscreenchange",function(t,n){n&&e()}),i.addListener("fullscreenchanged",function(e,n){n||t()}),i.addListener("sourcemodechanged",function(){setTimeout(function(){t()},0)}),i.addListener("clearDoc",function(){setTimeout(function(){t()},0)}))})}},UE.plugins.pasteplain=function(){this.setOpt({pasteplain:!1,filterTxtRules:function(){function e(e){e.tagName="p",e.setStyle()}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(e){for(var t,n=UE.uNode.createElement("p");t=e.firstChild();)"text"!=t.type&&UE.dom.dtd.$block[t.tagName]?n.firstChild()?(e.parentNode.insertBefore(n,e),n=UE.uNode.createElement("p")):e.parentNode.insertBefore(t,e):n.appendChild(t);n.firstChild()&&e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)},ol:function(e){e.parentNode.removeChild(e,!0)},ul:function(e){e.parentNode.removeChild(e,!0)},dl:function(e){e.parentNode.removeChild(e,!0)},dt:function(e){e.parentNode.removeChild(e,!0)},dd:function(e){e.parentNode.removeChild(e,!0)},li:function(e){e.parentNode.removeChild(e,!0)},caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){e.innerText()&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e),e.parentNode.removeChild(e,e.innerText())}}}()});var e=this.options.pasteplain;this.commands.pasteplain={queryCommandState:function(){return e?1:0},execCommand:function(){e=0|!e},notNeedUndo:1}},UE.plugins.video=function(){function e(e,t,i,o,a,r){return r?'<embed type="application/x-shockwave-flash" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+e+'" width="'+t+'" height="'+i+'"'+(a?' style="float:'+a+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(o?'id="'+o+'"':"")+' width="'+t+'" height="'+i+'" _url="'+e+'" class="edui-faked-video" src="'+n.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+n.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(a?"float:"+a+";":"")+'" />'}function t(t,n){p.each(t.getNodesByTagName(n?"img":"embed"),function(t){if("edui-faked-video"==t.getAttr("class")){var i=e(n?t.getAttr("_url"):t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),null,t.getStyle("float")||"",n);t.parentNode.replaceChild(UE.uNode.createElement(i),t)}})}var n=this;n.addOutputRule(function(e){t(e,!0)}),n.addInputRule(function(e){t(e)}),n.commands.insertvideo={execCommand:function(t,i){i=p.isArray(i)?i:[i];for(var o,a=[],r=0,s=i.length;r<s;r++)o=i[r],a.push(e(o.url,o.width||420,o.height||280,"tmpVedio"+r,null,!1));for(n.execCommand("inserthtml",a.join(""),!0),a=this.selection.getRange(),r=0,s=i.length;r<s;r++)o=this.document.getElementById("tmpVedio"+r),f.removeAttributes(o,"id"),a.selectNode(o).select(),n.execCommand("imagefloat",i[r].align)},queryCommandState:function(){var e=n.selection.getRange().getClosedNode();return e&&"edui-faked-video"==e.className?1:0}}};var G=UE.UETable=function(e){this.table=e,this.indexTable=[],this.selectedTds=[],this.cellsRange={},this.update(e)};G.removeSelectedClass=function(e){p.each(e,function(e){f.removeClasses(e,"selectTdClass")})},G.addSelectedClass=function(e){p.each(e,function(e){f.addClass(e,"selectTdClass")})},G.isEmptyBlock=function(e){var i=RegExp(f.fillChar,"g");if(0<e[n.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(i,"").length)return 0;for(var o in t.$isNotEmpty)if(t.$isNotEmpty.hasOwnProperty(o)&&e.getElementsByTagName(o).length)return 0;return 1},G.getWidth=function(e){return e?parseInt(f.getComputedStyle(e,"width"),10):0},G.getTableCellAlignState=function(e){!p.isArray(e)&&(e=[e]);var t={},n=["align","valign"],i=null,o=!0;return p.each(e,function(e){return p.each(n,function(n){if(i=e.getAttribute(n),!t[n]&&i)t[n]=i;else if(!t[n]||i!==t[n])return o=!1}),o}),o?t:null},G.getTableItemsByRange=function(e){var t=e.selection.getStart(),n=(e=t&&f.findParentByTagName(t,["td","th"],!0))&&e.parentNode,t=t&&f.findParentByTagName(t,"caption",!0);return{cell:e,tr:n,table:t?t.parentNode:n&&n.parentNode.parentNode,caption:t}},G.getUETableBySelected=function(e){return(e=G.getTableItemsByRange(e).table)&&e.ueTable&&e.ueTable.selectedTds.length?e.ueTable:null},G.getDefaultValue=function(e,t){var n,i,o,a={thin:"0px",medium:"1px",thick:"2px"};if(t)r=t.getElementsByTagName("td")[0],o=f.getComputedStyle(t,"border-left-width"),n=parseInt(a[o]||o,10),o=f.getComputedStyle(r,"padding-left"),
i=parseInt(a[o]||o,10),o=f.getComputedStyle(r,"border-left-width"),a=parseInt(a[o]||o,10);else{t=e.document.createElement("table"),t.insertRow(0).insertCell(0).innerHTML="xxx",e.body.appendChild(t);var r=t.getElementsByTagName("td")[0];o=f.getComputedStyle(t,"border-left-width"),n=parseInt(a[o]||o,10),o=f.getComputedStyle(r,"padding-left"),i=parseInt(a[o]||o,10),o=f.getComputedStyle(r,"border-left-width"),a=parseInt(a[o]||o,10),f.remove(t)}return{tableBorder:n,tdPadding:i,tdBorder:a}},G.getUETable=function(e){var t=e.tagName.toLowerCase();return e="td"==t||"th"==t||"caption"==t?f.findParentByTagName(e,"table",!0):e,e.ueTable||(e.ueTable=new G(e)),e.ueTable},G.cloneCell=function(e,t,n){if(!e||p.isString(e))return this.table.ownerDocument.createElement(e||"td");var i=f.hasClass(e,"selectTdClass");i&&f.removeClasses(e,"selectTdClass");var o=e.cloneNode(!0);return t&&(o.rowSpan=o.colSpan=1),o.style.borderLeftStyle="",o.style.borderTopStyle="",o.style.borderLeftColor=e.style.borderRightColor,o.style.borderLeftWidth=e.style.borderRightWidth,o.style.borderTopColor=e.style.borderBottomColor,o.style.borderTopWidth=e.style.borderBottomWidth,i&&f.addClass(e,"selectTdClass"),n&&f.removeAttributes(o,"width height"),o},G.prototype={getMaxRows:function(){for(var e,t=this.table.rows,n=1,i=0;e=t[i];i++){for(var o,a=1,r=0;o=e.cells[r++];)a=Math.max(o.rowSpan||1,a);n=Math.max(a+i,n)}return n},getMaxCols:function(){for(var e,t=this.table.rows,n=0,i={},o=0;e=t[o];o++){for(var a,r=0,s=0;a=e.cells[s++];)if(r+=a.colSpan||1,a.rowSpan&&1<a.rowSpan)for(var l=1;l<a.rowSpan;l++)i["row_"+(o+l)]?i["row_"+(o+l)]++:i["row_"+(o+l)]=a.colSpan||1;r+=i["row_"+o]||0,n=Math.max(r,n)}return n},getCellColIndex:function(){},getHSideCell:function(e,t){try{var n,i,o=this.getCellInfo(e),a=this.selectedTds.length,r=this.cellsRange;return!t&&(a?!r.beginColIndex:!o.colIndex)||t&&(a?r.endColIndex==this.colsNum-1:o.colIndex==this.colsNum-1)?null:(n=a?r.beginRowIndex:o.rowIndex,i=t?a?r.endColIndex+1:o.colIndex+1:a?r.beginColIndex-1:1>o.colIndex?0:o.colIndex-1,this.getCell(this.indexTable[n][i].rowIndex,this.indexTable[n][i].cellIndex))}catch(e){}},getTabNextCell:function(e,t){var n,i=this.getCellInfo(e),o=t||i.rowIndex,i=i.colIndex+1+(i.colSpan-1);try{n=this.getCell(this.indexTable[o][i].rowIndex,this.indexTable[o][i].cellIndex)}catch(e){try{o=1*o+1,i=0,n=this.getCell(this.indexTable[o][i].rowIndex,this.indexTable[o][i].cellIndex)}catch(e){}}return n},getVSideCell:function(e,t,n){try{var i,o,a=this.getCellInfo(e),r=this.selectedTds.length&&!n,s=this.cellsRange;return!t&&0==a.rowIndex||t&&(r?s.endRowIndex==this.rowsNum-1:a.rowIndex+a.rowSpan>this.rowsNum-1)?null:(i=t?r?s.endRowIndex+1:a.rowIndex+a.rowSpan:r?s.beginRowIndex-1:a.rowIndex-1,o=r?s.beginColIndex:a.colIndex,this.getCell(this.indexTable[i][o].rowIndex,this.indexTable[i][o].cellIndex))}catch(e){}},getSameEndPosCells:function(e,t){try{for(var n="x"===t.toLowerCase(),i=f.getXY(e)[n?"x":"y"]+e["offset"+(n?"Width":"Height")],o=this.table.rows,a=null,r=[],s=0;s<this.rowsNum;s++)for(var l,a=o[s].cells,d=0;l=a[d++];){var c=f.getXY(l)[n?"x":"y"]+l["offset"+(n?"Width":"Height")];if(c>i&&n)break;if((e==l||i==c)&&(1==l[n?"colSpan":"rowSpan"]&&r.push(l),n))break}return r}catch(e){}},setCellContent:function(e,t){e.innerHTML=t||(n.ie?f.fillChar:"<br />")},cloneCell:G.cloneCell,getSameStartPosXCells:function(e){try{var t,n=f.getXY(e).x+e.offsetWidth,i=this.table.rows;e=[];for(var o=0;o<this.rowsNum;o++){t=i[o].cells;for(var a,r=0;a=t[r++];){var s=f.getXY(a).x;if(s>n)break;if(s==n&&1==a.colSpan){e.push(a);break}}}return e}catch(e){}},update:function(e){this.table=e||this.table,this.selectedTds=[],this.cellsRange={},this.indexTable=[],e=this.table.rows;for(var t=this.getMaxRows(),n=t-e.length,i=this.getMaxCols();n--;)this.table.insertRow(e.length);this.rowsNum=t,this.colsNum=i;for(var n=0,o=e.length;n<o;n++)this.indexTable[n]=Array(i);for(var a,n=0;a=e[n];n++){var r,o=0;for(a=a.cells;r=a[o];o++){r.rowSpan>t&&(r.rowSpan=t);var s=o,l=r.rowSpan||1;for(r=r.colSpan||1;this.indexTable[n][s];)s++;for(var d=0;d<l;d++)for(var c=0;c<r;c++)this.indexTable[n+d][s+c]={rowIndex:n,cellIndex:o,colIndex:s,rowSpan:l,colSpan:r}}}for(d=0;d<t;d++)for(c=0;c<i;c++)void 0===this.indexTable[d][c]&&(a=e[d],r=(r=a.cells[a.cells.length-1])?r.cloneNode(!0):this.table.ownerDocument.createElement("td"),this.setCellContent(r),1!==r.colSpan&&(r.colSpan=1),1!==r.rowSpan&&(r.rowSpan=1),a.appendChild(r),this.indexTable[d][c]={rowIndex:d,cellIndex:r.cellIndex,colIndex:c,rowSpan:1,colSpan:1});e=f.getElementsByTagName(this.table,"td");var u=[];p.each(e,function(e){f.hasClass(e,"selectTdClass")&&u.push(e)}),u.length&&(t=u[u.length-1],e=this.getCellInfo(u[0]),t=this.getCellInfo(t),this.selectedTds=u,this.cellsRange={beginRowIndex:e.rowIndex,beginColIndex:e.colIndex,endRowIndex:t.rowIndex+t.rowSpan-1,endColIndex:t.colIndex+t.colSpan-1})},getCellInfo:function(e){if(e){var t=e.cellIndex;e=e.parentNode.rowIndex;for(var n=this.indexTable[e],i=this.colsNum,o=t;o<i;o++){var a=n[o];if(a.rowIndex===e&&a.cellIndex===t)return a}}},getCell:function(e,t){return e<this.rowsNum&&this.table.rows[e].cells[t]||null},deleteCell:function(e,t){t="number"==typeof t?t:e.parentNode.rowIndex,this.table.rows[t].deleteCell(e.cellIndex)},getCellsRange:function(e,t){function n(e,t,o,a){var r,s,l,d=e,c=t,u=o,f=a;if(0<e)for(s=t;s<a;s++)r=i.indexTable[e][s],l=r.rowIndex,l<e&&(d=Math.min(l,d));if(a<i.colsNum)for(l=e;l<o;l++)r=i.indexTable[l][a],s=r.colIndex+r.colSpan-1,s>a&&(f=Math.max(s,f));if(o<i.rowsNum)for(s=t;s<a;s++)r=i.indexTable[o][s],l=r.rowIndex+r.rowSpan-1,l>o&&(u=Math.max(l,u));if(0<t)for(l=e;l<o;l++)r=i.indexTable[l][t],s=r.colIndex,s<t&&(c=Math.min(r.colIndex,c));return d!=e||c!=t||u!=o||f!=a?n(d,c,u,f):{beginRowIndex:e,beginColIndex:t,endRowIndex:o,endColIndex:a}}try{var i=this,o=i.getCellInfo(e);if(e===t)return{beginRowIndex:o.rowIndex,beginColIndex:o.colIndex,endRowIndex:o.rowIndex+o.rowSpan-1,endColIndex:o.colIndex+o.colSpan-1};var a=i.getCellInfo(t),r=Math.min(o.rowIndex,a.rowIndex),s=Math.min(o.colIndex,a.colIndex),l=Math.max(o.rowIndex+o.rowSpan-1,a.rowIndex+a.rowSpan-1),d=Math.max(o.colIndex+o.colSpan-1,a.colIndex+a.colSpan-1);return n(r,s,l,d)}catch(e){if(debug)throw e}},getCells:function(e){this.clearSelected();for(var t,n,i=e.beginColIndex,o=e.endRowIndex,a=e.endColIndex,r={},s=[],l=e.beginRowIndex;l<=o;l++)for(var d=i;d<=a;d++){e=this.indexTable[l][d],t=e.rowIndex,n=e.colIndex;var c=t+"|"+n;if(!r[c]){if(r[c]=1,t<l||n<d||t+e.rowSpan-1>o||n+e.colSpan-1>a)return null;s.push(this.getCell(t,e.cellIndex))}}return s},clearSelected:function(){G.removeSelectedClass(this.selectedTds),this.selectedTds=[],this.cellsRange={}},setSelected:function(e){var t=this.getCells(e);G.addSelectedClass(t),this.selectedTds=t,this.cellsRange=e},isFullRow:function(){var e=this.cellsRange;return e.endColIndex-e.beginColIndex+1==this.colsNum},isFullCol:function(){var e=this.cellsRange,t=this.table.getElementsByTagName("th"),e=e.endRowIndex-e.beginRowIndex+1;return t.length?e==this.rowsNum||e==this.rowsNum-1:e==this.rowsNum},getNextCell:function(e,t,n){try{var i,o,a=this.getCellInfo(e),r=this.selectedTds.length&&!n,s=this.cellsRange;return!t&&0==a.rowIndex||t&&(r?s.endRowIndex==this.rowsNum-1:a.rowIndex+a.rowSpan>this.rowsNum-1)?null:(i=t?r?s.endRowIndex+1:a.rowIndex+a.rowSpan:r?s.beginRowIndex-1:a.rowIndex-1,o=r?s.beginColIndex:a.colIndex,this.getCell(this.indexTable[i][o].rowIndex,this.indexTable[i][o].cellIndex))}catch(e){}},getPreviewCell:function(e,t){try{var n,i,o=this.getCellInfo(e),a=this.selectedTds.length,r=this.cellsRange;return!t&&(a?!r.beginColIndex:!o.colIndex)||t&&(a?r.endColIndex==this.colsNum-1:o.rowIndex>this.colsNum-1)?null:(n=t?a?r.beginRowIndex:1>o.rowIndex?0:o.rowIndex-1:a?r.beginRowIndex:o.rowIndex,i=t?a?r.endColIndex+1:o.colIndex:a?r.beginColIndex-1:1>o.colIndex?0:o.colIndex-1,this.getCell(this.indexTable[n][i].rowIndex,this.indexTable[n][i].cellIndex))}catch(e){}},moveContent:function(e,n){if(!G.isEmptyBlock(n))if(G.isEmptyBlock(e))e.innerHTML=n.innerHTML;else{var i=e.lastChild;for((3==i.nodeType||!t.$block[i.tagName])&&e.appendChild(e.ownerDocument.createElement("br"));i=n.firstChild;)e.appendChild(i)}},mergeRight:function(e){var t=this.getCellInfo(e),n=this.indexTable[t.rowIndex][t.colIndex+t.colSpan],i=this.getCell(n.rowIndex,n.cellIndex);e.colSpan=t.colSpan+n.colSpan,e.removeAttribute("width"),this.moveContent(e,i),this.deleteCell(i,n.rowIndex),this.update()},mergeDown:function(e){var t=this.getCellInfo(e),n=this.indexTable[t.rowIndex+t.rowSpan][t.colIndex],i=this.getCell(n.rowIndex,n.cellIndex);e.rowSpan=t.rowSpan+n.rowSpan,e.removeAttribute("height"),this.moveContent(e,i),this.deleteCell(i,n.rowIndex),this.update()},mergeRange:function(){var e=this.cellsRange,t=this.getCell(e.beginRowIndex,this.indexTable[e.beginRowIndex][e.beginColIndex].cellIndex);if("TH"==t.tagName&&e.endRowIndex!==e.beginRowIndex)var n=this.indexTable,e=this.getCellInfo(t),t=this.getCell(1,n[1][e.colIndex].cellIndex),e=this.getCellsRange(t,this.getCell(n[this.rowsNum-1][e.colIndex].rowIndex,n[this.rowsNum-1][e.colIndex].cellIndex));for(var i,o=this.getCells(e),n=0;i=o[n++];)i!==t&&(this.moveContent(t,i),this.deleteCell(i));if(t.rowSpan=e.endRowIndex-e.beginRowIndex+1,1<t.rowSpan&&t.removeAttribute("height"),t.colSpan=e.endColIndex-e.beginColIndex+1,1<t.colSpan&&t.removeAttribute("width"),t.rowSpan==this.rowsNum&&1!=t.colSpan&&(t.colSpan=1),t.colSpan==this.colsNum&&1!=t.rowSpan){if(o=t.parentNode.rowIndex,this.table.deleteRow)for(n=o+1,o+=1,e=t.rowSpan;n<e;n++)this.table.deleteRow(o);else for(n=0,e=t.rowSpan-1;n<e;n++)i=this.table.rows[o+1],i.parentNode.removeChild(i);t.rowSpan=1}this.update()},insertRow:function(e,t){var n=this.colsNum,i=this.table,o=i.insertRow(e);if(parseInt((i.offsetWidth-20*n-n-1)/n,10),0==e||e==this.rowsNum)for(var a=0;a<n;a++)i=this.cloneCell(t,!0,!0),this.setCellContent(i),i.getAttribute("vAlign")&&i.setAttribute("vAlign",i.getAttribute("vAlign")),o.appendChild(i);else for(var r=this.indexTable[e],a=0;a<n;a++){var s=r[a];s.rowIndex<e?(i=this.getCell(s.rowIndex,s.cellIndex),i.rowSpan=s.rowSpan+1):(i=this.cloneCell(t,!0,!0),this.setCellContent(i),o.appendChild(i))}return this.update(),o},deleteRow:function(e){for(var t=this.table.rows[e],n=this.indexTable[e],i=this.colsNum,o=0,a=0;a<i;){var r=n[a],s=this.getCell(r.rowIndex,r.cellIndex);if(1<s.rowSpan&&r.rowIndex==e){r=s.cloneNode(!0),r.rowSpan=s.rowSpan-1,r.innerHTML="",s.rowSpan=1;var l=e+1,d=this.table.rows[l],l=this.getPreviewMergedCellsNum(l,a)-o;l<a?(l=a-l-1,f.insertAfter(d.cells[l],r)):d.cells.length&&d.insertBefore(r,d.cells[0]),o+=1}a+=s.colSpan||1}for(e=[],o={},a=0;a<i;a++)s=n[a].rowIndex,r=n[a].cellIndex,d=s+"_"+r,o[d]||(o[d]=1,s=this.getCell(s,r),e.push(s));var c=[];p.each(e,function(e){1==e.rowSpan?e.parentNode.removeChild(e):c.push(e)}),p.each(c,function(e){e.rowSpan--}),t.parentNode.removeChild(t),this.update()},insertCol:function(e,t,n){function i(e,t,n){0==e?(e=t.nextSibling||t.previousSibling,"TH"==e.tagName&&(e=t.ownerDocument.createElement("th"),e.appendChild(t.firstChild),n.insertBefore(e,t),f.remove(t))):"TH"==t.tagName&&(e=t.ownerDocument.createElement("td"),e.appendChild(t.firstChild),n.insertBefore(e,t),f.remove(t))}var o,a,r,s=this.rowsNum,l=0,d=parseInt((this.table.offsetWidth-20*(this.colsNum+1)-(this.colsNum+1))/(this.colsNum+1),10);if(0==e||e==this.colsNum)for(;l<s;l++)o=this.table.rows[l],r=o.cells[0==e?e:o.cells.length],a=this.cloneCell(t,!0),this.setCellContent(a),a.setAttribute("vAlign",a.getAttribute("vAlign")),r&&a.setAttribute("width",r.getAttribute("width")),e?f.insertAfter(o.cells[o.cells.length-1],a):o.insertBefore(a,o.cells[0]),i(l,a,o);else for(;l<s;l++)r=this.indexTable[l][e],r.colIndex<e?(a=this.getCell(r.rowIndex,r.cellIndex),a.colSpan=r.colSpan+1):(o=this.table.rows[l],r=o.cells[r.cellIndex],a=this.cloneCell(t,!0),this.setCellContent(a),a.setAttribute("vAlign",a.getAttribute("vAlign")),r&&a.setAttribute("width",r.getAttribute("width")),o.insertBefore(a,r)),i(l,a,o);this.update(),this.updateWidth(d,n||{tdPadding:10,tdBorder:1})},updateWidth:function(e,t){var n=this.table,i=G.getWidth(n)-2*t.tdPadding-t.tdBorder+e;i<n.ownerDocument.body.offsetWidth?n.setAttribute("width",i):(n=f.getElementsByTagName(this.table,"td"),p.each(n,function(t){t.setAttribute("width",e)}))},deleteCol:function(e){for(var t=this.indexTable,n=this.table.rows,i=this.table.getAttribute("width"),o=0,a=this.rowsNum,r={},s=0;s<a;){var l=t[s][e],d=l.rowIndex+"_"+l.colIndex;r[d]||(r[d]=1,d=this.getCell(l.rowIndex,l.cellIndex),o||(o=d&&parseInt(d.offsetWidth/d.colSpan,10).toFixed(0)),1<d.colSpan?d.colSpan--:n[s].deleteCell(l.cellIndex),s+=l.rowSpan||1)}this.table.setAttribute("width",i-o),this.update()},splitToCells:function(e){var t=this;e=this.splitToRows(e),p.each(e,function(e){t.splitToCols(e)})},splitToRows:function(e){var t=this.getCellInfo(e),n=t.rowIndex,i=t.colIndex,o=[];e.rowSpan=1,o.push(e);for(var a=n,r=n+t.rowSpan;a<r;a++)if(a!=n){var s=this.table.rows[a].insertCell(i-this.getPreviewMergedCellsNum(a,i));s.colSpan=t.colSpan,this.setCellContent(s),s.setAttribute("vAlign",e.getAttribute("vAlign")),s.setAttribute("align",e.getAttribute("align")),e.style.cssText&&(s.style.cssText=e.style.cssText),o.push(s)}return this.update(),o},getPreviewMergedCellsNum:function(e,t){for(var n=this.indexTable[e],i=0,o=0;o<t;)var a=n[o].colSpan,i=i+(a-(n[o].rowIndex==e?1:0)),o=o+a;return i},splitToCols:function(e){var t=(e.offsetWidth/e.colSpan-22).toFixed(0),n=this.getCellInfo(e),i=n.rowIndex,o=n.colIndex,a=[];e.colSpan=1,e.setAttribute("width",t),a.push(e);for(var r=o,s=o+n.colSpan;r<s;r++)if(r!=o){var l=this.table.rows[i],d=l.insertCell(this.indexTable[i][r].cellIndex+1);if(d.rowSpan=n.rowSpan,this.setCellContent(d),d.setAttribute("vAlign",e.getAttribute("vAlign")),d.setAttribute("align",e.getAttribute("align")),d.setAttribute("width",t),e.style.cssText&&(d.style.cssText=e.style.cssText),"TH"==e.tagName){var c=e.ownerDocument.createElement("th");c.appendChild(d.firstChild),c.setAttribute("vAlign",e.getAttribute("vAlign")),c.rowSpan=d.rowSpan,l.insertBefore(c,d),f.remove(d)}a.push(d)}return this.update(),a},isLastCell:function(e,t,n){return t=t||this.rowsNum,n=n||this.colsNum,e=this.getCellInfo(e),e.rowIndex+e.rowSpan==t&&e.colIndex+e.colSpan==n},getLastCell:function(e){e=e||this.table.getElementsByTagName("td"),this.getCellInfo(e[0]);var t,n=this,i=e[0],o=i.parentNode,a=0,r=0;return p.each(e,function(e){e.parentNode==o&&(r+=e.colSpan||1),a+=e.rowSpan*e.colSpan||1}),t=a/r,p.each(e,function(e){if(n.isLastCell(e,t,r))return i=e,!1}),i},selectRow:function(e){var t=this.indexTable[e];e=this.getCell(t[0].rowIndex,t[0].cellIndex),t=this.getCell(t[this.colsNum-1].rowIndex,t[this.colsNum-1].cellIndex),e=this.getCellsRange(e,t),this.setSelected(e)},selectTable:function(){var e=this.table.getElementsByTagName("td"),e=this.getCellsRange(e[0],e[e.length-1]);this.setSelected(e)},sortTable:function(e,t){var n=this.table,i=n.rows,o=[],a="TH"===i[0].cells[0].tagName,r=0;if(this.selectedTds.length){for(var s=this.cellsRange,l=s.endRowIndex+1,d=s.beginRowIndex;d<l;d++)o[d]=i[d];o.splice(0,s.beginRowIndex),r=s.endRowIndex+1===this.rowsNum?0:s.endRowIndex+1}else for(d=0,l=i.length;d<l;d++)o[d]=i[d];for(a&&o.splice(0,1),o=p.sort(o,function(n,i){return t?"number"==typeof t?t:t.call(this,n.cells[e],i.cells[e]):(n.cells[e].innerText||n.cells[e].textContent).localeCompare(i.cells[e].innerText||i.cells[e].textContent)}),a=n.ownerDocument.createDocumentFragment(),d=0,l=o.length;d<l;d++)a.appendChild(o[d]);n=n.getElementsByTagName("tbody")[0],r?n.insertBefore(a,i[r-s.endRowIndex+s.beginRowIndex-1]):n.appendChild(a)},setBackground:function(e,t){if("string"==typeof t)p.each(e,function(e){e.style.backgroundColor=t});else if("object"==typeof t){t=p.extend({repeat:!0,colorList:["#ddd","#fff"]},t);for(var n,i=this.getCellInfo(e[0]).rowIndex,o=0,a=t.colorList,r=0;n=e[r++];){var s=this.getCellInfo(n);n=n.style,s=i+o==s.rowIndex?o:++o,n.backgroundColor=a[s]?a[s]:t.repeat?a[s%a.length]:""}}},removeBackground:function(e){p.each(e,function(e){e.style.backgroundColor=""})}};var Kb=function(e,t,n){var i=e.body;return i.offsetWidth-(t?2*parseInt(f.getComputedStyle(i,"margin-left"),10):0)-2*n.tableBorder-(e.options.offsetWidth||0)},P=function(e){if(e=w(e).cell){var t=F(e);return t.selectedTds.length?t.selectedTds:[e]}return[]},O=UE.UETable,w=function(e){return O.getTableItemsByRange(e)},F=function(e){return O.getUETable(e)};UE.commands.inserttable={queryCommandState:function(){return w(this).table?-1:0},execCommand:function(e,t){t||(t=p.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));var i=this.selection.getRange().startContainer,o=f.findParent(i,function(e){return f.isBlockElm(e)},!0),i=O.getDefaultValue(this,void 0),o=Kb(this,!0,i)-(o?parseInt(f.getXY(o).x,10):0),i=Math.floor(o/t.numCols-2*i.tdPadding-i.tdBorder);!t.tdvalign&&(t.tdvalign=this.options.tdvalign),this.execCommand("inserthtml",function(e,t,i){for(var o=[],a=e.numRows,r=e.numCols,s=0;s<a;s++){o.push("<tr>");for(var l=0;l<r;l++)o.push('<td width="'+i+'"  vAlign="'+e.tdvalign+'" >'+(n.ie?f.fillChar:"<br/>")+"</td>");o.push("</tr>")}return'<table width="'+t+'"   ><tbody>'+o.join("")+"</tbody></table>"}(t,o,i))}},UE.commands.insertparagraphbeforetable={queryCommandState:function(){return w(this).cell?0:-1},execCommand:function(){var e=w(this).table;if(e){var t=this.document.createElement("p");t.innerHTML=n.ie?"&nbsp;":"<br />",e.parentNode.insertBefore(t,e),this.selection.getRange().setStart(t,0).setCursor()}}},UE.commands.deletetable={queryCommandState:function(){var e=this.selection.getRange();return f.findParentByTagName(e.startContainer,"table",!0)?0:-1},execCommand:function(e,t){var i=this.selection.getRange();if(t=t||f.findParentByTagName(i.startContainer,"table",!0)){var o=t.nextSibling;o||(o=f.createElement(this.document,"p",{innerHTML:n.ie?f.fillChar:"<br/>"}),t.parentNode.insertBefore(o,t)),f.remove(t),i=this.selection.getRange(),3==o.nodeType?i.setStartBefore(o):i.setStart(o,0),i.setCursor(!1,!0),this.fireEvent("tablehasdeleted")}}},UE.commands.cellalign={queryCommandState:function(){return P(this).length?0:-1},execCommand:function(e,t){var n=P(this);if(n.length)for(var i,o=0;i=n[o++];)i.setAttribute("align",t)}},UE.commands.cellvalign={queryCommandState:function(){return P(this).length?0:-1},execCommand:function(e,t){var n=P(this);if(n.length)for(var i,o=0;i=n[o++];)i.setAttribute("vAlign",t)}},UE.commands.insertcaption={queryCommandState:function(){var e=w(this).table;return e&&0==e.getElementsByTagName("caption").length?1:-1},execCommand:function(){var e=w(this).table;if(e){var t=this.document.createElement("caption");t.innerHTML=n.ie?f.fillChar:"<br/>",e.insertBefore(t,e.firstChild),this.selection.getRange().setStart(t,0).setCursor()}}},UE.commands.deletecaption={queryCommandState:function(){var e=this.selection.getRange();return(e=f.findParentByTagName(e.startContainer,"table"))?0==e.getElementsByTagName("caption").length?-1:1:-1},execCommand:function(){var e=this.selection.getRange();(e=f.findParentByTagName(e.startContainer,"table"))&&(f.remove(e.getElementsByTagName("caption")[0]),this.selection.getRange().setStart(e.rows[0].cells[0],0).setCursor())}},UE.commands.inserttitle={queryCommandState:function(){var e=w(this).table;return e&&0==e.rows[0].getElementsByTagName("th").length?0:-1},execCommand:function(){var e=w(this).table;e&&F(e).insertRow(0,"th"),e=e.getElementsByTagName("th")[0],this.selection.getRange().setStart(e,0).setCursor(!1,!0)}},UE.commands.deletetitle={queryCommandState:function(){var e=w(this).table;return e&&e.rows[0].getElementsByTagName("th").length?0:-1},execCommand:function(){var e=w(this).table;e&&f.remove(e.rows[0]),e=e.getElementsByTagName("td")[0],this.selection.getRange().setStart(e,0).setCursor(!1,!0)}},UE.commands.mergeright={queryCommandState:function(){var e=w(this);if(!e.cell)return-1;var t=F(e.table);if(t.selectedTds.length)return-1;var e=t.getCellInfo(e.cell),n=e.colIndex+e.colSpan;return n>=t.colsNum?-1:(t=t.indexTable[e.rowIndex][n],t.rowIndex==e.rowIndex&&t.rowSpan==e.rowSpan?0:-1)},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this).cell;F(n).mergeRight(n),e.moveToBookmark(t).select()}},UE.commands.mergedown={queryCommandState:function(){var e=w(this),t=e.cell;if(!t||"TH"==t.tagName)return-1;var n=F(e.table);if(n.selectedTds.length)return-1;var t=n.getCellInfo(e.cell),i=t.rowIndex+t.rowSpan;return i>=n.rowsNum?-1:(n=n.indexTable[i][t.colIndex],n.colIndex==t.colIndex&&n.colSpan==t.colSpan&&"TH"!==e.cell.tagName?0:-1)},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this).cell;F(n).mergeDown(n),e.moveToBookmark(t).select()}},UE.commands.mergecells={queryCommandState:function(){return O.getUETableBySelected(this)?0:-1},execCommand:function(){var e=O.getUETableBySelected(this);if(e&&e.selectedTds.length){var t=e.selectedTds[0];e.mergeRange(),e=this.selection.getRange(),f.isEmptyBlock(t)?e.setStart(t,0).collapse(!0):e.selectNodeContents(t),e.select()}}},UE.commands.insertrow={queryCommandState:function(){var e=w(this),t=e.cell;return t&&"TD"==t.tagName&&F(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this),i=n.cell,n=n.table,o=F(n),a=o.getCellInfo(i);if(o.selectedTds.length)for(var a=o.cellsRange,r=0,s=a.endRowIndex-a.beginRowIndex+1;r<s;r++)o.insertRow(a.beginRowIndex,i);else o.insertRow(a.rowIndex,i);e.moveToBookmark(t).select(),"enabled"===n.getAttribute("interlaced")&&this.fireEvent("interlacetable",n)}},UE.commands.insertrownext={queryCommandState:function(){var e=w(this),t=e.cell;return t&&"TD"==t.tagName&&F(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this),i=n.cell,n=n.table,o=F(n),a=o.getCellInfo(i);if(o.selectedTds.length)for(var a=o.cellsRange,r=0,s=a.endRowIndex-a.beginRowIndex+1;r<s;r++)o.insertRow(a.endRowIndex+1,i);else o.insertRow(a.rowIndex+a.rowSpan,i);e.moveToBookmark(t).select(),"enabled"===n.getAttribute("interlaced")&&this.fireEvent("interlacetable",n)}},UE.commands.deleterow={queryCommandState:function(){if(!w(this).cell)return-1},execCommand:function(){var e=w(this).cell,t=F(e),n=t.cellsRange,i=t.getCellInfo(e),o=t.getVSideCell(e),a=t.getVSideCell(e,!0),e=this.selection.getRange();if(p.isEmptyObject(n))t.deleteRow(i.rowIndex);else for(var r=n.beginRowIndex;r<n.endRowIndex+1;r++)t.deleteRow(n.beginRowIndex);r=t.table,r.getElementsByTagName("td").length?1==i.rowSpan||i.rowSpan==n.endRowIndex-n.beginRowIndex+1?(a||o)&&e.selectNodeContents(a||o).setCursor(!1,!0):(t=t.getCell(i.rowIndex,t.indexTable[i.rowIndex][i.colIndex].cellIndex))&&e.selectNodeContents(t).setCursor(!1,!0):(t=r.nextSibling,f.remove(r),t&&e.setStart(t,0).setCursor(!1,!0)),"enabled"===r.getAttribute("interlaced")&&this.fireEvent("interlacetable",r)}},UE.commands.insertcol={queryCommandState:function(){var e=w(this),t=e.cell;return t&&("TD"==t.tagName||"TH"==t.tagName)&&F(e.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(e){var t=this.selection.getRange(),n=t.createBookmark(!0);if(-1!=this.queryCommandState(e)){e=w(this).cell;var i=F(e),o=i.getCellInfo(e);if(i.selectedTds.length)for(var o=i.cellsRange,a=0,r=o.endColIndex-o.beginColIndex+1;a<r;a++)i.insertCol(o.beginColIndex,e);else i.insertCol(o.colIndex,e);t.moveToBookmark(n).select(!0)}}},UE.commands.insertcolnext={queryCommandState:function(){var e=w(this);return e.cell&&F(e.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this).cell,i=F(n),o=i.getCellInfo(n);if(i.selectedTds.length)for(var o=i.cellsRange,a=0,r=o.endColIndex-o.beginColIndex+1;a<r;a++)i.insertCol(o.endColIndex+1,n);else i.insertCol(o.colIndex+o.colSpan,n);e.moveToBookmark(t).select()}},UE.commands.deletecol={queryCommandState:function(){if(!w(this).cell)return-1},execCommand:function(){var e=w(this).cell,t=F(e),n=t.cellsRange,i=t.getCellInfo(e),o=t.getHSideCell(e),a=t.getHSideCell(e,!0);if(p.isEmptyObject(n))t.deleteCol(i.colIndex);else for(i=n.beginColIndex;i<n.endColIndex+1;i++)t.deleteCol(n.beginColIndex);t=t.table,n=this.selection.getRange(),t.getElementsByTagName("td").length?f.inDoc(e,this.document)?n.setStart(e,0).setCursor(!1,!0):a&&f.inDoc(a,this.document)?n.selectNodeContents(a).setCursor(!1,!0):o&&f.inDoc(o,this.document)&&n.selectNodeContents(o).setCursor(!0,!0):(e=t.nextSibling,f.remove(t),e&&n.setStart(e,0).setCursor(!1,!0))}},UE.commands.splittocells={queryCommandState:function(){var e=w(this),t=e.cell;return!t||0<F(e.table).selectedTds.length?-1:t&&(1<t.colSpan||1<t.rowSpan)?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this).cell;F(n).splitToCells(n),e.moveToBookmark(t).select()}},UE.commands.splittorows={queryCommandState:function(){var e=w(this),t=e.cell;return!t||0<F(e.table).selectedTds.length?-1:t&&1<t.rowSpan?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this).cell;F(n).splitToRows(n),e.moveToBookmark(t).select()}},UE.commands.splittocols={queryCommandState:function(){var e=w(this),t=e.cell;return!t||0<F(e.table).selectedTds.length?-1:t&&1<t.colSpan?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),n=w(this).cell;F(n).splitToCols(n),e.moveToBookmark(t).select()}},UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return w(this).table?0:-1},execCommand:function(e){var t=w(this).table;if(t)if("adaptbywindow"==e){var n=t.getElementsByTagName("td");p.each(n,function(e){e.removeAttribute("width")}),t.setAttribute("width",Kb(this,!0,O.getDefaultValue(this,t))),setTimeout(function(){p.each(n,function(e){1==e.colSpan&&e.setAttribute("width",e.offsetWidth+"")})},0)}else e=f.getElementsByTagName(t,"td th"),p.each(e,function(e){e.removeAttribute("width")}),t.removeAttribute("width")}},UE.commands.averagedistributecol={queryCommandState:function(){var e=O.getUETableBySelected(this);return e&&(e.isFullRow()||e.isFullCol())?0:-1},execCommand:function(){var e=O.getUETableBySelected(this);if(e&&e.selectedTds.length){var t=e.table,n=0,i=0,o=O.getDefaultValue(this,t);if(e.isFullRow())n=t.offsetWidth,i=e.colsNum;else for(var a,t=e.cellsRange.endColIndex,r=e.cellsRange.beginColIndex;r<=t;)a=e.selectedTds[r],n+=a.offsetWidth,r+=a.colSpan,i+=1;var s=Math.ceil(n/i)-2*o.tdBorder-2*o.tdPadding;p.each(f.getElementsByTagName(e.table,"th"),function(e){e.setAttribute("width","")}),e=e.isFullRow()?f.getElementsByTagName(e.table,"td"):e.selectedTds,p.each(e,function(e){1==e.colSpan&&e.setAttribute("width",s)})}}},UE.commands.averagedistributerow={queryCommandState:function(){var e=O.getUETableBySelected(this);return!e||e.selectedTds&&/th/gi.test(e.selectedTds[0].tagName)?-1:e.isFullRow()||e.isFullCol()?0:-1},execCommand:function(){var e=O.getUETableBySelected(this);if(e&&e.selectedTds.length){var t,i=0;t=e.table;var o=O.getDefaultValue(this,t),a=parseInt(f.getComputedStyle(t.getElementsByTagName("td")[0],"padding-top"));if(e.isFullCol()){var r,s,i=f.getElementsByTagName(t,"caption"),l=f.getElementsByTagName(t,"th");0<i.length&&(r=i[0].offsetHeight),0<l.length&&(s=l[0].offsetHeight),i=t.offsetHeight-(r||0)-(s||0),t=0==l.length?e.rowsNum:e.rowsNum-1}else{for(s=e.cellsRange.beginRowIndex,l=e.cellsRange.endRowIndex,r=0,t=f.getElementsByTagName(t,"tr");s<=l;s++)i+=t[s].offsetHeight,r+=1;t=r}var d=n.ie&&9>n.version?Math.ceil(i/t):Math.ceil(i/t)-2*o.tdBorder-2*a,e=e.isFullCol()?f.getElementsByTagName(e.table,"td"):e.selectedTds;p.each(e,function(e){1==e.rowSpan&&e.setAttribute("height",d)})}}},UE.commands.cellalignment={queryCommandState:function(){return w(this).table?0:-1},execCommand:function(e,t){var n=O.getUETableBySelected(this);n?p.each(n.selectedTds,function(e){f.setAttributes(e,t)}):(n=(n=this.selection.getStart())&&f.findParentByTagName(n,["td","th","caption"],!0),/caption/gi.test(n.tagName)?(n.style.textAlign=t.align,n.style.verticalAlign=t.vAlign):f.setAttributes(n,t),this.selection.getRange().setCursor(!0))},queryCommandValue:function(){var e=w(this).cell;if(e||(e=P(this)[0]),e){var t=UE.UETable.getUETable(e).selectedTds;return!t.length&&(t=e),UE.UETable.getTableCellAlignState(t)}return null}},UE.commands.tablealignment={queryCommandState:function(){return n.ie&&8>n.version?-1:w(this).table?0:-1},execCommand:function(e,t){var n=this.selection.getStart();(n=n&&f.findParentByTagName(n,["table"],!0))&&n.setAttribute("align",t)}},UE.commands.edittable={queryCommandState:function(){return w(this).table?0:-1},execCommand:function(e,t){var n=this.selection.getRange();(n=f.findParentByTagName(n.startContainer,"table"))&&(n=f.getElementsByTagName(n,"td").concat(f.getElementsByTagName(n,"th"),f.getElementsByTagName(n,"caption")),p.each(n,function(e){e.style.borderColor=t}))}},UE.commands.edittd={queryCommandState:function(){return w(this).table?0:-1},execCommand:function(e,t){var n=O.getUETableBySelected(this);n?p.each(n.selectedTds,function(e){e.style.backgroundColor=t}):(n=(n=this.selection.getStart())&&f.findParentByTagName(n,["td","th","caption"],!0))&&(n.style.backgroundColor=t)}},UE.commands.sorttable={queryCommandState:function(){var e=w(this);if(!e.cell)return-1;for(var t,e=e.table.getElementsByTagName("td"),n=0;t=e[n++];)if(1!=t.rowSpan||1!=t.colSpan)return-1;return 0},execCommand:function(e,t){var n=this.selection.getRange(),i=n.createBookmark(!0),o=w(this),a=o.cell,o=F(o.table),a=o.getCellInfo(a);o.sortTable(a.cellIndex,t),n.moveToBookmark(i).select()}},UE.commands.enablesort=UE.commands.disablesort={queryCommandState:function(){return w(this).table?0:-1},execCommand:function(e){w(this).table.setAttribute("data-sort","enablesort"==e?"sortEnabled":"sortDisabled")}},UE.commands.settablebackground={queryCommandState:function(){var e=P(this);return e.length&&"td"===e[0].tagName.toLowerCase()?0:-1},execCommand:function(e,t){var n;n=P(this),F(n[0]).setBackground(n,t)}},UE.commands.cleartablebackground={queryCommandState:function(){var e=P(this);if(!e.length)return-1;for(var t,n=0;t=e[n++];)if(""!==t.style.backgroundColor)return 0;return-1},execCommand:function(){var e=P(this);F(e[0]).removeBackground(e)}},UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(e){var t=w(this).table;return t?(t=t.getAttribute("interlaced"),"interlacetable"==e?"enabled"===t?-1:0:t&&"disabled"!==t?0:-1):-1},execCommand:function(e,t){var n=w(this).table;"interlacetable"==e?(n.setAttribute("interlaced","enabled"),this.fireEvent("interlacetable",n,t)):(n.setAttribute("interlaced","disabled"),this.fireEvent("uninterlacetable",n))}},UE.plugins.table=function(){function e(e,t,n){e.style[t]&&(n&&e.setAttribute(t,parseInt(e.style[t],10)),e.style[t]="")}function i(e){if("TD"==e.tagName||"TH"==e.tagName)return e;var t;return(t=f.findParentByTagName(e,"td",!0)||f.findParentByTagName(e,"th",!0))?t:null}function o(e){var i=RegExp(f.fillChar,"g");if(0<e[n.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(i,"").length)return 0;for(var o in t.$isNotEmpty)if(e.getElementsByTagName(o).length)return 0;return 1}function a(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+w.document.body.scrollLeft-w.document.body.clientLeft,y:e.clientY+w.document.body.scrollTop-w.document.body.clientTop}}function r(e){try{var t,o=i(e.target||e.srcElement);if(L&&O){if(w.document.body.style.webkitUserSelect="none",w.selection.getNative()[n.ie?"empty":"removeAllRanges"](),t=a(e),d(w,!0,"",t,o),"h"==L){var r,u=M.style,o=O,m=S(o);if(m){var h=m.getSameEndPosCells(o,"x")[0],p=m.getSameStartPosXCells(o)[0],g=a(e).x,b=(h?f.getXY(h).x:f.getXY(m.table).x)+20,v=p?f.getXY(p).x+p.offsetWidth-20:w.body.offsetWidth+5||parseInt(f.getComputedStyle(w.body,"width"),10);r=g<b?b:g>v?v:g}else r=void 0;u.left=r+"px"}else if("v"==L){
var y,C=M.style;e:{try{var N=f.getXY(O).y,x=a(e).y;y=x<N?N:x;break e}catch(e){if(E)throw e}y=void 0}C.top=y+"px"}}else if(o){if(!0!==w.fireEvent("excludetable",o)){t=a(e);var T=c(o,t),k=f.findParentByTagName(o,"table",!0);l(k,o,e,!0)?!0!==w.fireEvent("excludetable",k)&&(w.body.style.cursor="url("+w.options.cursorpath+"h.png),pointer"):l(k,o,e)?!0!==w.fireEvent("excludetable",k)&&(w.body.style.cursor="url("+w.options.cursorpath+"v.png),pointer"):(w.body.style.cursor="text",/\d/.test(T)&&(T=T.replace(/\d/,""),o=S(o).getPreviewCell(o,"v"==T)),d(w,!!o&&!!T,o?T:"",t,o))}}else s(!1,k,w)}catch(e){if(E)throw e}}function s(e,t,n){if(e){e=f.getXY(t);var i=t.ownerDocument;if(!A||!A.parentNode){A=i.createElement("div"),A.contentEditable=!1,A.innerHTML="",A.style.cssText="width:15px;height:15px;background-image:url("+n.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(e.y-15)+"px;left:"+e.x+"px;",f.unSelectable(A),A.onmouseover=function(){D=!0},A.onmouseout=function(){D=!1},f.on(A,"click",function(){var e=this;clearTimeout(o),o=setTimeout(function(){n.fireEvent("tableClicked",t,e)},300)}),f.on(A,"dblclick",function(){clearTimeout(o);var e=S(t),i=t.rows[0].cells[0],a=e.getLastCell(),a=e.getCellsRange(i,a);n.selection.getRange().setStart(i,0).setCursor(!1,!0),e.setSelected(a)}),f.on(A,"dragstart",function(e,t){f.preventDefault(t)});var o;i.body.appendChild(A)}}else D||setTimeout(function(){!D&&A&&A.parentNode&&A.parentNode.removeChild(A)},2e3)}function l(e,t,n,i){return n=a(n),t=c(t,n),i?(i=(i=e.getElementsByTagName("caption")[0])?i.offsetHeight:0,"v1"==t&&8>n.y-f.getXY(e).y-i):"h1"==t&&8>n.x-f.getXY(e).x}function d(e,t,i,o,a){try{e.body.style.cursor="h"==i?"col-resize":"v"==i?"row-resize":"text",n.ie&&(!i||U||T.getUETableBySelected(e)?v(e):(b(e,e.document),y(i,a))),_=t}catch(e){if(E)throw e}}function c(e,t){var n=f.getXY(e);return 4>n.x+e.offsetWidth-t.x?"h":4>t.x-n.x?"h1":4>n.y+e.offsetHeight-t.y?"v":4>t.y-n.y?"v1":""}function u(e,t){if(2==t.button){var i=T.getUETableBySelected(w),o=!1;if(i){var r=x(w,t);p.each(i.selectedTds,function(e){e===r&&(o=!0)}),o?(r=i.selectedTds[0],setTimeout(function(){w.selection.getRange().setStart(r,0).setCursor(!1,!0)},0)):(k(f.getElementsByTagName(w.body,"td")),k(f.getElementsByTagName(w.body,"th")),i.clearSelected())}}else if(!t.shiftKey&&(k(f.getElementsByTagName(w.body,"td")),k(f.getElementsByTagName(w.body,"th")),p.each(w.document.getElementsByTagName("table"),function(e){e.ueTable=null}),B=x(w,t)))if(i=f.findParentByTagName(B,"table",!0),(i=S(i))&&i.clearSelected(),_){if(!(n.ie&&8>n.version)){i=c(B,a(t)),/\d/.test(i)&&(i=i.replace(/\d/,""),B=S(B).getPreviewCell(B,"v"==i)),v(w);for(var s;s=w.document.getElementById("ue_tableDragLine");)f.remove(s);w.fireEvent("saveScene"),b(w,w.document),y(i,B),U=!0,L=i,O=B}}else w.document.body.style.webkitUserSelect="",U=!0,w.addListener("mouseover",h)}function m(e,t){if(2!=t.button){var i=this.selection.getRange(),o=f.findParentByTagName(i.startContainer,"table",!0),a=f.findParentByTagName(i.endContainer,"table",!0);if((o||a)&&(o===a?(o=f.findParentByTagName(i.startContainer,["td","th","caption"],!0),a=f.findParentByTagName(i.endContainer,["td","th","caption"],!0),o!==a&&this.selection.clearRange()):this.selection.clearRange()),U=!1,this.document.body.style.webkitUserSelect="",(!n.ie||n.ie&&7<n.version)&&L&&O){M=this.document.getElementById("ue_tableDragLine");var a=f.getXY(O),r=f.getXY(M);switch(L){case"h":var i=O,s=r.x-a.x-O.offsetWidth;if(!(10>Math.abs(s))){var l=S(i);if(l){var o=l.table,a=g(o),r=T.getDefaultValue(w,o),d=l.getSameEndPosCells(i,"x"),c=g(d[0])-2*r.tdPadding-r.tdBorder,l=l.getSameStartPosXCells(i),u=g(l[0])-2*r.tdPadding-r.tdBorder;p.each(d,function(e){e.style.width&&(e.style.width=""),0>s&&(e.style.wordBreak="break-all"),e.setAttribute("width",c+s)}),p.each(l,function(e){e.style.width&&(e.style.width=""),0<s&&(e.style.wordBreak="break-all"),e.setAttribute("width",u-s)}),i.nextSibling||(o.style.width&&(o.style.width=""),o.setAttribute("width",a+s))}}break;case"v":if(o=O,i=r.y-a.y-O.offsetHeight,!(10>Math.abs(i))&&(a=S(o)))for(o=a.getSameEndPosCells(o,"y"),a=o[0]?o[0].offsetHeight:0,r=0;d=o[r++];){var m=i,b=a,l=parseInt(f.getComputedStyle(d,"line-height"),10),m=b+m,m=m<l?l:m;d.style.height&&(d.style.height=""),1==d.rowSpan?d.setAttribute("height",m):d.removeAttribute&&d.removeAttribute("height")}}for(L="",O=null;i=this.document.getElementById("ue_tableDragLine");)f.remove(i);this.fireEvent("saveScene"),i&&this.document.appendChild(i)}else{if(B)(o=(i=S(B))?i.selectedTds[0]:null)?(i=new R.Range(this.document),f.isEmptyBlock(o)?i.setStart(o,0).setCursor(!1,!0):i.selectNodeContents(o).shrinkBoundary().setCursor(!1,!0)):(i=this.selection.getRange().shrinkBoundary(),i.collapsed||(o=f.findParentByTagName(i.startContainer,["td","th"],!0),a=f.findParentByTagName(i.endContainer,["td","th"],!0),(o&&!a||!o&&a||o&&a&&o!==a)&&i.setCursor(!1,!0))),B=null,this.removeListener("mouseover",h);else if((o=f.findParentByTagName(t.target||t.srcElement,"td",!0))||(o=f.findParentByTagName(t.target||t.srcElement,"th",!0)),o&&("TD"==o.tagName||"TH"==o.tagName)){if(!0===this.fireEvent("excludetable",o))return;i=new R.Range(this.document),i.setStart(o,0).setCursor(!1,!0)}this._selectionChange(250,t)}}}function h(e,t){var i=t.target||t.srcElement;if(I=f.findParentByTagName(i,"td",!0)||f.findParentByTagName(i,"th",!0),B&&I&&("TD"==B.tagName&&"TD"==I.tagName||"TH"==B.tagName&&"TH"==I.tagName)&&f.findParentByTagName(B,"table")==f.findParentByTagName(I,"table"))if(i=S(I),B!=I){this.document.body.style.webkitUserSelect="none",this.selection.getNative()[n.ie?"empty":"removeAllRanges"]();var o=i.getCellsRange(B,I);i.setSelected(o)}else this.document.body.style.webkitUserSelect="",i.clearSelected();t.preventDefault?t.preventDefault():t.returnValue=!1}function g(e){return e?parseInt(f.getComputedStyle(e,"width"),10):0}function b(e){U||(M=e.document.createElement("div"),f.setAttributes(M,{id:"ue_tableDragLine",unselectable:"on",contenteditable:!1,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"}),e.body.appendChild(M))}function v(e){if(!U)for(var t;t=e.document.getElementById("ue_tableDragLine");)f.remove(t)}function y(e,t){if(t){var n=f.findParentByTagName(t,"table"),i=n.getElementsByTagName("caption"),o=n.offsetWidth,a=n.offsetHeight-(0<i.length?i[0].offsetHeight:0),n=f.getXY(n),r=f.getXY(t);switch(e){case"h":i="height:"+a+"px;top:"+(n.y+(0<i.length?i[0].offsetHeight:0))+"px;left:"+(r.x+t.offsetWidth-2),M.style.cssText=i+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":i="width:"+o+"px;left:"+n.x+"px;top:"+(r.y+t.offsetHeight-2),M.style.cssText=i+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)"}}}function C(e,t){for(var n,i,o=f.getElementsByTagName(e.body,"table"),a=0;i=o[a++];)n=f.getElementsByTagName(i,"td"),n[0]&&(t?(n=n[0].style.borderColor.replace(/\s/g,""),/(#ffffff)|(rgb\(255,f55,255\))/gi.test(n)&&f.addClass(i,"noBorderTable")):f.removeClasses(i,"noBorderTable"))}function N(e,t,n){var i=e.body;return i.offsetWidth-(t?2*parseInt(f.getComputedStyle(i,"margin-left"),10):0)-2*n.tableBorder-(e.options.offsetWidth||0)}function x(e,t){var n=f.findParentByTagName(t.target||t.srcElement,["td","th"],!0);return n&&!0!==e.fireEvent("excludetable",n)?n:null}var w=this,E=!0,T=UE.UETable,S=function(e){return T.getUETable(e)},k=function(e){return T.removeSelectedClass(e)};w.ready(function(){var e=this,t=e.selection.getText;e.selection.getText=function(){var i=T.getUETableBySelected(e);if(i){var o="";return p.each(i.selectedTds,function(e){o+=e[n.ie?"innerText":"textContent"]}),o}return t.call(e.selection)}});var B=null,I=null,L="",_=!1,A=null,D=!1,M=null,O=null,U=!1;w.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:w.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:!1,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]}),w.getUETable=S;var P={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};w.ready(function(){p.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:2px solid #BBB;background:#F7F7F7;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",w.document);var t,h,g;w.addListener("keydown",function(e,n){var i=n.keyCode||n.which;if(8==i){var a=T.getUETableBySelected(this);a&&a.selectedTds.length&&(a.isFullCol()?this.execCommand("deletecol"):a.isFullRow()?this.execCommand("deleterow"):this.fireEvent("delcells"),f.preventDefault(n));var r=f.findParentByTagName(this.selection.getStart(),"caption",!0),s=this.selection.getRange();s.collapsed&&r&&o(r)&&(this.fireEvent("saveScene"),a=r.parentNode,f.remove(r),a&&s.setStart(a.rows[0].cells[0],0).setCursor(!1,!0),this.fireEvent("saveScene"))}if(46==i&&(a=T.getUETableBySelected(this))){for(this.fireEvent("saveScene"),r=0;s=a.selectedTds[r++];)f.fillNode(this.document,s);this.fireEvent("saveScene"),f.preventDefault(n)}if(13==i){if(i=this.selection.getRange(),r=f.findParentByTagName(i.startContainer,"caption",!0))return a=f.findParentByTagName(r,"table"),i.collapsed?r&&i.setStart(a.rows[0].cells[0],0).setCursor(!1,!0):(i.deleteContents(),this.fireEvent("saveScene")),void f.preventDefault(n);i.collapsed&&(a=f.findParentByTagName(i.startContainer,"table"))&&(r=a.rows[0].cells[0],s=f.findParentByTagName(this.selection.getStart(),["td","th"],!0),a=a.previousSibling,r===s&&(!a||1==a.nodeType&&"TABLE"==a.tagName)&&f.isStartInblock(i)&&(this.execCommand("insertparagraphbeforetable"),f.preventDefault(n)))}if((n.ctrlKey||n.metaKey)&&"67"==n.keyCode&&(t=null,a=T.getUETableBySelected(this)))for(i=a.selectedTds,h=a.isFullCol(),g=a.isFullRow(),t=[[a.cloneCell(i[0])]],r=1;s=i[r];r++)s.parentNode!==i[r-1].parentNode?t.push([a.cloneCell(s)]):t[t.length-1].push(a.cloneCell(s))}),w.addListener("tablehasdeleted",function(){d(this,!1,"",null),A&&f.remove(A)}),w.addListener("beforepaste",function(i,a){var r=this,s=r.selection.getRange();if(f.findParentByTagName(s.startContainer,"caption",!0))s=r.document.createElement("div"),s.innerHTML=a.html,a.html=s[n.ie?"innerText":"textContent"];else{var l=T.getUETableBySelected(r);if(t){r.fireEvent("saveScene");var d,c,s=r.selection.getRange(),u=f.findParentByTagName(s.startContainer,["td","th"],!0);if(u){if(l=S(u),g){var m=l.getCellInfo(u).rowIndex;"TH"==u.tagName&&m++;for(var b,s=0;b=t[s++];){c=l.insertRow(m++,"td");for(var v,y=0;v=b[y];y++)(u=c.cells[y])||(u=c.insertCell(y)),u.innerHTML=v.innerHTML,v.getAttribute("width")&&u.setAttribute("width",v.getAttribute("width")),v.getAttribute("vAlign")&&u.setAttribute("vAlign",v.getAttribute("vAlign")),v.getAttribute("align")&&u.setAttribute("align",v.getAttribute("align")),v.style.cssText&&(u.style.cssText=v.style.cssText);for(y=0;(v=c.cells[y])&&b[y];y++)v.innerHTML=b[y].innerHTML,b[y].getAttribute("width")&&v.setAttribute("width",b[y].getAttribute("width")),b[y].getAttribute("vAlign")&&v.setAttribute("vAlign",b[y].getAttribute("vAlign")),b[y].getAttribute("align")&&v.setAttribute("align",b[y].getAttribute("align")),b[y].style.cssText&&(v.style.cssText=b[y].style.cssText)}}else{if(h){for(m=l.getCellInfo(u),y=u=0,b=t[0];v=b[y++];)u+=v.colSpan||1;for(r.__hasEnterExecCommand=!0,s=0;s<u;s++)r.execCommand("insertcol");r.__hasEnterExecCommand=!1,u=l.table.rows[0].cells[m.cellIndex],"TH"==u.tagName&&(u=l.table.rows[1].cells[m.cellIndex])}for(s=0;b=t[s++];){for(d=u,y=0;v=b[y++];)u?(u.innerHTML=v.innerHTML,v.getAttribute("width")&&u.setAttribute("width",v.getAttribute("width")),v.getAttribute("vAlign")&&u.setAttribute("vAlign",v.getAttribute("vAlign")),v.getAttribute("align")&&u.setAttribute("align",v.getAttribute("align")),v.style.cssText&&(u.style.cssText=v.style.cssText),c=u,u=u.nextSibling):(m=v.cloneNode(!0),f.removeAttributes(m,["class","rowSpan","colSpan"]),c.parentNode.appendChild(m));if(u=l.getNextCell(d,!0,!0),!t[s])break;u||(m=l.getCellInfo(d),l.table.insertRow(l.table.rows.length),l.update(),u=l.getVSideCell(d,!0))}}l.update()}else{for(l=r.document.createElement("table"),s=0;b=t[s++];){for(c=l.insertRow(l.rows.length),y=0;v=b[y++];)m=T.cloneCell(v),f.removeAttributes(m,["class"]),c.appendChild(m);2==y&&1<m.rowSpan&&(m.rowSpan=1)}s=T.getDefaultValue(r,void 0),s=r.body.offsetWidth-2*parseInt(f.getComputedStyle(r.body,"margin-left"),10)-2*s.tableBorder-(r.options.offsetWidth||0),r.execCommand("insertHTML","<table  "+(h&&g?'width="'+s+'"':"")+">"+l.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}return r.fireEvent("contentchange"),r.fireEvent("saveScene"),a.html="",!0}s=r.document.createElement("div"),s.innerHTML=a.html,b=s.getElementsByTagName("table"),f.findParentByTagName(r.selection.getStart(),"table")?(p.each(b,function(e){f.remove(e)}),f.findParentByTagName(r.selection.getStart(),"caption",!0)&&(s.innerHTML=s[n.ie?"innerText":"textContent"])):p.each(b,function(t){e(t,"width",!0),e(t,"height",!0),f.removeAttributes(t,["style","border"]),p.each(f.getElementsByTagName(t,"td"),function(t){o(t)&&f.fillNode(r.document,t),e(t,"width",!0),e(t,"height",!0)})}),a.html=s.innerHTML}}),w.addListener("afterpaste",function(){p.each(f.getElementsByTagName(w.body,"table"),function(e){if(e.offsetWidth>w.body.offsetWidth){var t=T.getDefaultValue(w,e);e.style.width=w.body.offsetWidth-2*parseInt(f.getComputedStyle(w.body,"margin-left"),10)-2*t.tableBorder-(w.options.offsetWidth||0)+"px"}})}),w.addListener("blur",function(){t=null});var b;w.addListener("keydown",function(){clearTimeout(b),b=setTimeout(function(){var e=w.selection.getRange();if(e=f.findParentByTagName(e.startContainer,["th","td"],!0)){var t=e.parentNode.parentNode.parentNode;t.offsetWidth>t.getAttribute("width")&&(e.style.wordBreak="break-all")}},100)}),w.addListener("selectionchange",function(){d(w,!1,"",null)}),w.addListener("contentchange",function(){var e=this;if(v(e),!T.getUETableBySelected(e)){var t=e.selection.getRange().startContainer,t=f.findParentByTagName(t,["td","th"],!0);p.each(f.getElementsByTagName(e.document,"table"),function(o){!0!==e.fireEvent("excludetable",o)&&(o.ueTable=new T(o),p.each(f.getElementsByTagName(e.document,"td"),function(i){f.isEmptyBlock(i)&&i!==t&&(f.fillNode(e.document,i),n.ie&&6==n.version&&(i.innerHTML="&nbsp;"))}),p.each(f.getElementsByTagName(e.document,"th"),function(i){f.isEmptyBlock(i)&&i!==t&&(f.fillNode(e.document,i),n.ie&&6==n.version&&(i.innerHTML="&nbsp;"))}),o.onmouseover=function(){e.fireEvent("tablemouseover",o)},o.onmousemove=function(){e.fireEvent("tablemousemove",o),e.options.tableDragable&&s(!0,this,e)},o.onmouseout=function(){e.fireEvent("tablemouseout",o),d(e,!1,"",null),v(e)},o.onclick=function(t){t=e.window.event||t;var n=i(t.target||t.srcElement);if(n){var o=S(n),a=o.table,r=o.getCellInfo(n),s=e.selection.getRange();l(a,n,t,!0)?(a=o.getCell(o.indexTable[o.rowsNum-1][r.colIndex].rowIndex,o.indexTable[o.rowsNum-1][r.colIndex].cellIndex),t.shiftKey&&o.selectedTds.length?o.selectedTds[0]!==a?(t=o.getCellsRange(o.selectedTds[0],a),o.setSelected(t)):s&&s.selectNodeContents(a).select():n!==a?(t=o.getCellsRange(n,a),o.setSelected(t)):s&&s.selectNodeContents(a).select()):l(a,n,t)&&(a=o.getCell(o.indexTable[r.rowIndex][o.colsNum-1].rowIndex,o.indexTable[r.rowIndex][o.colsNum-1].cellIndex),t.shiftKey&&o.selectedTds.length?o.selectedTds[0]!==a?(t=o.getCellsRange(o.selectedTds[0],a),o.setSelected(t)):s&&s.selectNodeContents(a).select():n!==a?(t=o.getCellsRange(n,a),o.setSelected(t)):s&&s.selectNodeContents(a).select())}},o.ondblclick=function(t){t=e.window.event||t;var n=i(t.target||t.srcElement);if(n){var o;if((o=c(n,a(t)))&&("h1"==o&&(o="h",l(f.findParentByTagName(n,"table"),n,t)?e.execCommand("adaptbywindow"):(n=S(n).getPreviewCell(n))&&e.selection.getRange().selectNodeContents(n).setCursor(!0,!0)),"h"==o)){for(;t=e.document.getElementById("ue_tableDragLine");)f.remove(t);e.fireEvent("saveScene",!0),t=S(n);var r=t.getSameEndPosCells(n,"x"),s=t.table;s.removeAttribute("width"),p.each(r,function(e){e.removeAttribute("width")}),setTimeout(function(){var t=r[0].offsetWidth-20;p.each(r,function(e){e.setAttribute("width",t)}),s.setAttribute("width",s.offsetWidth),e.fireEvent("saveScene",!0)})}}})}),C(e,!0)}}),(!n.ie||n.ie&&7<n.version)&&f.on(w.document,"mousemove",r),f.on(w.document,"mouseout",function(e){"TABLE"==(e.target||e.srcElement).tagName&&d(w,!1,"",null)}),w.addListener("interlacetable",function(e,t,n){if(t){e=t.rows,t=e.length;var i=0,o=0;for(-1===this.queryCommandState("inserttitle")&&(i=1);i<t;i++,o++)e[i].className=(n||this.options.classList)[o]?(n||this.options.classList)[o]:(n||this.options.classList)[o%(n||this.options.classList).length]}}),w.addListener("uninterlacetable",function(e,t){if(t)for(var n=t.rows,i=this.options.classList,o=n.length,a=0;a<o;a++)f.removeClasses(n[a],i)}),w.addListener("mousedown",u),w.addListener("mouseup",m);var y=0;w.addListener("mousedown",function(){y=0}),w.addListener("tabkeydown",function(){var e=this.selection.getRange(),t=e.getCommonAncestor(!0,!0),n=f.findParentByTagName(t,"table");if(n){if(f.findParentByTagName(t,"caption",!0))(t=f.getElementsByTagName(n,"th td"))&&t.length&&e.setStart(t[0],0).setCursor(!1,!0);else{var t=f.findParentByTagName(t,["td","th"],!0),i=S(t);y=1<t.rowSpan?y:i.getCellInfo(t).rowIndex,(t=i.getTabNextCell(t,y))?o(t)?e.setStart(t,0).setCursor(!1,!0):e.selectNodeContents(t).select():(w.fireEvent("saveScene"),w.__hasEnterExecCommand=!0,this.execCommand("insertrownext"),w.__hasEnterExecCommand=!1,e=this.selection.getRange(),e.setStart(n.rows[n.rows.length-1].cells[0],0).setCursor(),w.fireEvent("saveScene"))}return!0}}),n.ie&&w.addListener("selectionchange",function(){d(this,!1,"",null)}),w.addListener("keydown",function(e,t){var n=t.keyCode||t.which;if(8!=n&&46!=n){(n=!(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey))&&k(f.getElementsByTagName(this.body,"td"));var i=T.getUETableBySelected(this);i&&n&&i.clearSelected()}}),w.addListener("beforegetcontent",function(){C(this,!1),n.ie&&p.each(this.document.getElementsByTagName("caption"),function(e){f.isEmptyNode(e)&&(e.innerHTML="&nbsp;")})}),w.addListener("aftergetcontent",function(){C(this,!0)}),w.addListener("getAllHtml",function(){k(w.document.getElementsByTagName("td"))}),w.addListener("fullscreenchanged",function(e,t){if(!t){var n=this.body.offsetWidth/document.body.offsetWidth,i=f.getElementsByTagName(this.body,"table");p.each(i,function(e){if(e.offsetWidth<w.body.offsetWidth)return!1;var t=f.getElementsByTagName(e,"td"),i=[];p.each(t,function(e){i.push(e.offsetWidth)});for(var o,a=0;o=t[a];a++)o.setAttribute("width",Math.floor(i[a]*n));e.setAttribute("width",Math.floor(N(w,!0,T.getDefaultValue(w,void 0))))})}});var x=w.execCommand;w.execCommand=function(e){e=e.toLowerCase();var t,n=T.getUETableBySelected(this),i=new R.Range(this.document),a=this.commands[e]||UE.commands[e];if(a){if(!n||P[e]||a.notNeedUndo||this.__hasEnterExecCommand)t=x.apply(this,arguments);else{this.__hasEnterExecCommand=!0,this.fireEvent("beforeexeccommand",e);for(var r,s,l,n=n.selectedTds,d=a=-2,c=0;l=n[c];c++)o(l)?i.setStart(l,0).setCursor(!1,!0):i.selectNodeContents(l).select(!0),s=this.queryCommandState(e),r=this.queryCommandValue(e),-1!=s&&(a===s&&d===r||(this._ignoreContentChange=!0,t=x.apply(this,arguments),this._ignoreContentChange=!1),a=this.queryCommandState(e),d=this.queryCommandValue(e),f.isEmptyBlock(l)&&f.fillNode(this.document,l));i.setStart(n[0],0).shrinkBoundary(!0).setCursor(!1,!0),this.fireEvent("contentchange"),this.fireEvent("afterexeccommand",e),this.__hasEnterExecCommand=!1,this._selectionChange()}return t}}})},UE.plugins.contextmenu=function(){var e,t=this,i=t.getLang("contextMenu"),o=t.options.contextMenu||[{label:i.selectall,cmdName:"selectall"},{label:i.deletecode,cmdName:"highlightcode",icon:"deletehighlightcode"},{label:i.cleardoc,cmdName:"cleardoc",exec:function(){confirm(i.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:i.unlink,cmdName:"unlink"},"-",{group:i.paragraph,icon:"justifyjustify",subMenu:[{label:i.justifyleft,cmdName:"justify",value:"left"},{label:i.justifyright,cmdName:"justify",value:"right"},{label:i.justifycenter,cmdName:"justify",value:"center"},{label:i.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:i.table,icon:"table",subMenu:[{label:i.inserttable,cmdName:"inserttable"},{label:i.deletetable,cmdName:"deletetable"},"-",{label:i.deleterow,cmdName:"deleterow"},{label:i.deletecol,cmdName:"deletecol"},{label:i.insertcol,cmdName:"insertcol"},{label:i.insertcolnext,cmdName:"insertcolnext"},{label:i.insertrow,cmdName:"insertrow"},{label:i.insertrownext,cmdName:"insertrownext"},"-",{label:i.insertcaption,cmdName:"insertcaption"},{label:i.deletecaption,cmdName:"deletecaption"},{label:i.inserttitle,cmdName:"inserttitle"},{label:i.deletetitle,cmdName:"deletetitle"},"-",{label:i.mergecells,cmdName:"mergecells"},{label:i.mergeright,cmdName:"mergeright"},{label:i.mergedown,cmdName:"mergedown"},"-",{label:i.splittorows,cmdName:"splittorows"},{label:i.splittocols,cmdName:"splittocols"},{label:i.splittocells,cmdName:"splittocells"},"-",{label:i.averageDiseRow,cmdName:"averagedistributerow"},{label:i.averageDisCol,cmdName:"averagedistributecol"},"-",{label:i.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this),this.getDialog("edittd").open()}},{label:i.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this),this.getDialog("edittable").open()}}]},{group:i.tablesort,icon:"tablesort",subMenu:[{label:i.reversecurrent,cmdName:"sorttable",value:1},{label:i.orderbyasc,cmdName:"sorttable"},{label:i.reversebyasc,cmdName:"sorttable",exec:function(){this.execCommand("sorttable",function(e,t){return t.innerHTML.localeCompare(e.innerHTML)})}},{label:i.orderbynum,cmdName:"sorttable",exec:function(){this.execCommand("sorttable",function(e,t){var n=e.innerHTML.match(/\d+/),i=t.innerHTML.match(/\d+/);return n&&(n=+n[0]),i&&(i=+i[0]),(n||0)-(i||0)})}},{label:i.reversebynum,cmdName:"sorttable",exec:function(){this.execCommand("sorttable",function(e,t){var n=e.innerHTML.match(/\d+/),i=t.innerHTML.match(/\d+/);return n&&(n=+n[0]),i&&(i=+i[0]),(i||0)-(n||0)})}}]},{group:i.borderbk,icon:"borderBack",subMenu:[{label:i.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:i.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:i.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:i.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:i.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:i.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:i.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:i.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:i.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:i.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:i.tableright,value:"right"}]},"-",{label:i.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:i.insertparagraphafter,cmdName:"insertparagraph"},{label:i.copy,cmdName:"copy",exec:function(){alert(i.copymsg)},query:function(){return 0}},{label:i.paste,cmdName:"paste",exec:function(){alert(i.pastemsg)},query:function(){return 0}},{label:i.highlightcode,cmdName:"highlightcode",exec:function(){UE.ui.highlightcode&&new UE.ui.highlightcode(this),this.ui._dialogs.highlightcodeDialog.open()}}];if(o.length){var a=UE.ui.uiUtils;t.addListener("contextmenu",function(r,s){var l=a.getViewportOffsetByEvent(s);t.fireEvent("beforeselectionchange"),e&&e.destroy();for(var d,c=0,u=[];d=o[c];c++){var m;!function(e){if("-"==e)(m=u[u.length-1])&&"-"!==m&&u.push("-");else if(e.hasOwnProperty("group")){for(var n,o=0,a=[];n=e.subMenu[o];o++)(function(e){"-"==e?(m=a[a.length-1])&&"-"!==m?a.push("-"):a.splice(a.length-1):(t.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&-1<(e.query?e.query():t.queryCommandState(e.cmdName))&&a.push({label:e.label||t.getLang("contextMenu."+e.cmdName+(e.value||""))||"",className:"edui-for-"+e.cmdName+(e.className?" edui-for-"+e.cmdName+"-"+e.className:""),onclick:e.exec?function(){e.exec.call(t)}:function(){t.execCommand(e.cmdName,e.value)}})})(n);a.length&&u.push({label:function(){switch(e.icon){case"table":return t.getLang("contextMenu.table");case"justifyjustify":return t.getLang("contextMenu.paragraph");case"aligntd":return t.getLang("contextMenu.aligntd");case"aligntable":return t.getLang("contextMenu.aligntable");case"tablesort":return i.tablesort;case"borderBack":return i.borderbk;default:return""}}(),className:"edui-for-"+e.icon,subMenu:{items:a,editor:t}})}else(t.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&-1<(e.query?e.query.call(t):t.queryCommandState(e.cmdName))&&("highlightcode"==e.cmdName&&(1==t.queryCommandState(e.cmdName)&&"deletehighlightcode"!=e.icon||1!=t.queryCommandState(e.cmdName)&&"deletehighlightcode"==e.icon)||u.push({label:e.label||t.getLang("contextMenu."+e.cmdName),className:"edui-for-"+(e.icon?e.icon:e.cmdName+(e.value||"")),onclick:e.exec?function(){e.exec.call(t)}:function(){t.execCommand(e.cmdName,e.value)}}))}(d)}if("-"==u[u.length-1]&&u.pop(),e=new UE.ui.Menu({items:u,editor:t}),e.render(),e.showAt(l),f.preventDefault(s),n.ie){var h;try{h=t.selection.getNative().createRange()}catch(e){return}h.item&&new R.Range(t.document).selectNode(h.item(0)).select(!0,!0)}})}},UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=this;t.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),t.addInputRule(function(e){p.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})});for(var n in e)(function(e,n){t.commands[e]={execCommand:function(e){var i=t.selection.getRange(),o=f.filterNodeList(this.selection.getStartElementPath(),n);i.collapsed?(o?(e=t.document.createTextNode(""),i.insertNode(e).removeInlineStyle(n),i.setStartBefore(e),f.remove(e)):(o=i.document.createElement(n[0]),"superscript"!=e&&"subscript"!=e||(e=t.document.createTextNode(""),i.insertNode(e).removeInlineStyle(["sub","sup"]).setStartBefore(e).collapse(!0)),i.insertNode(o).setStart(o,0)),i.collapse(!0)):("superscript"!=e&&"subscript"!=e||(!o||o.tagName.toLowerCase()!=e)&&i.removeInlineStyle(["sub","sup"]),o?i.removeInlineStyle(n):i.applyInlineStyle(n[0])),i.select()},queryCommandState:function(){return f.filterNodeList(this.selection.getStartElementPath(),n)?1:0}}})(n,e[n])},UE.plugins.elementpath=function(){var e,t,n=this;n.setOpt("elementPathEnabled",!0),n.options.elementPathEnabled&&(n.commands.elementpath={execCommand:function(i,o){var a=t[o],r=n.selection.getRange();e=1*o,r.selectNode(a).select()},queryCommandValue:function(){var n=[].concat(this.selection.getStartElementPath()).reverse(),i=[];t=n;for(var o,a=0;o=n[a];a++)if(3!=o.nodeType){var r=o.tagName.toLowerCase();if("img"==r&&o.getAttribute("anchorname")&&(r="anchor"),i[a]=r,e==a){e=-1;break}}return i}})},UE.plugins.formatmatch=function(){function e(r,s){if(n.webkit)var l="IMG"==s.target.tagName?s.target:null;i.undoManger&&i.undoManger.save();var d=i.selection.getRange(),l=l||d.getClosedNode();if(t&&l&&"IMG"==l.tagName)l.style.cssText+=";float:"+(t.style.cssFloat||t.style.styleFloat||"none")+";display:"+(t.style.display||"inline"),t=null;else if(!t){if(d.collapsed){var c=i.document.createTextNode("match");d.insertNode(c).select()}i.__hasEnterExecCommand=!0,d=i.options.removeFormatAttributes,i.options.removeFormatAttributes="",i.execCommand("removeformat"),i.options.removeFormatAttributes=d,i.__hasEnterExecCommand=!1,d=i.selection.getRange(),o.length&&(l=d,c&&l.selectNode(c),l.applyInlineStyle(o[o.length-1].tagName,null,o)),c&&d.setStartBefore(c).collapse(!0),d.select(),c&&f.remove(c)}i.undoManger&&i.undoManger.save(),i.removeListener("mouseup",e),a=0}var t,i=this,o=[],a=0;i.addListener("reset",function(){o=[],a=0}),i.commands.formatmatch={execCommand:function(){if(a)a=0,o=[],i.removeListener("mouseup",e);else{var n=i.selection.getRange();if(t=n.getClosedNode(),!t||"IMG"!=t.tagName){n.collapse(!0).shrinkBoundary(),o=f.findParents(n.startContainer,!0,function(e){return!f.isBlockElm(e)&&1==e.nodeType});for(var r,n=0;r=o[n];n++)if("A"==r.tagName){o.splice(n,1);break}}i.addListener("mouseup",e),a=1}},queryCommandState:function(){return a},notNeedUndo:1}},UE.plugins.searchreplace=function(){var e,t;this.addListener("reset",function(){t=e=null}),this.commands.searchreplace={execCommand:function(i,o){var a,r=this.selection,s=0;if(o=p.extend(o,{all:!1,casesensitive:!1,dir:1},!0),n.ie)for(this.focus();;){var l;if(a=this.document.selection.createRange(),l=a.duplicate(),l.moveToElementText(this.document.body),o.all?(t=0,o.dir=1,e?l.setEndPoint(-1==o.dir?"EndToStart":"StartToEnd",e):l.moveToElementText(this.document.body)):(l.setEndPoint(-1==o.dir?"EndToStart":"StartToEnd",a),o.hasOwnProperty("replaceStr")&&l.setEndPoint(-1==o.dir?"StartToEnd":"EndToStart",a)),l.duplicate(),!l.findText(o.searchStr,o.dir,o.casesensitive?4:0))return e=null,l=this.document.selection.createRange(),l.scrollIntoView(),s;if(l.select(),o.hasOwnProperty("replaceStr")&&(a=r.getRange(),a.deleteContents().insertNode(a.document.createTextNode(o.replaceStr)).select(),e=r.getNative().createRange()),s++,!o.all)break}else for(l=this.window,r=r.getNative();;){if(o.all?(e?(e.collapse(!1),a=e):(a=this.document.createRange(),a.setStart(this.document.body,0),a.collapse(!0)),r.removeAllRanges(),r.addRange(a),t=0,o.dir=1):(n.safari&&this.selection.getRange().select(),r=l.getSelection(),r.rangeCount?a=r.getRangeAt(0):(a=this.document.createRange(),a.setStart(this.body,0),a.collapse(!0),r.addRange(a)),o.hasOwnProperty("replaceStr")&&a.collapse(1==o.dir)),t?r.removeAllRanges():(a.collapse(0>o.dir),r.removeAllRanges(),r.addRange(a)),!l.find(o.searchStr,o.casesensitive,0>o.dir))return e=null,r.removeAllRanges(),s;if(t=0,a=l.getSelection().getRangeAt(0),!a.collapsed&&o.hasOwnProperty("replaceStr")){a.deleteContents();var d=l.document.createTextNode(o.replaceStr);
a.insertNode(d),a.selectNode(d),r.addRange(a),e=a.cloneRange()}if(s++,!o.all)break}return!0}}},UE.plugins.customstyle=function(){var e=this;e.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]}),e.commands.customstyle={execCommand:function(e,n){var i,o,a=n.tag,r=f.findParent(this.selection.getStart(),function(e){return e.getAttribute("label")},!0),s={};for(i in n)void 0!==n[i]&&(s[i]=n[i]);if(delete s.tag,r&&r.getAttribute("label")==n.label){if(i=this.selection.getRange(),o=i.createBookmark(),i.collapsed)if(t.$block[r.tagName]){var l=this.document.createElement("p");f.moveChild(r,l),r.parentNode.insertBefore(l,r),f.remove(r)}else f.remove(r,!0);else{r=f.getCommonAncestor(o.start,o.end),s=f.getElementsByTagName(r,a),RegExp(a,"i").test(r.tagName)&&s.push(r);for(var d,c=0;d=s[c++];)if(d.getAttribute("label")==n.label){var l=f.getPosition(d,o.start),u=f.getPosition(d,o.end);(l&f.POSITION_FOLLOWING||l&f.POSITION_CONTAINS)&&(u&f.POSITION_PRECEDING||u&f.POSITION_CONTAINS)&&t.$block[a]&&(l=this.document.createElement("p"),f.moveChild(d,l),d.parentNode.insertBefore(l,d)),f.remove(d,!0)}(r=f.findParent(r,function(e){return e.getAttribute("label")==n.label},!0))&&f.remove(r,!0)}i.moveToBookmark(o).select()}else t.$block[a]?(this.execCommand("paragraph",a,s,"customstyle"),i=this.selection.getRange(),i.collapsed||(i.collapse(),r=f.findParent(this.selection.getStart(),function(e){return e.getAttribute("label")==n.label},!0),a=this.document.createElement("p"),f.insertAfter(r,a),f.fillNode(this.document,a),i.setStart(a,0).setCursor())):(i=this.selection.getRange(),i.collapsed?(r=this.document.createElement(a),f.setAttributes(r,s),i.insertNode(r).setStart(r,0).setCursor()):(o=i.createBookmark(),i.applyInlineStyle(a,s).moveToBookmark(o).select()))},queryCommandValue:function(){var e=f.filterNodeList(this.selection.getStartElementPath(),function(e){return e.getAttribute("label")});return e?e.getAttribute("label"):""}},e.addListener("keyup",function(n,i){var o=i.keyCode||i.which;if((32==o||13==o)&&(o=e.selection.getRange(),o.collapsed)){var a=f.findParent(e.selection.getStart(),function(e){return e.getAttribute("label")},!0);if(a&&t.$block[a.tagName]&&f.isEmptyNode(a)){var r=e.document.createElement("p");f.insertAfter(a,r),f.fillNode(e.document,r),f.remove(a),o.setStart(r,0).setCursor()}}})},UE.plugins.catchremoteimage=function(){if(!1!==this.options.catchRemoteImageEnable){var a=this;this.setOpt({localDomain:["127.0.0.1","localhost","img.baidu.com"],separater:"ue_separate_ue",catchFieldName:"upfile",catchRemoteImageEnable:!0});var b=UE.ajax,c=a.options.localDomain,d=a.options.catcherUrl,e=a.options.separater;a.addListener("afterpaste",function(){a.fireEvent("catchRemoteImage")}),a.addListener("catchRemoteImage",function(){for(var g=[],h=f.getElementsByTagName(a.document,"img"),j=0,l;l=h[j++];)if(!l.getAttribute("word_img")){l=l.getAttribute("_src")||l.src||"";var k;if(k=/^(https?|ftp):/i.test(l)){e:{k=l;for(var m=c,n=0,p=void 0;p=m[n++];)if(-1!==k.indexOf(p)){k=!0;break e}k=!1}k=!k}k&&g.push(l)}g.length&&(j={success:function(b){try{var c=eval("("+b.responseText+")")}catch(e){return}b=c.srcUrl.split(e);for(var c=c.url.split(e),g=0,j;j=h[g++];)for(var k=j.getAttribute("_src")||j.src||"",l=0,m;m=b[l++];){var n=c[l-1];if(k==m&&"error"!=n){k=a.options.catcherPath+n,f.setAttributes(j,{src:k,_src:k});break}}a.fireEvent("catchremotesuccess")},error:function(){a.fireEvent("catchremoteerror")}},g=g.join(e),j={timeout:6e4,onsuccess:j.success,onerror:j.error},j[a.options.catchFieldName]=g,b.request(d,j))})}},UE.plugins.snapscreen=function(){var a,b;this.setOpt({snapscreenServerPort:location.port,snapscreenImgAlign:"",snapscreenHost:location.hostname}),this.commands.snapscreen={execCommand:function(){var c=this,d=c.getLang("snapScreen_plugin");if(!b){var e=c.container;a=e.ownerDocument||e.document,b=a.createElement("object");try{b.type="application/x-pluginbaidusnap"}catch(e){return}b.style.cssText="position:absolute;left:-9999px;",b.setAttribute("width","0"),b.setAttribute("height","0"),e.appendChild(b)}var h=c.options,e=function(a){try{a=eval("("+a+")")}catch(e){return void alert(d.callBackErrorMsg)}"SUCCESS"!=a.state?alert(a.state):c.execCommand("insertimage",{src:h.snapscreenPath+a.url,floatStyle:h.snapscreenImgAlign,_src:h.snapscreenPath+a.url})};try{var j=h.snapscreenServerPort+"";h.snapscreenServerUrl=h.snapscreenServerUrl.split(h.snapscreenHost),h.snapscreenServerUrl=h.snapscreenServerUrl[1]||h.snapscreenServerUrl[0],0===h.snapscreenServerUrl.indexOf(":"+j)&&(h.snapscreenServerUrl=h.snapscreenServerUrl.substring(j.length+1));var l=b.saveSnapshot(h.snapscreenHost,h.snapscreenServerUrl,j);e(l)}catch(e){c.ui._dialogs.snapscreenDialog.open()}}}},UE.commands.insertparagraph={execCommand:function(e,t){for(var n,i=this.selection.getRange(),o=i.startContainer;o&&!f.isBody(o);)n=o,o=o.parentNode;n&&(o=this.document.createElement("p"),t?n.parentNode.insertBefore(o,n):n.parentNode.insertBefore(o,n.nextSibling),f.fillNode(this.document,o),i.setStart(o,0).setCursor(!1,!0))}},UE.plugins.webapp=function(){function e(e,t,i){return t?'<iframe class="edui-faked-webapp" title="'+e.title+'" width="'+e.width+'" height="'+e.height+'"  scrolling="no" frameborder="0" src="'+e.url+'" logo_url = '+e.logo+"></iframe>":(i?"<p>":"")+'<img title="'+e.title+'" width="'+e.width+'" height="'+e.height+'" src="'+n.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+e.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+e.url+'" />'+(i?"</p>":"")}function t(t){for(var i,o,a=f.getElementsByTagName(n.document,t?"img":"iframe"),r=0;o=a[r++];)"edui-faked-webapp"==o.className&&(i=n.document.createElement("div"),i.innerHTML=e(t?{url:o.getAttribute("_url"),width:o.width,height:o.height,title:o.title,logo:o.style.backgroundImage.replace("url(","").replace(")","")}:{url:o.getAttribute("src",2),title:o.title,width:o.width,height:o.height,logo:o.getAttribute("logo_url")},!!t,!1),o.parentNode.replaceChild(i.firstChild,o))}var n=this;n.addListener("beforegetcontent",function(){t(!0)}),n.addListener("aftersetcontent",function(){t(!1)}),n.addListener("aftergetcontent",function(e){"aftergetcontent"==e&&n.queryCommandState("source")||t(!1)}),n.commands.webapp={execCommand:function(t,i){n.execCommand("inserthtml",e(i,!1,!0))}}},UE.plugins.template=function(){UE.commands.template={execCommand:function(e,t){t.html&&this.execCommand("inserthtml",t.html)}},this.addListener("click",function(e,t){var n=t.target||t.srcElement,i=this.selection.getRange();(n=f.findParent(n,function(e){if(e.className&&f.hasClass(e,"ue_t"))return e},!0))&&i.selectNode(n).shrinkBoundary().select()}),this.addListener("keydown",function(e,t){var n=this.selection.getRange();!n.collapsed&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey&&(n=f.findParent(n.startContainer,function(e){if(e.className&&f.hasClass(e,"ue_t"))return e},!0))&&f.removeClasses(n,["ue_t"])})},UE.plugins.music=function(){function e(e,t,i,o,a,r){return a?'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+e+'" width="'+t+'" height="'+i+'" align="'+o+'"'+("none"!=o?' style= "'+("center"==o?"display:block;":" float: "+o)+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':(r?"<p "+("none"!=o?"center"==o?' style="text-align:center;" ':' style="float:"'+o:"")+">":"")+'<img align="'+o+'" width="'+t+'" height="'+i+'" _url="'+e+'" class="edui-faked-music" src="'+n.options.langPath+n.options.lang+'/images/music.png" />'+(r?"</p>":"")}function t(t){for(var i,o,a=f.getElementsByTagName(n.document,t?"img":"embed"),r=0;o=a[r++];)if("edui-faked-music"==o.className){i=n.document.createElement("div");var s=f.getComputedStyle(o,"float"),s="none"==s?o.getAttribute("align")||"":s;i.innerHTML=e(t?o.getAttribute("_url"):o.getAttribute("src"),o.width,o.height,s,t),o.parentNode.replaceChild(i.firstChild,o)}}var n=this;n.addListener("beforegetcontent",function(){t(!0)}),n.addListener("aftersetcontent",function(){t(!1)}),n.addListener("aftergetcontent",function(e){"aftergetcontent"==e&&n.queryCommandState("source")||t(!1)}),n.commands.music={execCommand:function(t,n){var i=e(n.url,n.width||400,n.height||95,"none",!1,!0);this.execCommand("inserthtml",i)},queryCommandState:function(){var e=this.selection.getRange().getClosedNode();return e&&"edui-faked-music"==e.className?1:0}}},q=q||{},q.editor=q.editor||{},q.editor.ui={};var Ma=function(){var e=document.getElementById("edui_fixedlayer");Y.setViewportOffset(e,{left:0,top:0})},V=q.editor.browser,ba=q.editor.dom.domUtils,Mb=window.$EDITORUI={},Nb=0,Y=q.editor.ui.uiUtils={uid:function(e){return e?e.ID$EDITORUI||(e.ID$EDITORUI=++Nb):++Nb},hook:function(e,t){var n;return e&&e._callbacks?n=e:(n=function(){var t;e&&(t=e.apply(this,arguments));for(var i=n._callbacks,o=i.length;o--;){var a=i[o].apply(this,arguments);void 0===t&&(t=a)}return t},n._callbacks=[]),n._callbacks.push(t),n},createElementByHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return V.ie&&V.quirks?document.body:document.documentElement},getClientRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(e){t={left:0,top:0,height:0,width:0}}for(var n,i={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(n=e.ownerDocument)!==document&&(e=ba.getWindow(n).frameElement);)t=e.getBoundingClientRect(),i.left+=t.left,i.top+=t.top;return i.bottom=i.top+i.height,i.right=i.left+i.width,i},getViewportRect:function(){var e=Y.getViewportElement(),t=0|(window.innerWidth||e.clientWidth),e=0|(window.innerHeight||e.clientHeight);return{left:0,top:0,height:e,width:t,bottom:e,right:t}},setViewportOffset:function(e,t){var n=Y.getFixedLayer();e.parentNode===n?(e.style.left=t.left+"px",e.style.top=t.top+"px"):ba.setViewportOffset(e,t)},getEventOffset:function(e){var t=Y.getClientRect(e.target||e.srcElement);return e=Y.getViewportOffsetByEvent(e),{left:e.left-t.left,top:e.top-t.top}},getViewportOffsetByEvent:function(e){var t=e.target||e.srcElement,n=ba.getWindow(t).frameElement;return e={left:e.clientX,top:e.clientY},n&&t.ownerDocument!==document&&(t=Y.getClientRect(n),e.left+=t.left,e.top+=t.top),e},setGlobal:function(e,t){return Mb[e]=t,'$EDITORUI["'+e+'"]'},unsetGlobal:function(e){delete Mb[e]},copyAttributes:function(e,t){for(var n=t.attributes,i=n.length;i--;){var o=n[i];"style"!=o.nodeName&&"class"!=o.nodeName&&(!V.ie||o.specified)&&e.setAttribute(o.nodeName,o.nodeValue)}t.className&&ba.addClass(e,t.className),t.style.cssText&&(e.style.cssText+=";"+t.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&e!==t&&(e.contains?e.contains(t):16&e.compareDocumentPosition(t))},startDrag:function(e,t,n){function i(e){t.ondragmove(e.clientX-o,e.clientY-a,e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}n=n||document;var o=e.clientX,a=e.clientY;if(n.addEventListener){var r=function(){n.removeEventListener("mousemove",i,!0),n.removeEventListener("mouseup",r,!0),window.removeEventListener("mouseup",r,!0),t.ondragstop()};n.addEventListener("mousemove",i,!0),n.addEventListener("mouseup",r,!0),window.addEventListener("mouseup",r,!0),e.preventDefault()}else{var s=e.srcElement;s.setCapture();var l=function(){s.releaseCapture(),s.detachEvent("onmousemove",i),s.detachEvent("onmouseup",l),s.detachEvent("onlosecaptrue",l),t.ondragstop()};s.attachEvent("onmousemove",i),s.attachEvent("onmouseup",l),s.attachEvent("onlosecaptrue",l),e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var e=document.getElementById("edui_fixedlayer");return null==e&&(e=document.createElement("div"),e.id="edui_fixedlayer",document.body.appendChild(e),V.ie&&8>=V.version?(e.style.position="absolute",ba.on(window,"scroll",Ma),ba.on(window,"resize",q.editor.utils.defer(Ma,0,!0)),setTimeout(Ma)):e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="0",e.style.height="0"),e},makeUnselectable:function(e){if(V.opera||V.ie&&9>V.version){if(e.unselectable="on",e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)1==e.childNodes[t].nodeType&&Y.makeUnselectable(e.childNodes[t])}else void 0!==e.style.MozUserSelect?e.style.MozUserSelect="none":void 0!==e.style.WebkitUserSelect?e.style.WebkitUserSelect="none":void 0!==e.style.KhtmlUserSelect&&(e.style.KhtmlUserSelect="none")}},Ob=q.editor.utils,ca=q.editor.ui.uiUtils,Rc=q.editor.EventBase,Pb=q.editor.ui.UIBase=function(){};Pb.prototype={className:"",uiName:"",initOptions:function(e){for(var t in e)this[t]=e[t];this.id=this.id||"edui"+ca.uid()},initUIBase:function(){this._globalKey=Ob.unhtml(ca.setGlobal(this.id,this))},render:function(e){for(var t,n=this.renderHtml(),n=ca.createElementByHtml(n),i=f.getElementsByTagName(n,"*"),o="edui-"+(this.theme||this.editor.options.theme),a=document.getElementById("edui_fixedlayer"),r=0;t=i[r++];)f.addClass(t,o);f.addClass(n,o),a&&(a.className="",f.addClass(a,o)),i=this.getDom(),null!=i?(i.parentNode.replaceChild(n,i),ca.copyAttributes(n,i)):("string"==typeof e&&(e=document.getElementById(e)),e=e||ca.getFixedLayer(),f.addClass(e,o),e.appendChild(n)),this.postRender()},getDom:function(e){return e?document.getElementById(this.id+"_"+e):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();e&&q.editor.dom.domUtils.remove(e),ca.unsetGlobal(this.id)}},Ob.inherits(Pb,Rc);var Sc=q.editor.utils,Tc=q.editor.ui.UIBase,Qb=q.editor.ui.Separator=function(e){this.initOptions(e),this.initSeparator()};Qb.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},Sc.inherits(Qb,Tc);var Uc=q.editor.utils,Vc=q.editor.dom.domUtils,Wc=q.editor.ui.UIBase,Xc=q.editor.ui.uiUtils,Rb=q.editor.ui.Mask=function(e){this.initOptions(e),this.initUIBase()};Rb.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;Vc.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_fill:function(){var e=this.getDom(),t=Xc.getViewportRect();e.style.width=t.width+"px",e.style.height=t.height+"px"}},Uc.inherits(Rb,Wc);var Oa=function(e,t){for(var n=0;n<Na.length;n++){var i=Na[n];if(!i.isHidden()&&!1!==i.queryAutoHide(t)){if(e&&/scroll/gi.test(e.type)&&"edui-wordpastepop"==i.className)break;i.hide()}}},Yc=q.editor.utils,ia=q.editor.ui.uiUtils,Pa=q.editor.dom.domUtils,Qa=q.editor.ui.UIBase,Ra=q.editor.ui.Popup=function(e){this.initOptions(e),this.initPopup()},Na=[];Ra.postHide=Oa;var Sb=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];Ra.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),Na.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?"string"==typeof this.content?this.content:this.content.renderHtml():""},_UIBase_postRender:Qa.prototype.postRender,postRender:function(){this.content instanceof Qa&&this.content.postRender(),this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return ia.getClientRect(e)},fitSize:function(){var e=this.getDom("body");e.style.width="",e.style.height="";var t=this.mesureSize();return e.style.width=t.width+"px",e.style.height=t.height+"px",t},showAnchor:function(e,t){this.showAnchorRect(ia.getClientRect(e),t)},showAnchorRect:function(e,t){this._doAutoRender();var n=ia.getViewportRect();this._show();var i,o,a=this.fitSize();t?(i=this.canSideLeft&&e.right+a.width>n.right&&e.left>a.width,n=this.canSideUp&&e.top+a.height>n.bottom&&e.bottom>a.height,o=i?e.left-a.width:e.right,a=n?e.bottom-a.height:e.top):(i=this.canSideLeft&&e.right+a.width>n.right&&e.left>a.width,n=this.canSideUp&&e.top+a.height>n.bottom&&e.bottom>a.height,o=i?e.right-a.width:e.left,a=n?e.top-a.height:e.bottom);var r=this.getDom();ia.setViewportOffset(r,{left:o,top:a}),Pa.removeClasses(r,Sb),r.className+=" "+Sb[2*(n?1:0)+(i?1:0)],this.editor&&(r.style.zIndex=1*this.editor.container.style.zIndex+10,q.editor.ui.uiUtils.getFixedLayer().style.zIndex=r.style.zIndex-1)},showAt:function(e){var t=e.left;e=e.top,this.showAnchorRect({left:t,top:e,right:t,bottom:e,height:0,width:0},!1,!0)},_show:function(){this._hidden&&(this.getDom().style.display="",this._hidden=!1,this.fireEvent("show"))},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(e){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,e||this.fireEvent("hide"))},queryAutoHide:function(e){return!e||!ia.contains(this.getDom(),e)}},Yc.inherits(Ra,Qa),Pa.on(document,"mousedown",function(e){Oa(e,e.target||e.srcElement)}),Pa.on(window,"scroll",function(e,t){Oa(e,t)});var Zc=q.editor.utils,$c=q.editor.ui.UIBase,Tb=q.editor.ui.ColorPicker=function(e){this.initOptions(e),this.noColorText=this.noColorText||this.editor.getLang("clearColor"),this.initUIBase()};Tb.prototype={getHtmlTpl:function(){for(var e=this.editor,t='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+this.noColorText+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+e.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >',n=0;n<wa.length;n++)n&&0===n%10&&(t+="</tr>"+(60==n?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+e.getLang("standardColor")+"</td></tr>":"")+"<tr"+(60==n?' class="edui-colorpicker-tablefirstrow"':"")+">"),t+=70>n?'<td style="padding: 0 2px;"><a hidefocus title="'+wa[n]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+wa[n]+'" style="background-color:#'+wa[n]+";border:solid #ccc;"+(10>n||60<=n?"border-width:1px;":10<=n&&20>n?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";return t+"</tr></table></div>"},_onTableClick:function(e){(e=(e.target||e.srcElement).getAttribute("data-color"))&&this.fireEvent("pickcolor",e)},_onTableOver:function(e){(e=(e.target||e.srcElement).getAttribute("data-color"))&&(this.getDom("preview").style.backgroundColor=e)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},Zc.inherits(Tb,$c);var wa="ffffff 000000 eeece1 1f497d 4f81bd c0504d 9bbb59 8064a2 4bacc6 f79646 f2f2f2 7f7f7f ddd9c3 c6d9f0 dbe5f1 f2dcdb ebf1dd e5e0ec dbeef3 fdeada d8d8d8 595959 c4bd97 8db3e2 b8cce4 e5b9b7 d7e3bc ccc1d9 b7dde8 fbd5b5 bfbfbf 3f3f3f 938953 548dd4 95b3d7 d99694 c3d69b b2a2c7 92cddc fac08f a5a5a5 262626 494429 17365d 366092 953734 76923c 5f497a 31859b e36c09 7f7f7f 0c0c0c 1d1b10 0f243e 244061 632423 4f6128 3f3151 205867 974806 c00000 ff0000 ffc000 ffff00 92d050 00b050 00b0f0 0070c0 002060 7030a0 ".split(" "),ad=q.editor.utils,Sa=q.editor.ui.uiUtils,Ub=q.editor.ui.UIBase,Vb=q.editor.ui.TablePicker=function(e){this.initOptions(e),this.initTablePicker()};Vb.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:Ub.prototype.render,render:function(e){this._UIBase_render(e),this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(e,t){var n=this.getDom("overlay").style,i=this.lengthOfCellSide;n.width=e*i+"px",n.height=t*i+"px",this.getDom("label").innerHTML=e+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row"),this.numCols=e,this.numRows=t},_onMouseOver:function(e,t){var n=e.relatedTarget||e.fromElement;!Sa.contains(t,n)&&t!==n&&(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="")},_onMouseOut:function(e,t){var n=e.relatedTarget||e.toElement;!Sa.contains(t,n)&&t!==n&&(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(e){this.getDom("overlay");var t=Sa.getEventOffset(e),n=this.lengthOfCellSide;e=Math.ceil(t.left/n),t=Math.ceil(t.top/n),this._track(e,t)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}},ad.inherits(Vb,Ub);var Wb=q.editor.dom.domUtils,Xb=q.editor.ui.uiUtils,bd='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(q.editor.browser.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');q.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){return this._Stateful_dGetHtmlTpl().replace(/stateful/g,function(){return bd})},Stateful_onMouseEnter:function(e,t){this.target=t,this.isDisabled()&&!this.alwalysHoverable||(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(){this.isDisabled()&&!this.alwalysHoverable||(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(e,t){var n=e.relatedTarget;!Xb.contains(t,n)&&t!==n&&this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var n=e.relatedTarget;!Xb.contains(t,n)&&t!==n&&this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return Wb.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&Wb.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){e?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}};var Yb=q.editor.utils,cd=q.editor.ui.UIBase,dd=q.editor.ui.Stateful,Ta=q.editor.ui.Button=function(e){this.initOptions(e),this.initButton()};Ta.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onClick:function(){this.isDisabled()||this.fireEvent("click")}},Yb.inherits(Ta,cd),Yb.extend(Ta.prototype,dd);var ja=q.editor.utils,Ua=q.editor.ui.uiUtils,Zb=q.editor.ui.UIBase,ed=q.editor.ui.Stateful,Va=q.editor.ui.SplitButton=function(e){this.initOptions(e),this.initSplitButton()};Va.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){if(this.initUIBase(),this.Stateful_init(),null!=this.popup){var e=this.popup;this.popup=null,this.setPopup(e)}},_UIBase_postRender:Zb.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(e){this.popup!==e&&(null!=this.popup&&this.popup.dispose(),e.addListener("show",ja.bind(this._onPopupShow,this)),e.addListener("hide",ja.bind(this._onPopupHide,this)),e.addListener("postrender",ja.bind(function(){e.getDom("body").appendChild(Ua.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(Ua.getClientRect(this.getDom()).width-2)+'px"></div>')),e.getDom().className+=" "+this.className},this)),this.popup=e)},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var e=Ua.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS,e.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(e)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},ja.inherits(Va,Zb),ja.extend(Va.prototype,ed,!0);var fd=q.editor.utils,gd=q.editor.ui.uiUtils,hd=q.editor.ui.ColorPicker,id=q.editor.ui.Popup,$b=q.editor.ui.SplitButton,ac=q.editor.ui.ColorButton=function(e){this.initOptions(e),this.initColorButton()};ac.prototype={initColorButton:function(){var e=this;this.popup=new id({content:new hd({noColorText:e.editor.getLang("clearColor"),editor:e.editor,onpickcolor:function(t,n){e._onPickColor(n)},onpicknocolor:function(t,n){e._onPickNoColor(n)}}),editor:e.editor}),this.initSplitButton()},_SplitButton_postRender:$b.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(gd.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(e){this.color=this.getDom("colorlump").style.backgroundColor=e},_onPickColor:function(e){!1!==this.fireEvent("pickcolor",e)&&(this.setColor(e),this.popup.hide())},_onPickNoColor:function(){!1!==this.fireEvent("picknocolor")&&this.popup.hide()}},fd.inherits(ac,$b);var jd=q.editor.utils,kd=q.editor.ui.Popup,ld=q.editor.ui.TablePicker,md=q.editor.ui.SplitButton,bc=q.editor.ui.TableButton=function(e){this.initOptions(e),this.initTableButton()};bc.prototype={initTableButton:function(){var e=this;this.popup=new kd({content:new ld({editor:e.editor,onpicktable:function(t,n,i){e._onPickTable(n,i)}}),editor:e.editor}),this.initSplitButton()},_onPickTable:function(e,t){!1!==this.fireEvent("picktable",e,t)&&this.popup.hide()}},jd.inherits(bc,md);var nd=q.editor.utils,cc=q.editor.ui.UIBase,dc=q.editor.ui.AutoTypeSetPicker=function(e){this.initOptions(e),this.initAutoTypeSetPicker()};dc.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,t=e.options.autotypeset,n=e.getLang("autoTypeSet"),i="textAlignValue"+e.uid,o="imageBlockLineValue"+e.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap colspan="2"><input type="checkbox" name="mergeEmptyline" '+(t.mergeEmptyline?"checked":"")+">"+n.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(t.removeEmptyline?"checked":"")+">"+n.delLine+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="removeClass" '+(t.removeClass?"checked":"")+">"+n.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(t.indent?"checked":"")+">"+n.indent+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="textAlign" '+(t.textAlign?"checked":"")+">"+n.alignment+'</td><td colspan="2" id="'+i+'"><input type="radio" name="'+i+'" value="left" '+(t.textAlign&&"left"==t.textAlign?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+i+'" value="center" '+(t.textAlign&&"center"==t.textAlign?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+i+'" value="right" '+(t.textAlign&&"right"==t.textAlign?"checked":"")+">"+e.getLang("justifyright")+' </tr><tr><td nowrap colspan="2"><input type="checkbox" name="imageBlockLine" '+(t.imageBlockLine?"checked":"")+">"+n.imageFloat+'</td><td nowrap colspan="2" id="'+o+'"><input type="radio" name="'+o+'" value="none" '+(t.imageBlockLine&&"none"==t.imageBlockLine?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="'+o+'" value="left" '+(t.imageBlockLine&&"left"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+o+'" value="center" '+(t.imageBlockLine&&"center"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+o+'" value="right" '+(t.imageBlockLine&&"right"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifyright")+'</tr><tr><td nowrap colspan="2"><input type="checkbox" name="clearFontSize" '+(t.clearFontSize?"checked":"")+">"+n.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(t.clearFontFamily?"checked":"")+">"+n.removeFontFamily+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="removeEmptyNode" '+(t.removeEmptyNode?"checked":"")+">"+n.removeHtml+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="pasteFilter" '+(t.pasteFilter?"checked":"")+">"+n.pasteFilter+'</td></tr><tr><td nowrap colspan="4" align="right"><button >'+n.run+"</button></td></tr></table></div></div>";
},_UIBase_render:cc.prototype.render},nd.inherits(dc,cc);var ec=function(e){for(var t,n=e.editor.options.autotypeset,i=e.getDom(),o=e.editor.uid,a=null,a=null,r=f.getElementsByTagName(i,"input"),s=r.length-1;t=r[s--];)if(a=t.getAttribute("type"),"checkbox"==a&&(a=t.getAttribute("name"),n[a]&&delete n[a],t.checked))if(t=document.getElementById(a+"Value"+o))if(/input/gi.test(t.tagName))n[a]=t.value;else{t=t.getElementsByTagName("input");for(var l,d=t.length-1;l=t[d--];)if(l.checked){n[a]=l.value;break}}else n[a]=!0;for(i=f.getElementsByTagName(i,"select"),s=0;o=i[s++];)r=o.getAttribute("name"),n[r]=n[r]?o.value:"";e.editor.options.autotypeset=n},od=q.editor.utils,pd=q.editor.ui.Popup,qd=q.editor.ui.AutoTypeSetPicker,rd=q.editor.ui.SplitButton,fc=q.editor.ui.AutoTypeSetButton=function(e){this.initOptions(e),this.initAutoTypeSetButton()};fc.prototype={initAutoTypeSetButton:function(){var e=this;this.popup=new pd({content:new qd({editor:e.editor}),editor:e.editor,hide:function(){!this._hidden&&this.getDom()&&(ec(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}});var t=0;this.popup.addListener("postRenderAfter",function(){var n=this;t||(this.getDom().getElementsByTagName("button")[0].onclick=function(){ec(n),e.editor.execCommand("autotypeset"),n.hide()},t=1)}),this.initSplitButton()}},od.inherits(fc,rd);var gc=q.editor.utils,sd=q.editor.ui.Popup,td=q.editor.ui.Stateful,hc=q.editor.ui.UIBase,Wa=q.editor.ui.CellAlignPicker=function(e){this.initOptions(e),this.initSelected(),this.initCellAlignPicker()};Wa.prototype={initSelected:function(){var e={top:0,middle:1,bottom:2},t={left:0,center:1,right:2};this.selected&&(this.selectedIndex=3*e[this.selected.valign]+t[this.selected.align])},initCellAlignPicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){for(var e=["left","center","right"],t=null,n=-1,i=[],o=0;9>o;o++)t=this.selectedIndex===o?' class="edui-cellalign-selected" ':"",n=o%3,0===n&&i.push("<tr>"),i.push('<td index="'+o+'" '+t+' stateful><div class="edui-icon edui-'+e[n]+'"></div></td>'),2===n&&i.push("</tr>");return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+i.join("")+"</table></div></div>"},getStateDom:function(){return this.target},_onClick:function(e){var t=e.target||e.srcElement;/icon/.test(t.className)&&(this.items[t.parentNode.getAttribute("index")].onclick(),sd.postHide(e))},_UIBase_render:hc.prototype.render},gc.inherits(Wa,hc),gc.extend(Wa.prototype,td,!0);var ic=q.editor.utils,ud=q.editor.ui.Stateful,jc=q.editor.ui.uiUtils,kc=q.editor.ui.UIBase,Xa=q.editor.ui.PastePicker=function(e){this.initOptions(e),this.initPastePicker()};Xa.prototype={initPastePicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(e){this.editor.ui._isTransfer=!0,this.editor.fireEvent("pasteTransfer",e)},_onClick:function(e){var t=f.getNextDomNode(e),n=jc.getViewportRect().height,i=jc.getClientRect(t);t.style.top=i.top+i.height>n?-i.height-e.offsetHeight+"px":"",/hidden/gi.test(f.getComputedStyle(t,"visibility"))?(t.style.visibility="visible",f.addClass(e,"edui-state-opened")):(t.style.visibility="hidden",f.removeClasses(e,"edui-state-opened"))},_UIBase_render:kc.prototype.render},ic.inherits(Xa,kc),ic.extend(Xa.prototype,ud,!0);var vd=q.editor.utils,wd=q.editor.ui.uiUtils,xd=q.editor.ui.UIBase,lc=q.editor.ui.Toolbar=function(e){this.initOptions(e),this.initToolbar()};lc.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){for(var e=[],t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+e.join("")+"</div>"},postRender:function(){for(var e=this.getDom(),t=0;t<this.items.length;t++)this.items[t].postRender();wd.makeUnselectable(e)},_onMouseDown:function(){return!1}},vd.inherits(lc,xd);var Ya=q.editor.utils,xa=q.editor.dom.domUtils,ka=q.editor.ui.uiUtils,yd=q.editor.ui.UIBase,la=q.editor.ui.Popup,zd=q.editor.ui.Stateful,Ad=q.editor.ui.CellAlignPicker,ya=q.editor.ui.Menu=function(e){this.initOptions(e),this.initMenu()},Bd={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};ya.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];"-"==t?this.items[e]=this.getSeparator():t instanceof ma||(t.editor=this.editor,t.theme=this.editor.options.theme,this.items[e]=this.createItem(t))}},getSeparator:function(){return Bd},createItem:function(e){return e.menu=this,new ma(e)},_Popup_getContentHtmlTpl:la.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(0==this.items.length)return this._Popup_getContentHtmlTpl();for(var e=[],t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:la.prototype.postRender,postRender:function(){for(var e=this,t=0;t<this.items.length;t++){var n=this.items[t];n.ownerMenu=this,n.postRender()}xa.on(this.getDom(),"mouseover",function(t){t=t||event,t=t.relatedTarget||t.fromElement;var n=e.getDom();!ka.contains(n,t)&&n!==t&&e.fireEvent("over")}),this._Popup_postRender()},queryAutoHide:function(e){if(e){if(ka.contains(this.getDom(),e))return!1;for(var t=0;t<this.items.length;t++)if(!1===this.items[t].queryAutoHide(e))return!1}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer),clearTimeout(t._closingTimer),t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&xa.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},Ya.inherits(ya,la);var ma=q.editor.ui.MenuItem=function(e){if(this.initOptions(e),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof ya))if(e.className&&-1!=e.className.indexOf("aligntd")){var t=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new la({content:new Ad(this.subMenu),parentMenu:t,editor:t.editor,destroy:function(){this.getDom()&&xa.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",function(){xa.on(this.getDom(),"mouseover",function(){t.addState("opened")})})}else this.subMenu=new ya(this.subMenu)};ma.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var e=this;this.addListener("over",function(){e.ownerMenu.fireEvent("submenuover",e),e.subMenu&&e.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){e.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(e._closingTimer),e._closingTimer=null,e.addState("opened")}),this.ownerMenu.addListener("hide",function(){e.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,n){n!==e&&e.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(t){return(!t||!ka.contains(e.getDom(),t))&&this._bakQueryAutoHide(t)}),this.getDom().style.tabIndex="-1",ka.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;e.isDisabled()||(e.addState("opened"),clearTimeout(e._showingTimer),clearTimeout(e._closingTimer),e._closingTimer=null,e._showingTimer=setTimeout(function(){e.showSubMenu()},250))},delayHideSubMenu:function(){var e=this;e.isDisabled()||(e.removeState("opened"),clearTimeout(e._showingTimer),e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu(),e._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(e)},_onClick:function(e,t){this.hasState("disabled")||!1!==this.fireEvent("click",e,t)&&(this.subMenu?this.showSubMenu():la.postHide(e))},showSubMenu:function(){var e=ka.getClientRect(this.getDom());e.right-=5,e.left+=2,e.width-=7,e.top-=4,e.bottom+=4,e.height+=8,this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},Ya.inherits(ma,yd),Ya.extend(ma.prototype,zd,!0);var Cd=q.editor.utils,Dd=q.editor.ui.uiUtils,Ed=q.editor.ui.Menu,mc=q.editor.ui.SplitButton,nc=q.editor.ui.Combox=function(e){this.initOptions(e),this.initCombox()};nc.prototype={uiName:"combox",initCombox:function(){var e=this;this.items=this.items||[];for(var t=0;t<this.items.length;t++){var n=this.items[t];n.uiName="listitem",n.index=t,n.onclick=function(){e.selectByIndex(this.index)}}this.popup=new Ed({items:this.items,uiName:"list",editor:this.editor}),this.initSplitButton()},_SplitButton_postRender:mc.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var e=Dd.getClientRect(this.getDom());e.top+=1,e.bottom-=1,e.height-=2,this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);-1!=t?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(e)),this.value=e)},setLabel:function(e){this.label=this.getDom("button_body").innerHTML=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++)if(e==this.items[t].value)return t;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){e<this.items.length&&!1!==this.fireEvent("select",e)&&(this.selectedIndex=e,this.value=this.items[e].value,this.setLabel(this.items[e].label))}},Cd.inherits(nc,mc);var oc=q.editor.utils,S=q.editor.dom.domUtils,T=q.editor.ui.uiUtils,pc=q.editor.ui.Mask,Fd=q.editor.ui.UIBase,Za=q.editor.ui.Button,qc=q.editor.ui.Dialog=function(e){this.initOptions(oc.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(e,t){return t?this.onok():this.oncancel()},holdScroll:!1},e)),this.initDialog()},rc,sc;qc.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var e=this,t=this.editor.options.theme;if(this.initUIBase(),this.modalMask=rc||(rc=new pc({className:"edui-dialog-modalmask",theme:t})),this.dragMask=sc||(sc=new pc({className:"edui-dialog-dragmask",theme:t})),this.closeButton=new Za({className:"edui-dialog-closebutton",title:e.closeDialog,theme:t,onclick:function(){e.close(!1)}}),this.buttons)for(t=0;t<this.buttons.length;t++)this.buttons[t]instanceof Za||(this.buttons[t]=new Za(this.buttons[t]))},fitSize:function(){var e=this.getDom("body"),t=this.mesureSize();return e.style.width=t.width+"px",e.style.height=t.height+"px",t},safeSetOffset:function(e){var t=this.getDom(),n=T.getViewportRect(),i=T.getClientRect(t),o=e.left;o+i.width>n.right&&(o=n.right-i.width),e=e.top,e+i.height>n.bottom&&(e=n.bottom-i.height),t.style.left=Math.max(o,0)+"px",t.style.top=Math.max(e,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var e=T.getViewportRect(),t=this.fitSize(),n=0|this.getDom("titlebar").offsetHeight,i=e.width/2-t.width/2,e=e.height/2-(t.height-n)/2-n,t=this.getDom();this.safeSetOffset({left:Math.max(0|i,0),top:Math.max(0|e,0)}),S.hasClass(t,"edui-state-centered")||(t.className+=" edui-state-centered"),this._show()},getContentHtml:function(){var e="";return"string"==typeof this.content?e=this.content:this.iframeUrl&&(e='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),e},getHtmlTpl:function(){var e="";if(this.buttons){for(var e=[],t=0;t<this.buttons.length;t++)e[t]=this.buttons[t].renderHtml();e='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+e.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+e+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var e=this;if(this.addListener("show",function(){e.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){e.modalMask.hide()}),this.buttons)for(var t=0;t<this.buttons.length;t++)this.buttons[t].postRender();S.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e.safeSetOffset(T.getClientRect(e.getDom()))})}),this.holdScroll&&(e.iframeUrl?e.addListener("dialogafterreset",function(){window.setTimeout(function(){var t=document.getElementById(e.id+"_iframe").contentWindow;if(n.ie)var i=window.setInterval(function(){t.document&&t.document.body&&(window.clearInterval(i),i=null,S.on(t.document.body,n.gecko?"DOMMouseScroll":"mousewheel",function(e){S.preventDefault(e)}))},100);else S.on(t,n.gecko?"DOMMouseScroll":"mousewheel",function(e){S.preventDefault(e)})},1)}):S.on(document.getElementById(e.id+"_iframe"),n.gecko?"DOMMouseScroll":"mousewheel",function(e){S.preventDefault(e)})),this._hide()},mesureSize:function(){var e=this.getDom("body"),t=T.getClientRect(this.getDom("content")).width;return e.style.width=t,T.getClientRect(e)},_onTitlebarMouseDown:function(e){if(this.draggable){var t;T.getViewportRect();var n=this;T.startDrag(e,{ondragstart:function(){t=T.getClientRect(n.getDom()),n.getDom("contmask").style.visibility="visible",n.dragMask.show(n.getDom().style.zIndex-1)},ondragmove:function(e,i){n.safeSetOffset({left:t.left+e,top:t.top+i})},ondragstop:function(){n.getDom("contmask").style.visibility="hidden",S.removeClasses(n.getDom(),["edui-state-centered"]),n.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),q.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){this._hidden||(this.getDom().style.display="none",this.getDom().style.zIndex="",this._hidden=!0,this.fireEvent("hide"))},open:function(){if(this.autoReset)try{this.reset()}catch(e){this.render(),this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(e){}},_onCloseButtonClick:function(){this.close(!1)},close:function(e){!1!==this.fireEvent("close",e)&&this._hide()}},oc.inherits(qc,Fd);var Gd=q.editor.utils,Hd=q.editor.ui.Menu,Id=q.editor.ui.SplitButton,tc=q.editor.ui.MenuButton=function(e){this.initOptions(e),this.initMenuButton()};tc.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton",this.popup=new Hd({items:e.items,className:e.className,editor:e.editor}),this.popup.addListener("show",function(){for(var t=0;t<this.items.length;t++)this.items[t].removeState("checked"),this.items[t].value==e._value&&(this.items[t].addState("checked"),this.value=e._value)}),this.initSplitButton()},setValue:function(e){this._value=e}},Gd.inherits(tc,Id);var za=q.editor.utils,y=q.editor.ui,Jd=y.Dialog;y.buttons={},y.Dialog=function(e){var t=new Jd(e);return t.addListener("hide",function(){if(t.editor){var e=t.editor;try{if(n.gecko){var i=e.window.scrollY,o=e.window.scrollX;e.body.focus(),e.window.scrollTo(o,i)}else e.focus()}catch(e){}}}),t};for(var $a={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"},Kd="undo redo formatmatch bold italic underline fontborder touppercase tolowercase strikethrough subscript superscript source indent outdent blockquote pasteplain pagebreak selectall print preview horizontal removeformat time date unlink insertparagraphbeforetable insertrow insertcol mergeright mergedown deleterow deletecol splittorows splittocols splittocells mergecells deletetable".split(" "),ab=0,W;W=Kd[ab++];)W=W.toLowerCase(),y[W]=function(e){return function(t){var n=new y.Button({className:"edui-for-"+e,title:t.options.labelMap[e]||t.getLang("labelMap."+e)||"",onclick:function(){t.execCommand(e)},theme:t.options.theme,showText:!1});return y.buttons[e]=n,t.addListener("selectionchange",function(i,o,a){i=t.queryCommandState(e),-1==i?(n.setDisabled(!0),n.setChecked(!1)):a||(n.setDisabled(!1),n.setChecked(i))}),n}}(W);y.cleardoc=function(e){var t=new y.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});return y.buttons.cleardoc=t,e.addListener("selectionchange",function(){t.setDisabled(-1==e.queryCommandState("cleardoc"))}),t};var uc={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]},da;for(da in uc)(function(e,t){for(var n,i=0;n=t[i++];)(function(t){y[e.replace("float","")+t]=function(n){var i=new y.Button({className:"edui-for-"+e.replace("float","")+t,title:n.options.labelMap[e.replace("float","")+t]||n.getLang("labelMap."+e.replace("float","")+t)||"",theme:n.options.theme,onclick:function(){n.execCommand(e,t)}});return y.buttons[e]=i,n.addListener("selectionchange",function(o,a,r){i.setDisabled(-1==n.queryCommandState(e)),i.setChecked(n.queryCommandValue(e)==t&&!r)}),i}})(n)})(da,uc[da]);for(ab=0;W=["backcolor","forecolor"][ab++];)y[W]=function(e){return function(t){var n=new y.ColorButton({className:"edui-for-"+e,color:"default",title:t.options.labelMap[e]||t.getLang("labelMap."+e)||"",editor:t,onpickcolor:function(n,i){t.execCommand(e,i)},onpicknocolor:function(){t.execCommand(e,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){t.execCommand(e,this.color)}});return y.buttons[e]=n,t.addListener("selectionchange",function(){n.setDisabled(-1==t.queryCommandState(e))}),n}}(W);var vc={noOk:["searchreplace","help","spechars","webapp"],ok:"attachment anchor link insertimage map gmap insertframe wordimage insertvideo insertframe edittip edittable edittd scrawl template music background".split(" ")};for(da in vc)(function(e,t){for(var i,o=0;i=t[o++];)n.opera&&"searchreplace"===i||function(t){y[t]=function(n,i,o){i=i||(n.options.iframeUrlMap||{})[t]||$a[t],o=n.options.labelMap[t]||n.getLang("labelMap."+t)||"";var a;i&&(a=new y.Dialog(za.extend({iframeUrl:n.ui.mapUrl(i),editor:n,className:"edui-for-"+t,title:o,holdScroll:"insertimage"===t,closeDialog:n.getLang("closeDialog")},"ok"==e?{buttons:[{className:"edui-okbutton",label:n.getLang("ok"),editor:n,onclick:function(){a.close(!0)}},{className:"edui-cancelbutton",label:n.getLang("cancel"),editor:n,onclick:function(){a.close(!1)}}]}:{})),n.ui._dialogs[t+"Dialog"]=a);var r=new y.Button({className:"edui-for-"+t,title:o,onclick:function(){if(a)switch(t){case"wordimage":n.execCommand("wordimage","word_img"),n.word_img&&(a.render(),a.open());break;case"scrawl":-1!=n.queryCommandState("scrawl")&&(a.render(),a.open());break;default:a.render(),a.open()}},theme:n.options.theme,disabled:"scrawl"==t&&-1==n.queryCommandState("scrawl")});return y.buttons[t]=r,n.addListener("selectionchange",function(){if(!(t in{edittable:1})){var e=n.queryCommandState(t);r.getDom()&&(r.setDisabled(-1==e),r.setChecked(e))}}),r}}(i.toLowerCase())})(da,vc[da]);y.snapscreen=function(e,t,n){n=e.options.labelMap.snapscreen||e.getLang("labelMap.snapscreen")||"";var i=new y.Button({className:"edui-for-snapscreen",title:n,onclick:function(){e.execCommand("snapscreen")},theme:e.options.theme});if(y.buttons.snapscreen=i,t=t||(e.options.iframeUrlMap||{}).snapscreen||$a.snapscreen){var o=new y.Dialog({iframeUrl:e.ui.mapUrl(t),editor:e,className:"edui-for-snapscreen",title:n,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),editor:e,onclick:function(){o.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),editor:e,onclick:function(){o.close(!1)}}]});o.render(),e.ui._dialogs.snapscreenDialog=o}return e.addListener("selectionchange",function(){i.setDisabled(-1==e.queryCommandState("snapscreen"))}),i},y.insertcode=function(e,t,n){t=e.options.insertcode||[],n=e.options.labelMap.insertcode||e.getLang("labelMap.insertcode")||"";var i=[];za.each(t,function(t,n){i.push({label:t,value:n,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});var o=new y.Combox({editor:e,items:i,onselect:function(t,n){e.execCommand("insertcode",this.items[n].value)},onbuttonclick:function(){this.showPopup()},title:n,initValue:n,className:"edui-for-insertcode",indexByValue:function(e){if(e)for(var t,n=0;t=this.items[n];n++)if(-1!=t.value.indexOf(e))return n;return-1}});return y.buttons.insertcode=o,e.addListener("selectionchange",function(t,i,a){a||(-1==e.queryCommandState("insertcode")?o.setDisabled(!0):(o.setDisabled(!1),(t=e.queryCommandValue("insertcode"))?(t&&(t=t.replace(/['"]/g,"").split(",")[0]),o.setValue(t)):o.setValue(n)))}),o},y.fontfamily=function(e,t,n){if(t=e.options.fontfamily||[],n=e.options.labelMap.fontfamily||e.getLang("labelMap.fontfamily")||"",t.length){for(var i,o=0,a=[];i=t[o];o++){var r=e.getLang("fontfamily")[i.name]||"";!function(t,n){a.push({label:t,value:n,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+za.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}(i.label||r,i.val)}var s=new y.Combox({editor:e,items:a,onselect:function(t,n){e.execCommand("FontFamily",this.items[n].value)},onbuttonclick:function(){this.showPopup()},title:n,initValue:n,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t,n=0;t=this.items[n];n++)if(-1!=t.value.indexOf(e))return n;return-1}});return y.buttons.fontfamily=s,e.addListener("selectionchange",function(t,n,i){i||(-1==e.queryCommandState("FontFamily")?s.setDisabled(!0):(s.setDisabled(!1),(t=e.queryCommandValue("FontFamily"))&&(t=t.replace(/['"]/g,"").split(",")[0]),s.setValue(t)))}),s}},y.fontsize=function(e,t,n){if(n=e.options.labelMap.fontsize||e.getLang("labelMap.fontsize")||"",t=t||e.options.fontsize||[],t.length){for(var i=[],o=0;o<t.length;o++){var a=t[o]+"px";i.push({label:a,value:a,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var r=new y.Combox({editor:e,items:i,title:n,initValue:n,onselect:function(t,n){e.execCommand("FontSize",this.items[n].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return y.buttons.fontsize=r,e.addListener("selectionchange",function(t,n,i){i||(-1==e.queryCommandState("FontSize")?r.setDisabled(!0):(r.setDisabled(!1),r.setValue(e.queryCommandValue("FontSize"))))}),r}},y.paragraph=function(e,t,n){if(n=e.options.labelMap.paragraph||e.getLang("labelMap.paragraph")||"",t=e.options.paragraph||[],!za.isEmptyObject(t)){var i,o=[];for(i in t)o.push({value:i,label:t[i]||e.getLang("paragraph")[i],theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var a=new y.Combox({editor:e,items:o,title:n,initValue:n,className:"edui-for-paragraph",onselect:function(t,n){e.execCommand("Paragraph",this.items[n].value)},onbuttonclick:function(){this.showPopup()}});return y.buttons.paragraph=a,e.addListener("selectionchange",function(t,n,i){i||(-1==e.queryCommandState("Paragraph")?a.setDisabled(!0):(a.setDisabled(!1),t=e.queryCommandValue("Paragraph"),-1!=a.indexByValue(t)?a.setValue(t):a.setValue(a.initValue)))}),a}},y.customstyle=function(e){var t=e.options.customstyle||[],n=e.options.labelMap.customstyle||e.getLang("labelMap.customstyle")||"";if(t.length){for(var i,o=e.getLang("customstyle"),a=0,r=[];i=t[a++];)(function(t){var n={};n.label=t.label?t.label:o[t.name],n.style=t.style,n.className=t.className,n.tag=t.tag,r.push({label:n.label,value:n,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+n.tag+" "+(n.className?' class="'+n.className+'"':"")+(n.style?' style="'+n.style+'"':"")+">"+n.label+"</"+n.tag+"></div>"}})})(i);var s=new y.Combox({editor:e,items:r,title:n,initValue:n,className:"edui-for-customstyle",onselect:function(t,n){e.execCommand("customstyle",this.items[n].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t,n=0;t=this.items[n++];)if(t.label==e)return n-1;return-1}});return y.buttons.customstyle=s,e.addListener("selectionchange",function(t,n,i){i||(-1==e.queryCommandState("customstyle")?s.setDisabled(!0):(s.setDisabled(!1),t=e.queryCommandValue("customstyle"),-1!=s.indexByValue(t)?s.setValue(t):s.setValue(s.initValue)))}),s}},y.inserttable=function(e,t,n){n=e.options.labelMap.inserttable||e.getLang("labelMap.inserttable")||"";var i=new y.TableButton({editor:e,title:n,className:"edui-for-inserttable",onpicktable:function(t,n,i){e.execCommand("InsertTable",{numRows:i,numCols:n,border:1})},onbuttonclick:function(){this.showPopup()}});return y.buttons.inserttable=i,e.addListener("selectionchange",function(){i.setDisabled(-1==e.queryCommandState("inserttable"))}),i},y.lineheight=function(e){var t=e.options.lineheight||[];if(t.length){for(var n,i=0,o=[];n=t[i++];)o.push({label:n,value:n,theme:e.options.theme,onclick:function(){e.execCommand("lineheight",this.value)}});var a=new y.MenuButton({editor:e,className:"edui-for-lineheight",title:e.options.labelMap.lineheight||e.getLang("labelMap.lineheight")||"",items:o,onbuttonclick:function(){var t=e.queryCommandValue("LineHeight")||this.value;e.execCommand("LineHeight",t)}});return y.buttons.lineheight=a,e.addListener("selectionchange",function(){var t=e.queryCommandState("LineHeight");if(-1==t)a.setDisabled(!0);else{a.setDisabled(!1);var n=e.queryCommandValue("LineHeight");n&&a.setValue((n+"").replace(/cm/,"")),a.setChecked(t)}}),a}};for(var Ld=["top","bottom"],Md=0,wc;wc=Ld[Md++];)(function(e){y["rowspacing"+e]=function(t){var n=t.options["rowspacing"+e]||[];if(!n.length)return null;for(var i,o=0,a=[];i=n[o++];)a.push({label:i,value:i,theme:t.options.theme,onclick:function(){t.execCommand("rowspacing",this.value,e)}});var r=new y.MenuButton({editor:t,className:"edui-for-rowspacing"+e,title:t.options.labelMap["rowspacing"+e]||t.getLang("labelMap.rowspacing"+e)||"",items:a,onbuttonclick:function(){var n=t.queryCommandValue("rowspacing",e)||this.value;t.execCommand("rowspacing",n,e)}});return y.buttons[e]=r,t.addListener("selectionchange",function(){var n=t.queryCommandState("rowspacing",e);if(-1==n)r.setDisabled(!0);else{r.setDisabled(!1);var i=t.queryCommandValue("rowspacing",e);i&&r.setValue((i+"").replace(/%/,"")),r.setChecked(n)}}),r}})(wc);for(var Nd=["insertorderedlist","insertunorderedlist"],Od=0,xc;xc=Nd[Od++];)(function(e){y[e]=function(t){var n,i=t.options[e],o=function(){t.execCommand(e,this.value)},a=[];for(n in i)a.push({label:i[n]||t.getLang()[e][n]||"",value:n,theme:t.options.theme,onclick:o});var r=new y.MenuButton({editor:t,className:"edui-for-"+e,title:t.getLang("labelMap."+e)||"",items:a,onbuttonclick:function(){var n=t.queryCommandValue(e)||this.value;t.execCommand(e,n)}});return y.buttons[e]=r,t.addListener("selectionchange",function(){var n=t.queryCommandState(e);if(-1==n)r.setDisabled(!0);else{r.setDisabled(!1);var i=t.queryCommandValue(e);r.setValue(i),r.setChecked(n)}}),r}})(xc);y.fullscreen=function(e,t){t=e.options.labelMap.fullscreen||e.getLang("labelMap.fullscreen")||"";var n=new y.Button({className:"edui-for-fullscreen",title:t,theme:e.options.theme,onclick:function(){e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen()),this.setChecked(e.ui.isFullScreen())}});return y.buttons.fullscreen=n,e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");n.setDisabled(-1==t),n.setChecked(e.ui.isFullScreen())}),n},y.emotion=function(e,t){var n=new y.MultiMenuPop({title:e.options.labelMap.emotion||e.getLang("labelMap.emotion")||"",editor:e,className:"edui-for-emotion",iframeUrl:e.ui.mapUrl(t||(e.options.iframeUrlMap||{}).emotion||$a.emotion)});return y.buttons.emotion=n,e.addListener("selectionchange",function(){n.setDisabled(-1==e.queryCommandState("emotion"))}),n},y.autotypeset=function(e){var t=new y.AutoTypeSetButton({editor:e,title:e.options.labelMap.autotypeset||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});return y.buttons.autotypeset=t,e.addListener("selectionchange",function(){t.setDisabled(-1==e.queryCommandState("autotypeset"))}),t};var bb=function(e){this.initOptions(e),this.initEditorUI()},cb=q.editor.utils,yc=q.editor.ui.uiUtils,Pd=q.editor.ui.UIBase,H=q.editor.dom.domUtils,zc=[];bb.prototype={uiName:"editor",initEditorUI:function(){function e(e,t){e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var n=e.options,i=n.maximumWords,o=n.wordCountMsg,a=n.wordOverFlowMsg,r=t.getDom("wordcount");n.wordCount&&(n=e.getContentLength(!0),n>i?(r.innerHTML=a,e.fireEvent("wordcountoverflow")):r.innerHTML=o.replace("{#leave}",i-n).replace("{#count}",n))}this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars();var t=this.editor,n=this;t.addListener("ready",function(){t.getDialog=function(e){return t.ui._dialogs[e+"Dialog"]},H.on(t.window,"scroll",function(e){q.editor.ui.Popup.postHide(e)}),t.ui._actualFrameWidth=t.options.initialFrameWidth,t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":</div>"),
t.options.wordCount&&(H.on(t.document,"click",function(){e(t,n),H.un(t.document,"click",arguments.callee)}),t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")),t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),n.enableScale()):n.disableScale(),!t.options.elementPathEnabled&&!t.options.wordCount&&!t.options.scaleEnabled&&(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none"),t.selection.isFocus()&&t.fireEvent("selectionchange",!1,!0)}),t.addListener("mousedown",function(e,t){q.editor.ui.Popup.postHide(t,t.target||t.srcElement)}),t.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(t),t.getDialog("edittip").open()});var i,o,a=!1;t.addListener("afterpaste",function(){t.queryCommandState("pasteplain")||(i=new q.editor.ui.Popup({content:new q.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),i.render(),a=!0)}),t.addListener("afterinserthtml",function(){clearTimeout(o),o=setTimeout(function(){if(i&&(a||t.ui._isTransfer)){var e=H.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"});t.selection.getRange().insertNode(e);var n=Ba(e,"firstChild","previousSibling");i.showAnchor(3==n.nodeType?n.parentNode:n),H.remove(e),delete t.ui._isTransfer,a=!1}},200)}),t.addListener("contextmenu",function(e,t){q.editor.ui.Popup.postHide(t)}),t.addListener("keydown",function(e,t){i&&i.dispose(t);var n=t.keyCode||t.which;t.altKey&&90==n&&UE.ui.buttons.fullscreen.onclick()}),t.addListener("wordcount",function(){e(this,n)}),t.addListener("selectionchange",function(){t.options.elementPathEnabled&&n[(-1==t.queryCommandState("elementpath")?"dis":"en")+"ableElementPath"](),t.options.scaleEnabled&&n[(-1==t.queryCommandState("scale")?"dis":"en")+"ableScale"]()});var r=new q.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(e){this.hide(),t.ui._dialogs[e]&&t.ui._dialogs[e].open()},_onImgSetFloat:function(e){this.hide(),t.execCommand("imagefloat",e)},_setIframeAlign:function(e){var t=r.anchorEl,n=t.cloneNode(!0);switch(e){case-2:n.setAttribute("align","");break;case-1:n.setAttribute("align","left");break;case 1:n.setAttribute("align","right")}t.parentNode.insertBefore(n,t),H.remove(t),r.anchorEl=n,r.showAnchor(r.anchorEl)},_updateIframe:function(){t._iframe=r.anchorEl,t.ui._dialogs.insertframeDialog.open(),r.hide()},_onRemoveButtonClick:function(e){t.execCommand(e),this.hide()},queryAutoHide:function(e){return e&&e.ownerDocument==t.document&&("img"==e.tagName.toLowerCase()||H.findParentByTagName(e,"a",!0))?e!==r.anchorEl:q.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});r.render(),t.options.imagePopup&&(t.addListener("mouseover",function(e,n){n=n||window.event;var i=n.target||n.srcElement;if(t.ui._dialogs.insertframeDialog&&/iframe/gi.test(i.tagName)){var o=r.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>");o?(r.getDom("content").innerHTML=o,r.anchorEl=i,r.showAnchor(r.anchorEl)):r.hide()}}),t.addListener("selectionchange",function(e,n){if(n){var i="",o="",a=t.selection.getRange().getClosedNode(),o=t.ui._dialogs;if(a&&"IMG"==a.tagName){var s="insertimageDialog";if(-1!=a.className.indexOf("edui-faked-video")&&(s="insertvideoDialog"),-1!=a.className.indexOf("edui-faked-webapp")&&(s="webappDialog"),-1!=a.src.indexOf("http://api.map.baidu.com")&&(s="mapDialog"),-1!=a.className.indexOf("edui-faked-music")&&(s="musicDialog"),-1!=a.src.indexOf("http://maps.google.com/maps/api/staticmap")&&(s="gmapDialog"),a.getAttribute("anchorname")&&(s="anchorDialog",i=r.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"</span></nobr>")),a.getAttribute("word_img")&&(t.word_img=[a.getAttribute("word_img")],s="wordimageDialog"),!o[s])return;o="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+s+'\');" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>",!i&&(i=r.formatHtml(o))}if(t.ui._dialogs.linkDialog){var l,d=t.queryCommandValue("link");d&&(l=d.getAttribute("_href")||d.getAttribute("href",2))&&(o=l,30<l.length&&(o=l.substring(0,20)+"..."),i&&(i+='<div style="height:5px;"></div>'),i+=r.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+l+'" title="'+l+'" >'+o+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"</span></nobr>"),r.showAnchor(d))}i?(r.getDom("content").innerHTML=i,r.anchorEl=a||d,r.showAnchor(r.anchorEl)):r.hide()}}))},_initToolbars:function(){for(var e=this.editor,t=this.toolbars||[],n=[],i=0;i<t.length;i++){for(var o=t[i],a=new q.editor.ui.Toolbar({theme:e.options.theme}),r=0;r<o.length;r++){var s=o[r],l=null;if("string"==typeof s){if(s=s.toLowerCase(),"|"==s&&(s="Separator"),q.editor.ui[s]&&(l=new q.editor.ui[s](e)),"fullscreen"==s){n&&n[0]?n[0].items.splice(0,0,l):l&&a.items.splice(0,0,l);continue}}else l=s;l&&l.id&&a.add(l)}n[i]=a}this.toolbars=n},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img"),this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var e=[],t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},setFullScreen:function(e){var t=this.editor,n=t.container.parentNode.parentNode;if(this._fullscreen!=e){if(this._fullscreen=e,this.editor.fireEvent("beforefullscreenchange",e),q.editor.browser.gecko)var i=t.selection.getRange().createBookmark();if(e){for(;"BODY"!=n.tagName;){var o=q.editor.dom.domUtils.getComputedStyle(n,"position");zc.push(o),n.style.position="static",n=n.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,t.iframe.parentNode.style.width="",this._updateFullScreen()}else{for(;"BODY"!=n.tagName;)n.style.position=zc.shift(),n=n.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,t.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px",window.scrollTo(0,this._bakScrollTop)}if(q.editor.browser.gecko&&"true"===t.body.contentEditable){var a=document.createElement("input");document.body.appendChild(a),t.body.contentEditable=!1,setTimeout(function(){a.focus(),setTimeout(function(){t.body.contentEditable=!0,t.selection.getRange().moveToBookmark(i).select(!0),q.editor.dom.domUtils.remove(a),e&&window.scroll(0,0)},0)},0)}"true"===t.body.contentEditable&&(this.editor.fireEvent("fullscreenchanged",e),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var e=yc.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(1*this.getDom().style.zIndex+100),yc.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0)),n.gecko&&window.onresize()}},_updateElementPath:function(){var e,t=this.getDom("elementpath");if(this.elementPathEnabled&&(e=this.editor.queryCommandValue("elementpath"))){for(var n,i=[],o=0;n=e[o];o++)i[o]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+o+'&quot;);">'+n+"</span>");t.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+i.join(" &gt; ")+"</div>"}else t.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="",e.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){this.getDom("elementpath").style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){function e(){h=H.getXY(s),p||(p=r.options.minFrameHeight+d.offsetHeight+c.offsetHeight),f.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+s.offsetWidth+"px;height:"+s.offsetHeight+"px;z-index:"+(r.options.zIndex+1),H.on(a,"mousemove",t),H.on(l,"mouseup",i),H.on(a,"mouseup",i)}function t(e){o(),e=e||window.event,b=e.pageX||a.documentElement.scrollLeft+e.clientX,v=e.pageY||a.documentElement.scrollTop+e.clientY,y=b-h.x,C=v-h.y,y>=g&&(m=!0,f.style.width=y+"px"),C>=p&&(m=!0,f.style.height=C+"px")}function i(){m&&(m=!1,r.ui._actualFrameWidth=f.offsetWidth-2,s.style.width=r.ui._actualFrameWidth+"px",r.setHeight(f.offsetHeight-c.offsetHeight-d.offsetHeight-2)),f&&(f.style.display="none"),o(),H.un(a,"mousemove",t),H.un(l,"mouseup",i),H.un(a,"mouseup",i)}function o(){n.ie?a.selection.clear():window.getSelection().removeAllRanges()}var a=document,r=this.editor,s=r.container,l=r.document,d=this.getDom("toolbarbox"),c=this.getDom("bottombar"),u=this.getDom("scale"),f=this.getDom("scalelayer"),m=!1,h=null,p=0,g=r.options.minFrameWidth,b=0,v=0,y=0,C=0,N=this;this.editor.addListener("fullscreenchanged",function(e,t){if(t)N.disableScale();else if(N.editor.options.scaleEnabled){N.enableScale();var n=N.editor.document.createElement("span");N.editor.body.appendChild(n),N.editor.body.style.height=Math.max(H.getXY(n).y,N.editor.iframe.offsetHeight-20)+"px",H.remove(n)}}),this.enableScale=function(){1!=r.queryCommandState("source")&&(u.style.display="",this.scaleEnabled=!0,H.on(u,"mousedown",e))},this.disableScale=function(){u.style.display="none",this.scaleEnabled=!1,H.un(u,"mousedown",e)}},isFullScreen:function(){return this._fullscreen},postRender:function(){Pd.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();var t,n=this,i=q.editor.dom.domUtils,o=function(){clearTimeout(t),t=setTimeout(function(){n._updateFullScreen()})};i.on(window,"resize",o),n.addListener("destroy",function(){i.un(window,"resize",o),clearTimeout(t)})},showToolbarMsg:function(e,t){this.getDom("toolbarmsg_label").innerHTML=e,this.getDom("toolbarmsg").style.display="",t||(this.getDom("upload_dialog").style.display="none")},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom="1"==e.style.zoom?"100%":"1"}},cb.inherits(bb,q.editor.ui.UIBase);var na={};UE.ui.Editor=function(e){var t=new q.editor.Editor(e);t.options.editor=t,cb.loadFile(document,{href:t.options.themePath+t.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var n=t.render;return t.render=function(e){e.constructor===String&&(t.key=e,na[e]=t),cb.domReady(function(){function i(){if(t.setOpt({labelMap:t.options.labelMap||t.getLang("labelMap")}),new bb(t.options),e&&(e.constructor===String&&(e=document.getElementById(e)),e&&e.getAttribute("name")&&(t.options.textarea=e.getAttribute("name")),e&&/script|textarea/gi.test(e.tagName))){var i=document.createElement("div");e.parentNode.insertBefore(i,e);var o=e.value||e.innerHTML;t.options.initialContent=/^[\t\r\n ]*$/.test(o)?t.options.initialContent:o.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),e.className&&(i.className=e.className),e.style.cssText&&(i.style.cssText=e.style.cssText),/textarea/i.test(e.tagName)?(t.textarea=e,t.textarea.style.display="none"):(e.parentNode.removeChild(e),e.id&&(i.id=e.id)),e=i,e.innerHTML=""}H.addClass(e,"edui-"+t.options.theme),t.ui.render(e),i=t.options,t.container=t.ui.getDom();for(var a,o=H.findParents(e,!0),r=[],s=0;a=o[s];s++)r[s]=a.style.display,a.style.display="block";for(i.minFrameWidth=i.initialFrameWidth?i.initialFrameWidth:i.initialFrameWidth=e.offsetWidth,i.initialFrameHeight?i.minFrameHeight=i.initialFrameHeight:i.initialFrameHeight=i.minFrameHeight=e.offsetHeight,s=0;a=o[s];s++)a.style.display=r[s];e.style.height&&(e.style.height=""),t.container.style.width=i.initialFrameWidth+"px",t.container.style.zIndex=i.zIndex,n.call(t,t.ui.getDom("iframeholder"))}t.langIsReady?i():t.addListener("langReady",i)})},t},UE.getEditor=function(e,t){var n=na[e];return n||(n=na[e]=new UE.ui.Editor(t),n.render(e)),n},UE.delEditor=function(e){var t;(t=na[e])&&(t.key&&t.destroy(),delete na[e])};var Qd=q.editor.utils,Rd=q.editor.ui.Popup,Sd=q.editor.ui.SplitButton,Ac=q.editor.ui.MultiMenuPop=function(e){this.initOptions(e),this.initMultiMenu()};Ac.prototype={initMultiMenu:function(){var e=this;this.popup=new Rd({content:"",editor:e.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>',e.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*e.editor.container.style.zIndex+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},Qd.inherits(Ac,Sd)}();